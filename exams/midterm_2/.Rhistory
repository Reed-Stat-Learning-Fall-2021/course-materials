example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
set.seed(271)
sim_data <- sim_data %>% mutate(p = f(x1,x2)) %>%
rowwise() %>%
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) %>% mutate(Y = as.factor(Y))
ggplot(sim_data, aes( x = x1, y = x2, color = Y)) + geom_point()+geom_abline(slope = -.75, intercept = 2, color = "blue")
my_log<-glm(Y ~ x1+x2, data = sim_data, family = "binomial")
summary(my_log)
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119)
ir_split <- initial_split(irdata)
ir_train <- training(irdata)
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119)
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
include_graphics("fat.png")
#Run this code to import the get_model_formula function
source('get_model_formula.R')
#Example
data(mtcars)
library(leaps)
my_mtmodels<-regsubsets(mpg~.,data=mtcars)
get_model_formula(3,my_mtmodels,"mpg")
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119)
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
spambase <- read.csv("~/Downloads/spambase (1)/spambase.data", header=FALSE)
View(spambase)
View(spambase)
library(readr)
spam_names <- read_csv("~/Downloads/spam_names.csv",
col_names = FALSE)
View(spam_names)
names(spam) <- spam_names$X1
spam <- read_csv("spam.csv")
names(spambase) <- spam_names$X1
spambase
View(spambase)
write.csv(spambase, "spam.csv")
spam <- read_csv("spam.csv")
View(spam)
write.csv(spambase[,-1], "spam.csv")
spam <- read_csv("spam.csv")
spambase %>% select(-X1)
spambase
View(spambase)
write_csv(spambase, "spam.csv")
spam <- read_csv("spam.csv")
spam <- read_csv("spam.csv")
spambase <- read.csv("~/Downloads/spambase (1)/spambase.data", header=FALSE)
View(spambase)
library(readr)
spam_names <- read_csv("~/Downloads/spam_names.csv")
View(spam_names)
library(readr)
spam_names <- read_csv("~/Downloads/spam_names.csv",
col_names = FALSE)
View(spam_names)
names(spambase)<-spam_names$X1
names(spambase)
View(spambase)
write_csv(spambase, "spam.csv")
spam <- read_csv("spam.csv")
my_lm <- glm(spam ~., data = spam, family = "binomial")
summary(my_lm)
library(rpart)
library(rpart.plot)
my_tree <- rpart(spam ~., data = spam)
rpart.plot(my_tree)
hist(spam$`char_freq_$`)
library(readr)
email <- read_csv("~/Downloads/email.csv")
View(email)
library(GGally)
ggpairs(email)
email %>% select(-time) %>% ggpairs()
email <- read_csv("email.csv")
email <- read_csv("email.csv")
my_lm <- glm(email ~., data = spam, family = "binomial")
my_lm <- glm(spam ~., data = email, family = "binomial")
summary(my_lm)
my_tree <- rpart(spam ~., data = email)
rpart.plot(my_tree)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
wine<-read_csv("wine.csv") %>% mutate(Variety = as.factor(Variety))
View(wine)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv")
library(GGally)
ggpairs(email)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
set.seed(1010)
x1 <- runif(200, 0,1) #Predictor X1
x2 <- runif(200, 0,1) #Predictor X2
sim_data<-data.frame(x1,x2) #Data frame of predictor values
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
include_graphics("fat.png")
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119)
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
#Run this code to import the get_model_formula function
source('get_model_formula.R')
email <- read_csv("email.csv")
my_lm <- glm(spam ~., data = email, family = "binomial")
summary(my_lm)
library(rpart)
library(rpart.plot)
my_tree <- rpart(spam ~., data = email)
rpart.plot(my_tree)
library(rpart)
library(rpart.plot)
my_tree <- rpart(spam ~., data = email)
library(rsample)
email_initial <- initial_split(email)
library(rsample)
set.seed(1)
email_initial <- initial_split(email)
email_training <- training(email_initial)
email_testing <- testing(email_initial)
preds_lm <- predict(my_lm, email_testing)
preds_lm
preds_lm <- predict(my_lm, email_testing, type = "response")
preds_lm <- ifelse(probs_lm > .5, "1", "0")
my_lm <- glm(spam ~., data = email_training, family = "binomial")
probs_lm <- predict(my_lm, email_testing, type = "response")
preds_lm <- ifelse(probs_lm > .5, "1", "0")
preds_lm
class(email$spam)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(rsample)
set.seed(1)
email_initial <- initial_split(email)
email_training <- training(email_initial)
email_testing <- testing(email_initial)
my_lm <- glm(spam ~., data = email_training, family = "binomial")
probs_lm <- predict(my_lm, email_testing, type = "response")
preds_lm <- ifelse(probs_lm > .5, "1", "0")
summary(my_lm)
library(rpart)
library(rpart.plot)
my_tree <- rpart(spam ~., data = email)
rpart.plot(my_tree)
plotcp(my_tree)
my_tree <- rpart(spam ~., data = email, control = rpart.control(cp = .001))
rpart.plot(my_tree)
plotcp(my_tree)
prune_tree <- prune(my_tree, cp = .0096)
preds_tree <- predict(prune_tree, email_testing)
preds_tree
preds_tree <- predict(prune_tree, email_testing, type = "class")
preds_tree
probs_tree <- predict(prune_tree, email_testing, type = "prob")
?predict.rpart
probs_tree
probs_tree <- predict(prune_tree, email_testing, type = "prob")[,2]
probs_tree
library(kknn)
train.kknn(spam ~., kmax = 30, kernel = "rectangular", data = email_training)
knn_cv <- train.kknn(spam ~., kmax = 30, kernel = "rectangular", data = email_training)
knn_cv$MISCLASS
model_knn <- kknn(spam ~., k = 4, kernel = "rectangular", train = email_training, test = email_testing)
model_knn$fitted.values
probs_knn <- model_knn$prob[,2]
model_knn$prob
results <- data.frame(obs = email$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree)
preds_knn <- model_knn$fitted.values
probs_knn <- model_knn$prob[,2]
results <- data.frame(obs = email$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree)
my_tree <- rpart(spam ~., data = email_training, control = rpart.control(cp = .001))
rpart.plot(my_tree)
plotcp(my_tree)
prune_tree <- prune(my_tree, cp = .0096)
rpart.plot(my_tree)
plotcp(my_tree)
prune_tree <- prune(my_tree, cp = .01)
preds_tree <- predict(prune_tree, email_testing, type = "class")
probs_tree <- predict(prune_tree, email_testing, type = "prob")[,2]
results <- data.frame(obs = email$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree)
my_lm <- glm(spam ~., data = email_training, family = "binomial")
probs_lm <- predict(my_lm, email_testing, type = "response")
preds_lm <- ifelse(probs_lm > .5, "1", "0")
summary(my_lm)
library(kknn)
knn_cv <- train.kknn(spam ~., kmax = 30, kernel = "rectangular", data = email_training)
model_knn <- kknn(spam ~., k = 4, kernel = "rectangular", train = email_training, test = email_testing)
preds_knn <- model_knn$fitted.values
probs_knn <- model_knn$prob[,2]
library(rpart)
library(rpart.plot)
my_tree <- rpart(spam ~., data = email_training, control = rpart.control(cp = .001))
preds_tree <- predict(prune_tree, email_testing, type = "class")
probs_tree <- predict(prune_tree, email_testing, type = "prob")[,2]
results <- data.frame(obs = email$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree, logistic_prob = probs_lm, knn_prob = probs_knn, tree_prob = probs_tree)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree) %>% pivot_longer(!obs)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results_probs <- data.frame(obs = email_testing$spam, logistic = probs_lm, knn = probs_nn, tree = probs_tree)
probs_tree
probs_tree <- predict(prune_tree, email_testing, type = "prob")[,2]
results_probs <- data.frame(obs = email_testing$spam, logistic = probs_lm, knn = probs_nn, tree = probs_tree)
results_probs <- data.frame(obs = email_testing$spam, logistic = probs_lm, knn = probs_knn, tree = probs_tree)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree) %>% pivot_longer()
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree) %>% pivot_longer(!obs)
results_probs <- data.frame(obs = email_testing$spam, logistic = probs_lm, knn = probs_knn, tree = probs_tree) %>% pivot_longer(!obs)
library(yardstick)
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results_probs <- data.frame(obs = email_testing$spam, logistic = probs_lm, knn = probs_knn, tree = probs_tree) %>% pivot_longer(!obs, names_to = "model", values_to = "prob")
results_probs %>% group_by(model) %>% roc_curve( truth = obs, prob)
results_probs %>% group_by(model) %>% roc_curve( truth = obs, prob) %>% autoplot()
?roc_curve
results_probs %>% group_by(model) %>% roc_curve( truth = obs, prob, event_level = "second") %>% autoplot()
library(rpart)
library(rpart.plot)
my_tree <- rpart(spam ~., data = email_training, control = rpart.control(cp = .001))
rpart.plot(my_tree)
plotcp(my_tree)
prune_tree <- prune(my_tree, cp = .01)
rpart.plot(my_tree)
plotcp(my_tree)
prune_tree <- prune(my_tree, cp = .005)
preds_tree <- predict(prune_tree, email_testing, type = "class")
probs_tree <- predict(prune_tree, email_testing, type = "prob")[,2]
results <- data.frame(obs = email_testing$spam, logistic = preds_lm, knn = preds_knn, tree = preds_tree) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results_probs <- data.frame(obs = email_testing$spam, logistic = probs_lm, knn = probs_knn, tree = probs_tree) %>% pivot_longer(!obs, names_to = "model", values_to = "prob")
library(yardstick)
results_probs %>% group_by(model) %>% roc_curve( truth = obs, prob, event_level = "second") %>% autoplot()
results %>% group_by(model) %>% accuracy(truth = obs, estimate = preds)
results %>% group_by(model) %>% sensitivy(truth = obs, estimate = preds)
results %>% group_by(model) %>% sensitivity(truth = obs, estimate = preds)
results %>% group_by(model) %>% specificity(truth = obs, estimate = preds)
library(mass)
library(MASS)
