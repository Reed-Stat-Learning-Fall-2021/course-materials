data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
library(rpart)
library(rpart.plot)
email_tree <- rpart(spam ~., data = email_train, control = rpart.control(cp = 0.001, minsplit = 20))
rpart.plot(email_tree)
plotcp(email_tree)
email_pruned <- prune(email_tree, cp = 0.01)
rpart.plot(email_pruned)
email_pruned_preds <- predict(email_pruned, email_test, type = "class")
email_pruned_probs <- predict(email_pruned, email_test, type = "prob")[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
)
email_results %>% filter(model == "tree") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_results %>% group_by(model) %>% sensitivity(truth = obs, estimate = preds)
email_results %>% group_by(model) %>% specificity(truth = obs, estimate = preds)
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
View(email)
library(skimr)
skim(email)
summary(email)
email %>% drop_na() %>% count(spam)
email %>% drop_na()
email %>% drop_na() %>% ncol()
email %>% drop_na() %>% nrow()
email %>% nrow()
email_results %>% filter(model == "knn") %>% count(preds)
email_knn_mod$fitted.values
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
email_results
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- email_knn_mod$fitted.values
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- email_knn_mod$fitted.values
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- email_knn_mod$fitted.values
email_knn_preds <- email_knn_mod$prob[,2]
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- email_knn_mod$fitted.values
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
set.seed(1)
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- email_knn_mod$fitted.values
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <- as.factor( ifelse(email_log_probs > .5, "1", "0"))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- email_knn_mod$fitted.values
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_knn_mod$fitted.values
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_preds <- email_knn_mod$prob[,2]
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <- as.factor( ifelse(email_log_probs > .5, "1", "0"))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_results
email_results %>% filte(model == "knn")
email_results %>% filter(model == "knn")
as.factor(email_knn_mod$fitted.values)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <- as.factor( ifelse(email_log_probs > .5, 0, 1))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_preds <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <- as.factor( ifelse(email_log_probs > .5, 0, 1))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  ifelse(email_log_probs > .5, 0, 1)
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
glimpse(email)
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 0, 1))
email_log_preds
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 0, 1))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results
email_results %>% filter(model == "knn")
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <- email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_knn_probs <- email_knn_mod$prob[,2]
email_knn_probs
email_knn_probs <- as.numeric(email_knn_mod$prob[,2])
email_knn_probs
class(email_knn_probs)
email_knn_probs <-  email_knn_mod$prob[,2]
class(email_knn_probs)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <-  email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_preds, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
class(email_results$probs)
email_results$probs
email_log_probs
class(email_log_probs)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
class(email_results$probs)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <-  email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_probs, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
library(rpart)
library(rpart.plot)
email_tree <- rpart(spam ~., data = email_train, control = rpart.control(cp = 0.001, minsplit = 20))
rpart.plot(email_tree)
plotcp(email_tree)
email_pruned <- prune(email_tree, cp = 0.01)
rpart.plot(email_pruned)
email_pruned_preds <- predict(email_pruned, email_test, type = "class")
email_pruned_probs <- predict(email_pruned, email_test, type = "prob")[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
)
email_results %>% filter(model == "tree") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
