selection_metrics %>% filter(metric=="bs_bic") %>% arrange(value) %>% head()
best_n_fs<-which.min(summary(fs_mod)$bic)
best_n_bs<-which.min( summary(bs_mod)$bic)
fs_form<-get_model_formula(best_n_fs, fs_mod, "fat")
b_form<-get_model_formula(best_n_bs, bs_mod, "fat")
fs_mod<-lm(fs_form, data =  ir_train)
bs_mod<-lm(get_model_formula(best_n_bs,bs_mod, "fat"), data = ir_train)
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <-  email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_probs, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
library(rpart)
library(rpart.plot)
email_tree <- rpart(spam ~., data = email_train, control = rpart.control(cp = 0.001, minsplit = 20))
rpart.plot(email_tree)
plotcp(email_tree)
email_pruned <- prune(email_tree, cp = 0.01)
rpart.plot(email_pruned)
email_pruned_preds <- predict(email_pruned, email_test, type = "class")
email_pruned_probs <- predict(email_pruned, email_test, type = "prob")[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
)
email_results %>% filter(model == "tree") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
include_graphics("fat.png")
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119) #Do not change this seed
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
#Run this code to import the get_model_formula function
source('get_model_formula.R')
lin_mod_2 <- lm(fat~., data = ir_train)
library(gglm)
gglm(lin_mod_2)
library(leaps)
fs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "forward")
bs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "backward")
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(cols = 1:2,
names_to = "metric",
values_to = "value" )
selection_metrics %>% filter(metric  %in% c("fs_bic", "bs_bic") ) %>%
ggplot(   aes(x = n_var, y = value, color = metric))+geom_line()
selection_metrics %>% filter(metric=="fs_bic") %>% arrange(value) %>% head()
selection_metrics %>% filter(metric=="bs_bic") %>% arrange(value) %>% head()
best_n_fs<-which.min(summary(fs_mod)$bic)
best_n_bs<-which.min( summary(bs_mod)$bic)
selection_metrics<- cbind(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics<- cbind(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(cols = 1:2,
names_to = "metric",
values_to = "value" )
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <-  email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_probs, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
library(rpart)
library(rpart.plot)
email_tree <- rpart(spam ~., data = email_train, control = rpart.control(cp = 0.001, minsplit = 20))
rpart.plot(email_tree)
plotcp(email_tree)
email_pruned <- prune(email_tree, cp = 0.01)
rpart.plot(email_pruned)
email_pruned_preds <- predict(email_pruned, email_test, type = "class")
email_pruned_probs <- predict(email_pruned, email_test, type = "prob")[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
)
email_results %>% filter(model == "tree") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
include_graphics("fat.png")
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119) #Do not change this seed
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
#Run this code to import the get_model_formula function
source('get_model_formula.R')
lin_mod_2 <- lm(fat~., data = ir_train)
library(gglm)
gglm(lin_mod_2)
library(leaps)
fs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "forward")
bs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "backward")
selection_metrics<- cbind(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(cols = 1:2,
names_to = "metric",
values_to = "value" )
selection_metrics
?bind_cols
bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(cols = 1:2,
names_to = "metric",
values_to = "value" )
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(cols = 1:2,
names_to = "metric",
values_to = "value" )
selection_metrics
selection_metrics %>%
ggplot(   aes(x = n_var, y = value, color = metric))+geom_line()
selection_metrics %>% filter(metric=="fs_bic") %>% arrange(value) %>% head()
selection_metrics %>% filter(metric=="bs_bic") %>% arrange(value) %>% head()
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(cols = 1:2,
names_to = "metric",
values_to = "value" )
selection_metrics %>%
ggplot(   aes(x = n_var, y = value, color = metric))+geom_line()
selection_metrics %>% filter(metric=="fs_bic") %>% arrange(value) %>% head()
selection_metrics %>% filter(metric=="bs_bic") %>% arrange(value) %>% head()
best_n_fs<-which.min(summary(fs_mod)$bic)
best_n_bs<-which.min( summary(bs_mod)$bic)
selection_metrics
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics
selection_metrics <- selection_metrics %>% pivot_longer(!n_var,
names_to = "metric",
values_to = "value" )
selection_metrics %>%
ggplot(   aes(x = n_var, y = value, color = metric))+geom_line()
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <-  email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_probs, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
library(rpart)
library(rpart.plot)
email_tree <- rpart(spam ~., data = email_train, control = rpart.control(cp = 0.001, minsplit = 20))
rpart.plot(email_tree)
plotcp(email_tree)
email_pruned <- prune(email_tree, cp = 0.01)
rpart.plot(email_pruned)
email_pruned_preds <- predict(email_pruned, email_test, type = "class")
email_pruned_probs <- predict(email_pruned, email_test, type = "prob")[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
)
email_results %>% filter(model == "tree") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
include_graphics("fat.png")
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119) #Do not change this seed
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
#Run this code to import the get_model_formula function
source('get_model_formula.R')
lin_mod_2 <- lm(fat~., data = ir_train)
library(gglm)
gglm(lin_mod_2)
library(leaps)
fs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "forward")
bs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "backward")
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(!n_var,
names_to = "metric",
values_to = "value" )
selection_metrics %>%
ggplot(   aes(x = n_var, y = value, color = metric))+geom_line()
selection_metrics %>% filter(metric=="fs_bic") %>% arrange(value) %>% head()
selection_metrics %>% filter(metric=="bs_bic") %>% arrange(value) %>% head()
best_n_fs<-which.min(summary(fs_mod)$bic)
best_n_bs<-which.min( summary(bs_mod)$bic)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
email <- read_csv("email.csv") %>% mutate(spam = as.factor(spam))
library(gridExtra)
theme_set(theme_bw())
p1<-ggplot(email, aes(x = number))+geom_bar()+theme_bw()
p2<-ggplot(email, aes(x = num_char ))+geom_histogram(bins = 25, color = "white")
p3<-ggplot(email, aes(x = dollar ))+geom_histogram(bins = 25, color = "white")
p4<-ggplot(email, aes(x = from))+geom_bar()
grid.arrange(p1,p2,p3,p4, ncol = 2)
g1 <- ggplot(email, aes(x = number, fill = spam))+geom_bar(position = "fill")
g2 <- ggplot(email, aes(x = num_char, y = spam))+geom_boxplot()
g3 <- ggplot(email, aes(x = dollar, y = spam))+geom_boxplot()
g4 <-  ggplot(email, aes(x = from, fill = spam))+geom_bar(position = "fill")
grid.arrange(g1,g2,g3,g4, ncol = 2)
set.seed(10)
library(rsample)
email_split <- initial_split(email, strata = spam)
email_train <- training(email_split)
email_test <- testing(email_split)
email_log <- glm(spam ~ ., family = "binomial", data = email_train)
email_log_probs <- predict(email_log, email_test, type = "response")
email_log_preds <-  as.factor(ifelse(email_log_probs > .5, 1, 0))
email_results <- data.frame(obs = email_test$spam, preds = email_log_preds, probs = email_log_probs, model = "logistic")
library(yardstick)
email_results %>% filter(model == "logistic") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "logistic") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
set.seed(1)
library(kknn)
email_knn_tune <- train.kknn(spam ~., data = email_train, ks = 1+2*0:15, kernel = "rectangular")
email_knn_tune$MISCLASS %>% as.data.frame() %>%
rownames_to_column() %>% rename(k = rowname, error = rectangular) %>% mutate(k = as.numeric(k)) %>%
ggplot(aes(x = k, y = error))+ geom_point()
best_k <- email_knn_tune$best.parameters$k
email_knn_mod <- kknn(spam~., train = email_train, test = email_test, k = best_k, kernel = "rectangular")
email_knn_preds <- as.factor(email_knn_mod$fitted.values)
email_knn_probs <-  email_knn_mod$prob[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_knn_preds, probs = email_knn_probs, model = "knn")
)
email_results %>% filter(model == "knn") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "knn") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
library(rpart)
library(rpart.plot)
email_tree <- rpart(spam ~., data = email_train, control = rpart.control(cp = 0.001, minsplit = 20))
rpart.plot(email_tree)
plotcp(email_tree)
email_pruned <- prune(email_tree, cp = 0.01)
rpart.plot(email_pruned)
email_pruned_preds <- predict(email_pruned, email_test, type = "class")
email_pruned_probs <- predict(email_pruned, email_test, type = "prob")[,2]
email_results <- email_results %>% rbind(
data.frame(obs = email_test$spam, preds = email_pruned_preds, probs = email_pruned_probs, model = "tree")
)
email_results %>% filter(model == "tree") %>% conf_mat(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% accuracy(truth = obs, estimate = preds)
email_results %>% filter(model == "tree") %>% roc_curve(truth = obs, probs, event_level = "second") %>%
autoplot()
my_metrics <- metric_set(accuracy, sensitivity, specificity)
email_results %>% group_by(model) %>% my_metrics(truth = obs, estimate = preds)
include_graphics("fat.png")
irdata<-read_csv("irdata.csv")
library(rsample)
set.seed(1119) #Do not change this seed
ir_split <- initial_split(irdata)
ir_train <- training(ir_split)
ir_test <- testing(ir_split)
#Run this code to import the get_model_formula function
source('get_model_formula.R')
lin_mod_2 <- lm(fat~., data = ir_train)
library(gglm)
gglm(lin_mod_2)
library(leaps)
fs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "forward")
bs_mod<-regsubsets(fat ~., data = ir_train, nvmax = 100, method = "backward")
selection_metrics<- bind_cols(
fs_bic=summary(fs_mod)$bic,
bs_bic=summary(bs_mod)$bic,
n_var=1:100
)
selection_metrics <- selection_metrics %>% pivot_longer(!n_var,
names_to = "metric",
values_to = "value" )
selection_metrics %>%
ggplot(   aes(x = n_var, y = value, color = metric))+geom_line()
selection_metrics %>% filter(metric=="fs_bic") %>% arrange(value) %>% head()
selection_metrics %>% filter(metric=="bs_bic") %>% arrange(value) %>% head()
best_n_fs<-which.min(summary(fs_mod)$bic)
best_n_bs<-which.min( summary(bs_mod)$bic)
fs_form<-get_model_formula(best_n_fs, fs_mod, "fat")
b_form<-get_model_formula(best_n_bs, bs_mod, "fat")
fs_mod<-lm(fs_form, data =  ir_train)
bs_mod<-lm(get_model_formula(best_n_bs,bs_mod, "fat"), data = ir_train)
x<-model.matrix(fat~., data = ir_train)
y<-ir_train$fat
xtst<-model.matrix(fat~., data = ir_test)
ytst<-ir_test$fat
set.seed(10101)
library(glmnet)
grid<-10^(seq(-5,5,length = 100))
rr_mod<-glmnet(x,y, family = "gaussian", alpha = 0 , lambda = grid)
rr_cv<-cv.glmnet(x,y, alpha = 0 , lambda = grid)
rr_l<-rr_cv$lambda.1se
lasso_mod<-glmnet(x,y, family = "gaussian", alpha = 1, lambda = grid )
lasso_cv<-cv.glmnet(x,y,alpha = 1, lambda = grid )
lasso_l<-lasso_cv$lambda.1se
data.frame(rr_l,lasso_l)
plot(rr_mod)
plot(rr_cv)
plot(lasso_mod)
plot(lasso_cv)
results <- data.frame(
obs = ir_test$fat,
full = predict(lin_mod_2, ir_test),
ridge = as.numeric(predict.glmnet(rr_mod, newx = xtst, s = rr_l)),
lasso = as.numeric(predict.glmnet(lasso_mod, newx = xtst, s = lasso_l)),
forward = predict(fs_mod, ir_test),
backward = predict(bs_mod, ir_test)
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
library(yardstick)
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
set.seed(1010)
x1 <- runif(200, 0,1) #Predictor X1
x2 <- runif(200, 0,1) #Predictor X2
sim_data<-data.frame(x1,x2) #Data frame of predictor values
example_df<-data.frame(p = c(.2, .4, .6, .8)) #This creates a column of probabilities p
example_df<-example_df %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p))) #This creates a sample in each row
#with the given probability of getting Y = 1.
example_df
#Run this code chunk several times to convince yourself that in each row, Y has the indicated
#probability of taking the value 1
get_probs <- function(X1, X2){
exp(-5 +6*X1 + 5*X2)/(1 + exp(-5 +6*X1 + 5*X2) )
}
sim_data <- sim_data %>% mutate(p = get_probs(x1, x2))
ggplot(sim_data, aes(x = x1, y = x2, color = p))+geom_point()+theme_bw()+scale_colour_viridis_c(option = "plasma", end = .75)
set.seed(10)
sim_data <- sim_data %>%
rowwise() %>% #This allows you to mutate entries in the data frame one row at a time
mutate(Y = sample(0:1, size = 1, prob = c(1-p, p)))
ggplot(sim_data, aes(x = x1, y = x2, color = Y))+geom_point()+theme_bw()+scale_colour_viridis_c(option = "plasma", end = .75)+geom_abline(slope = -1.2, intercept = 1.1, color = "purple4")
log_mod_3 <- glm(Y ~ x1 + x2, family = "binomial", data = sim_data)
summary(log_mod_3)
log_mod_3 <- glm(Y ~ x1 + x2, family = "binomial", data = sim_data)
summary(log_mod_3)
train_probs <- predict(log_mod_3, sim_data, type = "response")
train_preds <- ifelse(train_probs > 0.5, "1", "0" )
results_3 <- data.frame(obs = as.factor(sim_data$Y), preds = train_preds)
results_3 %>% conf_mat(truth = obs, estimate = preds)
results_3 %>% accuracy(truth = obs, estimate = preds)
results_3 %>% conf_mat(truth = obs, estimate = preds)
train_preds <- ifelse(train_probs > 0.5, "1", "0" ) %>% as.factor()
results_3 <- data.frame(obs = as.factor(sim_data$Y), preds = train_preds)
results_3 %>% conf_mat(truth = obs, estimate = preds)
results_3 %>% accuracy(truth = obs, estimate = preds)
