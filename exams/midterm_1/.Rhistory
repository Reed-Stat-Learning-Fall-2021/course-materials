library(AppliedPredictiveModeling)
data("abalone")
View(abalone)
mod <- lm(WholeWeight ~. , data = abalone)
summary(mod)
library(readr)
wine <- read_csv("data/wine.csv")
View(wine)
mod <- lm(price ~ ., data = wine)
mod <- lm(Price ~ ., data = wine)
summary(mod)
cor(wine)
plot(wine$Age, win$FrancePop)
plot(wine$Age, wine$FrancePop)
library(GGally)
?ggpairs(wine)
ggpairs(wine)
summary(mod)
mod <- lm(Price ~ . - Age - FrancePop, data = wine)
summary(mod)
plot(mod)
library(readr)
moore <- read_csv("data/moore.csv")
View(moore)
library(readr)
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
View(moore)
write_csv(moore, "moore.csv")
moore <- read.csv("H:/My Drive/Teaching/Classes/Math 243/Fall 2021/course-materials/exams/midterm_1/moore.csv")
View(moore)
library(readr)
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
View(moore)
write_csv(moore, "moore.csv")
View(moore)
write_csv(moore, "moore.csv", ",")
library(readr)
moore <- read_csv("moore.csv")
View(moore)
library(readr)
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
View(moore)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
library(readr)
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
View(moore)
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
plot(moore$Date, moore$Transistors)
mod <- lm(Transistors ~ Date, data = moore)
summary(mod)
ggplot(moore, aes(x = Date, y= Transistors))+geom_point()+geom_smooth()
ggplot(moore, aes(x = Date, y= Transistors))+geom_point()+geom_smooth(method ="lm", se = F)
mod2 <- lm(Transistors ~ poly(Date, 2, raw = T))
mod2 <- lm(Transistors ~ poly(Date, 2, raw = T), data = moore)
ggplot(moore, aes(x = Date, y= Transistors))+geom_point()+geom_smooth(method ="lm", se = F, formula = y ~ poly(x, 2))
mod2 <-lm(log(Transistor)~Date, data = moore)
mod2 <-lm(log(Transistors)~Date, data = moore)
summary(mod2)
mod2<-lm(log2(Transistors)~Date, data = moore)
summary(mod2)
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y ~ log2(x))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y ~ log2(x))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y ~ I(log2(x)))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = log2(y) ~ x
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = log2(y) ~ x)
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y ~ I(2^x))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = log(y)~x)
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = log2(y)~x)
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y~x)
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y~I(x^2))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y~I(2^x))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y~I(e^x))
ggplot(data = moore, aes(x = Date, y = Transistors))+geom_point()+geom_smooth(method = "lm", se = F, formula = y~I(exp(x)))
View(moore)
ggplot(data = moore, aes(x = Date, y = log2(Transistors)))
ggplot(data = moore, aes(x = Date, y = log2(Transistors)))+geom_point()
ggplot(data = moore, aes(x = Date, y = log2(Transistors)))+geom_point()+geom_smooth(method = "lm", se = F)
include_graphics("img/pumpkin.jpg")
n <- 100
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-x1+x2+x1*x2+e
sim_data <- data.frame(x1,x2,y)
plot(x,y)
plot(x1,y)
plot(x2,y)
mod3<-lm(y ~ x1*x2, data = sim_data)
summary(mod3)
set.seed(1010)
n <- 100
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-x1+x2+x1*x2+e
sim_data <- data.frame(x1,x2,y)
plot(x2,y)
plot(x1,y)
set.seed(1010)
n <- 100
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-x1+x2+e
sim_data <- data.frame(x1,x2,y)
mod3 <- lm(y ~ x1 + x2, data = sim_data)
summary(mod3)
set.seed(1010)
n <- 100
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
sim_data <- data.frame(x1,x2,y)
mod3 <- lm(y ~ x1 + x2, data = sim_data)
summary(mod3)
set.seed(1010)
n <- 20
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
sim_data <- data.frame(x1,x2,y)
mod3 <- lm(y ~ x1 + x2, data = sim_data)
summary(mod3)
plot(x2,y)
plot(x3,y)
plot(x1,y)
View(mod)
summary(mod)
wine <- read_csv("data/wine.csv")
mod_wine <- lm(Price ~.-Age, data = wine)
summary(mod_wine)
plot(wine$Year,wine$Price)
plot(wine$Year, exp(wine$Price))
wine <- wine %>% mutate(expPrice = exp(Price))
mod_wine1 <- lm(expPrice ~. - Age - FrancePop, data = wine)
summary(mod_wine1)
mod_wine1 <- lm(expPrice ~. - Age - FrancePop- Price, data = wine)
summary(mod_wine1)
plot(wine$Year, 10^(wine$Price))
View(wine)
plot(wine$Year,wine$Price)
exp(8)
exp(6)
exp(8)
summary(mod_wine)
mod_wine <- lm(Price ~ Year, data = wine)
summary(mod_wine)
wine <- wine %>% mutate(s_price = Price/8.4937)
wine <- wine %>% mutate(n_price = Price*4.60517)
plot(wine$Year, wine$n_price)
wine <- wine %>% mutate(n_price = s_Price*4.60517)
wine <- wine %>% mutate(n_price = s_price*4.60517)
plot(wine$Year, wine$n_price)
wine <- wine %>% mutate(e_price = exp(n_price))
plot(wine$Year, wine$e_price)
exp(4.505)
log(4884)
wine <- read_csv("data/wine.csv")
wine <- wine %>% mutate(actual_price = exp(Price))
wine <- wine %>% mutate(actual_price = 1.7*exp(Price))
wine <- wine %>% mutate(Price = actual_price)
mod_wine <- lm(Price ~ Year, data = wine)
summary(mod_wine)
plot(wine$Year,wine$Price)
plot(wine$Year, log(wine$Price))
mod_wine1 <- lm(log(Price) ~ Year, data = wine)
summary(mod_wine1)
summary(mod_wine)
mod_winef <- lm(Price ~ . - FrancePop - Age, data = wine)
summary(mod_winef)
mod_winef <- lm(Price ~ . - FrancePop - Age - actual_price, data = wine)
summary(mod_winef)
wine <- wine %>% select(-actual_price)
View(wine)
write_csv(wine, "data/wine.csv")
cc <- read_csv("data/wine.csv")
View(cc)
knitr::opts_chunk$set(echo = TRUE)
library(knitr)
library(tidyverse)
set.seed(1010)
n <- 20
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
sim_data <- data.frame(x1,x2,y)
model_list <- list[[]]
model_list <- list()
for (i in 1:10){
model_list[[i]] <- lm(y ~ poly(x1,degree = i) + poly(x2,degree = i), data = sim_data)
}
model_list <- list()
for (i in 1:10){
model_list[[i]] <- lm(y ~ poly(x1,degree = i) + poly(x2,degree = i), data = sim_data)
}
train_mse <- c()
for (i in 1:10){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
View(model_list)
View(sim_data)
model_list <- list()
for (i in 1:5){
model_list[[i]] <- lm(y ~ poly(x1,degree = i) + poly(x2,degree = i), data = sim_data)
}
train_mse <- c()
for (i in 1:10){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
model_list <- list()
for (i in 1:5){
model_list[[i]] <- lm(y ~ poly(x1,degree = i) + poly(x2,degree = i), data = sim_data)
}
train_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
model_list <- list()
for (i in 1:5){
model_list[[i]] <- lm(y ~ poly(x1,degree = i-1) + x2, data = sim_data)
}
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:5){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:5){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
x1<-rnorm(n,1,1)
x2<-rnorm(n,2,1)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:5){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
test_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], sim_data)
test_mse[i] <- mean((test_data$y - preds)^2)
}
preds <- predict(model_list[[i]], test_data)
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:5){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
test_mse <- c()
for (i in 1:5){
preds <- predict(model_list[[i]], test_data)
test_mse[i] <- mean((test_data$y - preds)^2)
}
bv_trade <- data.frame(model = 1:5, train_mse, test_mse)
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split))
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split))+geom_line()
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:6){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:6){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
test_mse <- c()
for (i in 1:6){
preds <- predict(model_list[[i]], test_data)
test_mse[i] <- mean((test_data$y - preds)^2)
}
bv_trade <- data.frame(model = 1:6, train_mse, test_mse)
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split))+geom_line()
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split), size = 1)+geom_line()+theme_bw()
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:10){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:10){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
test_mse <- c()
for (i in 1:10){
preds <- predict(model_list[[i]], test_data)
test_mse[i] <- mean((test_data$y - preds)^2)
}
bv_trade <- data.frame(model = 1:10, train_mse, test_mse)
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split), size = 1)+geom_line()+theme_bw()
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:8){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:8){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
test_mse <- c()
for (i in 1:8){
preds <- predict(model_list[[i]], test_data)
test_mse[i] <- mean((test_data$y - preds)^2)
}
bv_trade <- data.frame(model = 1:8, train_mse, test_mse)
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split), size = 1)+geom_line()+theme_bw()
model_list <- list()
model_list[[1]] <- lm(y ~ x1, data = sim_data)
for (i in 2:6){
model_list[[i]] <- lm(y ~ x1 + poly(x2, degree = i-1), data = sim_data)
}
train_mse <- c()
for (i in 1:6){
preds <- predict(model_list[[i]], sim_data)
train_mse[i] <- mean((sim_data$y - preds)^2)
}
set.seed(10)
e<-rnorm(n,0,1)
y<-1 + x1+x2+e
test_data <- data.frame(x1,x2,y)
test_mse <- c()
for (i in 1:6){
preds <- predict(model_list[[i]], test_data)
test_mse[i] <- mean((test_data$y - preds)^2)
}
bv_trade <- data.frame(model = 1:6, train_mse, test_mse)
bv_trade %>% pivot_longer(!model, values_to = "mse", names_to = "split") %>% ggplot(aes(x = model, y= mse, color = split), size = 1)+geom_line()+theme_bw()
moore <- read_delim("data/moore.csv", ";",
escape_double = FALSE, trim_ws = TRUE)
ggplot(moore, aes(x = Date, y = Transistors))+geom_point()+theme_bw()
simple_mod_p2 <- lm(Transistors ~ Data, data = moore)
simple_mod_p2 <- lm(Transistors ~ Date, data = moore)
pred_set <- data.frame(Date = c(1970, 2000, 2020))
predict(simple_mod_p2, pred_set)
predict(simple_mod_p2, c(1970, 2000, 2020))
simple_mod_p2 <- lm(Transistors ~ Date, data = moore)
pred_set <- data.frame(Date = c(1970, 2000, 2020))
predict(simple_mod_p2, pred_set)
log10(1265241824)
1069486032/10^8
1265241824/10^8
2625971270/10^8
library(gglm)
gglm(simple_mod_p2)
plot(simple_mod_p2)
log_mod_p2 <- lm(log2(Transistor) ~ Data, data = moore)
log_mod_p2 <- lm(log2(Transistors) ~ Data, data = moore)
log_mod_p2 <- lm(log2(Transistors) ~ Date, data = moore)
summary(log_mod_p2)
gglm(log_mod_p2
gglm(log_mod_p2)
gglm(log_mod_p2)
plot(log_mod_p2)
confint(log_mod_p2)
library(GGally)
ggpairs(wine)
wine <- read_csv("data/wine.csv")
library(GGally)
ggpairs(wine)
View(wine)
mod_p3 <- lm(Price ~ . - Age - FrancePop, data = wine)
summary(mod_p3)
mod_p3 <- lm(Price ~ . - Year - FrancePop, data = wine)
summary(mod_p3)
library(rsample)
prob3_cv <- vfold_cv(wine, v= 10)
set.seed(10)
library(rsample)
prob3_cv <- vfold_cv(wine, v= 10)
get_rmse <- function(split){
train <- analysis(split)
mod <- lm(Price ~ . - Year - FrancePop, data = train)
val <- assessment(split)
preds <- predict(mod, val)
rmse <- sqrt(
mean(
(val$Price - preds)^2
)
)
}
prob3_cv$rmse <- map_dbl(prob3_cv$splits, get_rmse)
mean(prob3_cv$rmse)
