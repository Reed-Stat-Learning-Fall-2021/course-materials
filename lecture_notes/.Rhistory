ridge_mod <- glmnet(x, y, alpha = 0, lambda = grid)
options(digits=3)
coef(ridge_mod)[1:5,1:6]
coef(ridge_mod)[1:5,95:100]
ridge_mod$lambda[1:20]
ridge_mod$lambda[17]
coef(ridge_mod)[,17]
plot(ridge_mod, xvar = "lambda")
library(broom)
tidied <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
x_tst <- model.matrix(Solubility ~., data = solTest)[,-1]
preds<- predict(ridge_mod, s = c(0.001, 1, 1000), newx = x_tst) %>% as.data.frame()
head(preds)
get_mse <- function(x){mean((solTest$Solubility-x)^2)}
preds %>% summarize(across(everything(), get_mse) )
set.seed(1010)
my_cv<-cv.glmnet(x, y, alpha = 0, lambda = grid, nfolds = 10)
plot(my_cv)
best_L<-my_cv$lambda.min
best_L
reg_L <-my_cv$lambda.1se
reg_L
tidied <- tidy(my_cv)
ggplot(tidied, aes(x = lambda, y = estimate))+geom_point( color = "red")+
scale_x_log10()+theme_bw()+labs(y = "MSE")+
geom_vline(xintercept = best_L, linetype = "dashed" )+
geom_vline(xintercept = reg_L, linetype = "dashed")
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(best15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
preds %>% summarize(across(everything(),get_mse)) %>% mutate(mse = c("MSE"))
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(best15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
best_L
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
z <- my_f(t,t)
my_f <- function(x,y){y-2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t,t)
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(z), aes(x = t, y =z))
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x,y){y-2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t,t)
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(z), aes(x = t, y =z))
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x,y){y-2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t,t)
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(z), aes(x = t, y =z))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x,y){y-2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t,t)
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(z), aes(x = t, y =z))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(t,z), aes(x = t, y =z))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x,y){y-2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t,t)
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(t,z), aes(x = t, y =z))
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x,y){y-2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t,t)
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+geom_line(data = data.frame(t,z), mapping = aes(x = t, y =z))
ggplot()+geom_point(d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), mapping = aes(x = t, y =z))
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), mapping = aes(x = t, y =z))
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))
my_f <- function(x){2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t)
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z))
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1)
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")+theme_bw
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")+theme_bw()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+theme_bw()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x){2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t)
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")+theme_bw()
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+theme_bw()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x){2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t)
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")+theme_bw()
set.seed(1)
x<-seq(0,1, length.out = 50)
z<- -cos(.75*pi*x)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point()
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
x<-seq(10,100, length.out = 50)
z<- -cos(.75*pi*x)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point()+theme_bw()
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point()+theme_bw()
ggplot(data.frame(x,as.factor(y)), aes(x = x ,y =y))+geom_point()+theme_bw()
ggplot(data.frame(x,y = as.factor(y)), aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
x<-seq(10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)
d2 <- data.frame(x,y = as.factor(y))
set.seed(1)
x<-seq(10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y = as.factor(y))
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
set.seed(1)
x<-seq(10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
lin_mod <- lm(y~x, data = d2)
lin_mod
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
lin_mod <- lm(y~x, data = d2)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
lin_mod
.57/.008
(.5+0.068449)/0.007743
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
lin_mod <- lm(y~x, data = d2)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()+geom_line(aes(x = x, y = z))
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y,z)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()+geom_line(aes(x = x, y = z))
set.seed(1)
lin_mod <- lm(y~x, data = d2)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()+geom_line(aes(x = x, y = z))
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()+geom_line(aes(x = x, y = z))
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y,z)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
lin_mod <- lm(y~x, data = d2)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()
include_graphics("img/log_reg.png")
1/3720
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_point()
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+theme_bw()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x){2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t)
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")+theme_bw()
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y,z)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
lin_mod <- lm(y~x, data = d2)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()
include_graphics("img/log_reg.png")
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
summary(Titanic)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_point()
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
ggplot(d, aes(x = x1, y = x2, color = y))+geom_point()+theme_bw()
set.seed(1)
n<-1000
x1<-runif(n, 0 ,1)
x2<-runif(n, 0 ,1)
r<-rnorm(100, 0, .1)
d<-data.frame(x1,x2,r) %>% mutate(y = ifelse(x2 -2*x1*(1-x1) > r, "1", "0"))
my_f <- function(x){2*x*(1-x)}
t <- seq(from = 0, to = 1, length = 100)
z <- my_f(t)
ggplot()+geom_point(data =d, aes(x = x1, y = x2, color = y))+geom_line(data = data.frame(t,z), aes(x = t, y = z), size = 1, color = "purple")+theme_bw()
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y,z)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
set.seed(1)
lin_mod <- lm(y~x, data = d2)
ggplot(d2, aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F)+theme_bw()
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()
include_graphics("img/log_reg.png")
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
summary(Titanic)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_point()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+ geom_point()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+ geom_jitter(height = 0.03)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = 0.03) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = 0.03) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_point(alpha = 0.5)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_point(alpha = 0.25)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_jitter(alpha = 0.25)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_jitter()
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_jitter(height = .01)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_jitter(height = .01, alpha = .25)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+ geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+ geom_jitter(height = .01, alpha = .5)+theme_bw()
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
summary(Titanic)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
summary(Titanic)
Titanic %>% count(age)
Titanic %>% count(sex)
Titanic %>% count(survived)
Titanic %>% select(age, sex, survived) %>% skimr
library(skimr)
Titanic %>% select(age, sex, survived) %>% skim()
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(survived)
library(skimr)
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(sex)
Titanic %>% count(survived)
log_mod <- glm(y~x, family = "binomial", data = d)
set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y,z)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
log_mod <- glm(y~x, family = "binomial", data = d2)
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()
log_mod
-3.99081 /(0.05459)
