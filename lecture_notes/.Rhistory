error <- c(error, new_error)
}
k <- c(1,2,5,10,20,50)
error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
error <- c(error, new_error)
}
error
k <- seq(from = 1, to = 100, length.out = 50)
error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
error <- c(error, new_error)
}
error
k <- seq(from = 1, to = 100, length.out = 50)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
set.seed(1052)
n<-50
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
?knn
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
t <- table(preds, new_d$Y)
plot(test_error)
test_error
test_error
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
test_error
plot(test_error)
k <- seq(from = 1, to = 51, by = 50)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
k <- seq(from = 1, to = 51, by = 50)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
set.seed(1052)
n<-50
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
set.seed(1052)
n<-50
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
plot(test_error)
test_error
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
k <- seq(from = 1, to = 51, by = 2)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
set.seed(1052)
n<-50
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
plot(test_error)
k <- seq(from = 1, to = 101, by = 4)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
plot(test_error)
error <- data.frame(k, train_error, test_error)
long_error <- pivot_longer(error, !k)
View(long_error)
?pivot_longer
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error")
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, values_to = "error")
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error")
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line()+theme_bw()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 2)+theme_bw()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+theme_bw()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_continuous(limits = rev)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_continuous(limits = rev)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_discrte(limits = rev)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_discrte(limits = rev)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_discrete(limits = rev)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_reverse()
set.seed(252)
n<-50
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_reverse()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_line(size = 1)+geom_point()+theme_bw()+scale_x_reverse()+geom_smooth(se = F)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color = error_type))+geom_point()+theme_bw()+scale_x_reverse()+geom_smooth(se = F)
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F)+
geom_point()+
theme_bw()+
scale_x_reverse()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F, size = 1)+
geom_point()+
theme_bw()+
scale_x_reverse()
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F, size = 1)+
geom_point()+
theme_bw()+
scale_x_reverse()+
labs(title = "Error Rates for KNN")
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+coord_fixed()+theme_bw()+labs(title = "Training Data and Bayes Classifier")
ggplot(d, aes(x = x1, y =x2, color = Y))+geom_point()+coord_fixed()+theme_bw()+annotate(geom = "point", x = .4, y = .83, color = "purple", size = 2) + annotate(geom = "text", x = .35, y = .83, label = "x0")+labs(x = "X1", y = "X2" )
#ggplot(d3, aes(x = a, y = b, color = Y))+geom_point()+annotate(geom = "point", x = .5, y = .5, color = "purple") + annotate(geom = "text", x = .53, y = .52, label = "x0")+labs(x = "X1", y = "X2" )
ggplot(d, aes(x = x1, y =x2, color = Y))+geom_point()+coord_fixed()+theme_bw()+annotate(geom = "point", x = .4, y = .83, color = "purple", size = 2) + annotate(geom = "text", x = .35, y = .85, label = "x0")+labs(x = "X1", y = "X2" )
#ggplot(d3, aes(x = a, y = b, color = Y))+geom_point()+annotate(geom = "point", x = .5, y = .5, color = "purple") + annotate(geom = "text", x = .53, y = .52, label = "x0")+labs(x = "X1", y = "X2" )
?geom_density2d_filled
big_grid <-expand.grid(x1 = seq(from = 0, to = 1, length.out = 100), x2 =  seq(from = 0, to = 1, length.out = 100) )
View(big_grid)
big_grid <-expand.grid(x1 = seq(from = 0, to = 1, length.out = 100), x2 =  seq(from = 0, to = 1, length.out = 100) ) %>% mutate(p = (x1^2 + x2^2)/2)
View(big_grid)
ggplot(big_grid, aes(x = x1, y = x2, color = p))+geom_contour()
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour()
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled()
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled()+coord_fixed()
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 100)+coord_fixed()
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 100)+coord_fixed()+theme(legend.box = NULL)
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 100)+coord_fixed()+theme(legend. position = "none")
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 100)+coord_fixed()+theme(legend.position = "none")
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 20)+coord_fixed()+theme(legend.position = "none")
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 20)+coord_fixed()+guides(fill = guide_colourbar(nbin = 100))
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_raster()+coord_fixed()+guides(fill = guide_colourbar(nbin = 100))
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 20)+coord_fixed()+guides(fill = guide_colourbar(nbin = 100))
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_contour_filled(bins = 20)+coord_fixed()+scale_fill_continuous()
ggplot(big_grid, aes(x = x1, y = x2, z = p))+geom_tile()
ggplot(big_grid, aes(x = x1, y = x2, color = p))+geom_tile()
ggplot(big_grid, aes(x = x1, y = x2, color = p))+geom_tile()+coord_fixed()
ggplot(big_grid, aes(x = x1, y = x2, color = p))+geom_tile()+coord_fixed()+scale_fill_continuous(type = "viridis")
ggplot(big_grid, aes(x = x1, y = x2, color = p))+geom_tile()+coord_fixed()+scale_fill_continuous(type = "viridis")
ggplot(big_grid, aes(x = x1, y = x2, color = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()
ggplot(big_grid, aes(x = x1, y = x2, color = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
big_grid <-expand.grid(x1 = seq(from = 0, to = 1, length.out = 50), x2 =  seq(from = 0, to = 1, length.out = 50) ) %>% mutate(p = (x1^2 + x2^2)/2)
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
big_grid <-expand.grid(x1 = seq(from = 0, to = 1, length.out = 60), x2 =  seq(from = 0, to = 1, length.out = 60) ) %>% mutate(p = (x1^2 + x2^2)/2)
big_grid <-expand.grid(x1 = seq(from = 0, to = 1, length.out = 60), x2 =  seq(from = 0, to = 1, length.out = 60) ) %>% mutate(p = (x1^2 + x2^2)/2)
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+scale_fill_continuous(type = "viridis")+geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red')+
geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red')+
geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red')+
geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
?scale_fill_gradient2
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red', midpoint = .5)+
geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
set.seed(252)
n<-100
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
k <- seq(from = 1, to = 101, by = 4)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F, size = 1)+
geom_point()+
theme_bw()+
scale_x_reverse()+
labs(title = "Error Rates for KNN")
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F, size = 1)+
geom_point()+
theme_bw()+
scale_x_reverse()+
labs(title = "Error Rates for KNN")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = TRUE,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
big_grid <-expand.grid(x1 = seq(from = 0, to = 1, length.out = 60), x2 =  seq(from = 0, to = 1, length.out = 60) ) %>% mutate(p = (x1^2 + x2^2)/2)
ggplot(big_grid, aes(x = x1, y = x2, fill = p))+
scale_fill_gradient2(low = 'blue', mid = 'white', high = 'red', midpoint = .5)+
geom_tile()+coord_fixed()+theme_bw()+labs(title = "Probability of Y = A")
set.seed(10)
n<-200
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
d<-data.frame(x1,x2,Y)
ggplot(d, aes(x = x1, y =x2, color = Y))+geom_point()+coord_fixed()+theme_bw()
X<-seq(0,1,length.out = 200)
Z<-sqrt(1 - X^2)
d2<-data.frame(X,Z)
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1)+coord_fixed()+theme_bw()
ggplot(d, aes(x = x1, y =x2, color = Y))+geom_point()+coord_fixed()+theme_bw()+annotate(geom = "point", x = .4, y = .83, color = "purple", size = 2) + annotate(geom = "text", x = .35, y = .85, label = "x0")+labs(x = "X1", y = "X2" )
#ggplot(d3, aes(x = a, y = b, color = Y))+geom_point()+annotate(geom = "point", x = .5, y = .5, color = "purple") + annotate(geom = "text", x = .53, y = .52, label = "x0")+labs(x = "X1", y = "X2" )
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+coord_fixed()+theme_bw()+labs(title = "Training Data and Bayes Classifier")
library(class)
test <- expand.grid(x1 = seq(from = 0, to = 1, length.out = 60), x2 =  seq(from = 0, to = 1, length.out = 60) )
k1 <- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =1
))
k2<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =2
))
k5<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =5
))
k10<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =10
))
k20<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =20
))
k50<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =50
))
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k1, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 1")
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k2, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 2")
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k5, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 5")
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k10, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 10")
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k20, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 20")
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k50, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 50")
k <- seq(from = 1, to = 101, by = 4)
train_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
train_error <- c(train_error, new_error)
}
set.seed(252)
n<-100
x1<-runif(n, 0,1 )
x2<-runif(n, 0,1)
p<-(x1^2 + x2^2)/2
Y<-c()
for (i in 1:n){
Y<-c(Y, sample(c("A","B"), 1, prob = c(p[i], 1 - p[i])))
}
new_d<-data.frame(x1,x2,Y)
test_error <- c()
for (i in k){
preds <- knn(d %>% select(x1,x2), new_d %>% select(x1,x2), d$Y, k =i)
t <- table(preds, new_d$Y)
new_error <- (sum(t)- sum(diag(t)))/sum(t)
test_error <- c(test_error, new_error)
}
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F, size = 1)+
geom_point()+
theme_bw()+
scale_x_reverse()+
labs(title = "Error Rates for KNN")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = T,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(class)
test <- expand.grid(x1 = seq(from = 0, to = 1, length.out = 60), x2 =  seq(from = 0, to = 1, length.out = 60) )
k1 <- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =1
))
k2<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =2
))
k5<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =5
))
k10<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =10
))
k20<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =20
))
k50<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =50
))
k100<- data.frame(test,Y = knn(
d %>% select(x1,x2), test, d$Y, k =100
))
ggplot()+geom_point(data = d, aes(x = x1, y =x2, color = Y))+geom_line(data = d2, aes(x = X, y = Z), color = "purple", size = 1, alpha = .5)+
geom_point(data = k100, aes(x = x1, y = x2, color = Y), alpha = .35, size = 1)+
coord_fixed()+theme_bw()+labs(title = "k = 100")
data.frame(k, train_error, test_error) %>%
pivot_longer(!k, names_to = "error_type", values_to = "error") %>%
ggplot( aes(x = k, y = error, color =error_type))+
geom_smooth(se = F, size = 1)+
geom_point()+
theme_bw()+
scale_x_reverse()+
labs(title = "Error Rates for KNN")
