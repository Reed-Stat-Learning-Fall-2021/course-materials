mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
?rpart.control
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .001))
rpart.plot(mushroom_deep)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.018)
rpart.plot(mushroom_prune)
rpart.plot(mushroom_no_poison)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
rpart.plot(mushroom_prune)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .0001))
rpart.plot(mushroom_deep)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .0001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
printcp(mushroom_prune)
summary(mushroom_prune)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
mushroom_prune <- prune(mushroom_deep, cp = 0.0016)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .0001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .0001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .0001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .00001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.000042)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .00001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
summary(tree_model)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
mushroom_preds3 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "pruned", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
mushroom_preds3 <- predict(mushroom_deep, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_deep, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
mushroom_preds4 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs4 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "pruned", obs = mushrooms_test$edibility,preds = mushroom_preds4,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "pruned") %>% conf_mat(truth = obs, estimate = preds)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
p <- seq(0,1, length = 100)
Error <- ifelse(p<0.5, p, 1-p)
Gini <- 2*p*(1-p)
Information <- ( -p*log2(p) - (1-p)*log2(1-p))/2
metrics <- data.frame(p,Error,Gini,Information) %>% pivot_longer(!p, names_to ="Metric", values_to = "impurity")
ggplot(metrics, aes(x = p, y = impurity, color = Metric))+
geom_line(size = 1)+theme_bw()
include_graphics("img/mushroom.jpg")
mushrooms <- read.csv("data/mushrooms_tidy.csv",stringsAsFactors=TRUE) %>% select(-X)
set.seed(2)
library(rsample)
mushroom_split <-initial_split(mushrooms, strata = edibility, prop = .80)
mushrooms_train <- training(mushroom_split)
mushrooms_test <- testing(mushroom_split)
glimpse(mushrooms_train)
library(rpart)
library(rpart.plot)
mushroom_tree<-rpart(edibility ~ ., data = mushrooms_train)
rpart.plot(mushroom_tree)
library(yardstick)
mushroom_preds <- predict(mushroom_tree, mushrooms_test, type = "class")
mushroom_probs <- predict(mushroom_tree, mushrooms_test, type = "prob")[,"edible"]
results <- data.frame(obs = mushrooms_test$edibility,preds = mushroom_preds,probs = mushroom_probs)
accuracy(results, truth = obs, estimate = preds)
conf_mat(results, truth = obs, estimate = preds)
include_graphics("img/skull.png")
penalty_matrix <- matrix(c(0,1,20,0), byrow = T, nrow = 2)
penalty_matrix
mushroom_no_poison <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix))
rpart.plot(mushroom_no_poison)
mushroom_preds2 <- predict(mushroom_no_poison, mushrooms_test, type = "class")
mushroom_probs2 <- predict(mushroom_no_poison, mushrooms_test, type = "prob")[,"edible"]
results <- results %>% mutate(model = "without loss") %>% rbind(data.frame(model = "with loss", obs = mushrooms_test$edibility,preds = mushroom_preds2,probs = mushroom_probs2))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "with loss") %>% conf_mat(truth = obs, estimate = preds)
mushroom_deep <- rpart(edibility ~., data = mushrooms_train,
parms = list(loss = penalty_matrix),
control = rpart.control(cp = .00001))
rpart.plot(mushroom_deep)
plotcp(mushroom_deep)
mushroom_prune <- prune(mushroom_deep, cp = 0.0042)
mushroom_preds3 <- predict(mushroom_deep, mushrooms_test, type = "class")
mushroom_probs3 <- predict(mushroom_deep, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "deep", obs = mushrooms_test$edibility,preds = mushroom_preds3,probs = mushroom_probs3))
mushroom_preds4 <- predict(mushroom_prune, mushrooms_test, type = "class")
mushroom_probs4 <- predict(mushroom_prune, mushrooms_test, type = "prob")[,"edible"]
results <- results %>%    rbind(data.frame(model = "pruned", obs = mushrooms_test$edibility,preds = mushroom_preds4,probs = mushroom_probs3))
results %>% group_by(model) %>% accuracy( truth = obs, estimate = preds)
results %>% filter(model == "pruned") %>% conf_mat(truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
results %>% filter(model == "deep") %>% conf_mat(truth = obs, estimate = preds)
roc_curve(results, truth = obs, probs)
roc_curve(results, truth = obs, probs) %>%
autoplot()
