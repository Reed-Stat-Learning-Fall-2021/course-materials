full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
set.seed(111)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.2)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.2)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
library(gridExtra)
g1<-ggplot(solTrain, aes(x = NumBonds, y = NumAtoms))+geom_point(alpha = .25)+theme_bw()
g2<-ggplot(solTrain, aes(x = SurfaceArea1, y = SurfaceArea2))+geom_point(alpha = .25)+theme_bw()
g3<-ggplot(solTrain, aes(x = NumNonHAtoms, y = NumNonHBonds))+geom_point(alpha = .25)+theme_bw()
g4<-ggplot(solTrain, aes(x = NumHalogen, y = NumChlorine))+geom_point(alpha = .25)+theme_bw()
grid.arrange(g1,g2,g3,g4, ncol = 2)
best15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = solTrain)
preds <- predict(best15, solTest)
data.frame(
mse = mean((solTest$Solubility - preds)^2)
)
summary(best15)
std_solTrain <- scale(solTrain) %>% as.data.frame()
g1 <- ggplot(solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title = "Solubility in solTrain")+theme_bw()
g2<-ggplot(std_solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title ="Solubility in std_solTrain")+theme_bw()
grid.arrange(g1,g2, ncol = 2)
rbind(solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round(sd(Solubility), 3)),
std_solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round( sd(Solubility),3) ) ) %>%
mutate(df = c("solTrain", "std_solTrain")) %>%
dplyr::select(df, everything())
std_best15 <- lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = std_solTrain)
summary(std_best15)
x<-model.matrix(Solubility ~., data = solTrain)[,-1]
y<-solTrain$Solubility
grid = 10^(seq( -5, 5, length = 100))
head(grid)
library(glmnet)
ridge_mod <- glmnet(x, y, alpha = 0, lambda = grid)
options(digits=3)
coef(ridge_mod)[1:5,1:6]
coef(ridge_mod)[1:5,95:100]
ridge_mod$lambda
ridge_mod$lambda[1:20]
ridge_mod$lambda[17]
coef(ridge_mod)[,17]
plot(ridge_mod, xvar = "lambda")
library(broom)
tidied <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
x_tst <- model.matrix(Solubility ~., data = solTest)[,-1]
preds<- predict(ridge_mod, s = c(0.001, 1, 1000), newx = x_tst) %>% as.data.frame()
head(preds)
get_mse <- function(x){mean((solTest$Solubility-x)^2)}
preds %>% summarize(across(everything(), get_mse) )
set.seed(1010)
my_cv<-cv.glmnet(x, y, alpha = 0, lambda = grid, nfolds = 10)
plot(my_cv)
best_L<-my_cv$lambda.min
best_L
reg_L <-my_cv$lambda.1se
reg_L
tidied <- tidy(my_cv)
ggplot(tidied, aes(x = lambda, y = estimate))+geom_point( color = "red")+
scale_x_log10()+theme_bw()+labs(y = "MSE")+
geom_vline(xintercept = best_L, linetype = "dashed" )+
geom_vline(xintercept = reg_L, linetype = "dashed")
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
set.seed(111)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.2)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.4)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
set.seed(111)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.2)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.4)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
library(gridExtra)
g1<-ggplot(solTrain, aes(x = NumBonds, y = NumAtoms))+geom_point(alpha = .25)+theme_bw()
g2<-ggplot(solTrain, aes(x = SurfaceArea1, y = SurfaceArea2))+geom_point(alpha = .25)+theme_bw()
g3<-ggplot(solTrain, aes(x = NumNonHAtoms, y = NumNonHBonds))+geom_point(alpha = .25)+theme_bw()
g4<-ggplot(solTrain, aes(x = NumHalogen, y = NumChlorine))+geom_point(alpha = .25)+theme_bw()
grid.arrange(g1,g2,g3,g4, ncol = 2)
best15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = solTrain)
preds <- predict(best15, solTest)
data.frame(
mse = mean((solTest$Solubility - preds)^2)
)
summary(best15)
std_solTrain <- scale(solTrain) %>% as.data.frame()
g1 <- ggplot(solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title = "Solubility in solTrain")+theme_bw()
g2<-ggplot(std_solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title ="Solubility in std_solTrain")+theme_bw()
grid.arrange(g1,g2, ncol = 2)
rbind(solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round(sd(Solubility), 3)),
std_solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round( sd(Solubility),3) ) ) %>%
mutate(df = c("solTrain", "std_solTrain")) %>%
dplyr::select(df, everything())
std_best15 <- lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = std_solTrain)
summary(std_best15)
x<-model.matrix(Solubility ~., data = solTrain)[,-1]
y<-solTrain$Solubility
grid = 10^(seq( -5, 5, length = 100))
head(grid)
library(glmnet)
ridge_mod <- glmnet(x, y, alpha = 0, lambda = grid)
options(digits=3)
coef(ridge_mod)[1:5,1:6]
coef(ridge_mod)[1:5,95:100]
ridge_mod$lambda[1:20]
ridge_mod$lambda[17]
coef(ridge_mod)[,17]
plot(ridge_mod, xvar = "lambda")
library(broom)
tidied <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
x_tst <- model.matrix(Solubility ~., data = solTest)[,-1]
preds<- predict(ridge_mod, s = c(0.001, 1, 1000), newx = x_tst) %>% as.data.frame()
head(preds)
get_mse <- function(x){mean((solTest$Solubility-x)^2)}
preds %>% summarize(across(everything(), get_mse) )
set.seed(1010)
my_cv<-cv.glmnet(x, y, alpha = 0, lambda = grid, nfolds = 10)
plot(my_cv)
best_L<-my_cv$lambda.min
best_L
reg_L <-my_cv$lambda.1se
reg_L
tidied <- tidy(my_cv)
ggplot(tidied, aes(x = lambda, y = estimate))+geom_point( color = "red")+
scale_x_log10()+theme_bw()+labs(y = "MSE")+
geom_vline(xintercept = best_L, linetype = "dashed" )+
geom_vline(xintercept = reg_L, linetype = "dashed")
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
set.seed(111)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.25)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.5)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
library(gridExtra)
g1<-ggplot(solTrain, aes(x = NumBonds, y = NumAtoms))+geom_point(alpha = .25)+theme_bw()
g2<-ggplot(solTrain, aes(x = SurfaceArea1, y = SurfaceArea2))+geom_point(alpha = .25)+theme_bw()
g3<-ggplot(solTrain, aes(x = NumNonHAtoms, y = NumNonHBonds))+geom_point(alpha = .25)+theme_bw()
g4<-ggplot(solTrain, aes(x = NumHalogen, y = NumChlorine))+geom_point(alpha = .25)+theme_bw()
grid.arrange(g1,g2,g3,g4, ncol = 2)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
set.seed(111)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.25)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.5)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
library(gridExtra)
g1<-ggplot(solTrain, aes(x = NumBonds, y = NumAtoms))+geom_point(alpha = .25)+theme_bw()
g2<-ggplot(solTrain, aes(x = SurfaceArea1, y = SurfaceArea2))+geom_point(alpha = .25)+theme_bw()
g3<-ggplot(solTrain, aes(x = NumNonHAtoms, y = NumNonHBonds))+geom_point(alpha = .25)+theme_bw()
g4<-ggplot(solTrain, aes(x = NumHalogen, y = NumChlorine))+geom_point(alpha = .25)+theme_bw()
grid.arrange(g1,g2,g3,g4, ncol = 2)
best15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = solTrain)
preds <- predict(best15, solTest)
data.frame(
mse = mean((solTest$Solubility - preds)^2)
)
summary(best15)
std_solTrain <- scale(solTrain) %>% as.data.frame()
g1 <- ggplot(solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title = "Solubility in solTrain")+theme_bw()
g2<-ggplot(std_solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title ="Solubility in std_solTrain")+theme_bw()
grid.arrange(g1,g2, ncol = 2)
rbind(solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round(sd(Solubility), 3)),
std_solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round( sd(Solubility),3) ) ) %>%
mutate(df = c("solTrain", "std_solTrain")) %>%
dplyr::select(df, everything())
std_best15 <- lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = std_solTrain)
summary(std_best15)
x<-model.matrix(Solubility ~., data = solTrain)[,-1]
y<-solTrain$Solubility
grid = 10^(seq( -5, 5, length = 100))
head(grid)
library(glmnet)
ridge_mod <- glmnet(x, y, alpha = 0, lambda = grid)
options(digits=3)
coef(ridge_mod)[1:5,1:6]
coef(ridge_mod)[1:5,95:100]
ridge_mod$lambda[1:20]
ridge_mod$lambda[17]
coef(ridge_mod)[,17]
plot(ridge_mod, xvar = "lambda")
library(broom)
tidied <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
x_tst <- model.matrix(Solubility ~., data = solTest)[,-1]
preds<- predict(ridge_mod, s = c(0.001, 1, 1000), newx = x_tst) %>% as.data.frame()
head(preds)
get_mse <- function(x){mean((solTest$Solubility-x)^2)}
preds %>% summarize(across(everything(), get_mse) )
set.seed(1010)
my_cv<-cv.glmnet(x, y, alpha = 0, lambda = grid, nfolds = 10)
plot(my_cv)
best_L<-my_cv$lambda.min
best_L
reg_L <-my_cv$lambda.1se
reg_L
tidied <- tidy(my_cv)
ggplot(tidied, aes(x = lambda, y = estimate))+geom_point( color = "red")+
scale_x_log10()+theme_bw()+labs(y = "MSE")+
geom_vline(xintercept = best_L, linetype = "dashed" )+
geom_vline(xintercept = reg_L, linetype = "dashed")
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
set.seed(1013)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.25)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.5)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
set.seed(1013)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.25)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.5)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
library(gridExtra)
g1<-ggplot(solTrain, aes(x = NumBonds, y = NumAtoms))+geom_point(alpha = .25)+theme_bw()
g2<-ggplot(solTrain, aes(x = SurfaceArea1, y = SurfaceArea2))+geom_point(alpha = .25)+theme_bw()
g3<-ggplot(solTrain, aes(x = NumNonHAtoms, y = NumNonHBonds))+geom_point(alpha = .25)+theme_bw()
g4<-ggplot(solTrain, aes(x = NumHalogen, y = NumChlorine))+geom_point(alpha = .25)+theme_bw()
grid.arrange(g1,g2,g3,g4, ncol = 2)
best15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = solTrain)
preds <- predict(best15, solTest)
data.frame(
mse = mean((solTest$Solubility - preds)^2)
)
summary(best15)
std_solTrain <- scale(solTrain) %>% as.data.frame()
g1 <- ggplot(solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title = "Solubility in solTrain")+theme_bw()
g2<-ggplot(std_solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title ="Solubility in std_solTrain")+theme_bw()
grid.arrange(g1,g2, ncol = 2)
rbind(solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round(sd(Solubility), 3)),
std_solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round( sd(Solubility),3) ) ) %>%
mutate(df = c("solTrain", "std_solTrain")) %>%
dplyr::select(df, everything())
std_best15 <- lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = std_solTrain)
summary(std_best15)
x<-model.matrix(Solubility ~., data = solTrain)[,-1]
y<-solTrain$Solubility
grid = 10^(seq( -5, 5, length = 100))
head(grid)
library(glmnet)
ridge_mod <- glmnet(x, y, alpha = 0, lambda = grid)
options(digits=3)
coef(ridge_mod)[1:5,1:6]
coef(ridge_mod)[1:5,95:100]
ridge_mod$lambda[1:20]
ridge_mod$lambda[17]
coef(ridge_mod)[,17]
plot(ridge_mod, xvar = "lambda")
library(broom)
tidied <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
x_tst <- model.matrix(Solubility ~., data = solTest)[,-1]
preds<- predict(ridge_mod, s = c(0.001, 1, 1000), newx = x_tst) %>% as.data.frame()
head(preds)
get_mse <- function(x){mean((solTest$Solubility-x)^2)}
preds %>% summarize(across(everything(), get_mse) )
set.seed(1010)
my_cv<-cv.glmnet(x, y, alpha = 0, lambda = grid, nfolds = 10)
plot(my_cv)
best_L<-my_cv$lambda.min
best_L
reg_L <-my_cv$lambda.1se
reg_L
tidied <- tidy(my_cv)
ggplot(tidied, aes(x = lambda, y = estimate))+geom_point( color = "red")+
scale_x_log10()+theme_bw()+labs(y = "MSE")+
geom_vline(xintercept = best_L, linetype = "dashed" )+
geom_vline(xintercept = reg_L, linetype = "dashed")
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
set.seed(1013)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.3)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.3)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
set.seed(1013)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY) %>% sample_frac(.3)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY) %>% sample_frac(.3)
solTest <- solTest %>% dplyr::select(!starts_with("FP"))
solTrain <- solTrain %>%  dplyr::select(!starts_with("FP"))
library(gridExtra)
g1<-ggplot(solTrain, aes(x = NumBonds, y = NumAtoms))+geom_point(alpha = .25)+theme_bw()
g2<-ggplot(solTrain, aes(x = SurfaceArea1, y = SurfaceArea2))+geom_point(alpha = .25)+theme_bw()
g3<-ggplot(solTrain, aes(x = NumNonHAtoms, y = NumNonHBonds))+geom_point(alpha = .25)+theme_bw()
g4<-ggplot(solTrain, aes(x = NumHalogen, y = NumChlorine))+geom_point(alpha = .25)+theme_bw()
grid.arrange(g1,g2,g3,g4, ncol = 2)
best15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = solTrain)
preds <- predict(best15, solTest)
data.frame(
mse = mean((solTest$Solubility - preds)^2)
)
summary(best15)
std_solTrain <- scale(solTrain) %>% as.data.frame()
g1 <- ggplot(solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title = "Solubility in solTrain")+theme_bw()
g2<-ggplot(std_solTrain, aes(x = Solubility))+geom_histogram(color = "white")+labs(title ="Solubility in std_solTrain")+theme_bw()
grid.arrange(g1,g2, ncol = 2)
rbind(solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round(sd(Solubility), 3)),
std_solTrain %>%
summarize(mean_sol = round(mean(Solubility), 3),
sd_sol =  round( sd(Solubility),3) ) ) %>%
mutate(df = c("solTrain", "std_solTrain")) %>%
dplyr::select(df, everything())
std_best15 <- lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings
-NumNitrogen -NumOxygen,
data = std_solTrain)
summary(std_best15)
x<-model.matrix(Solubility ~., data = solTrain)[,-1]
y<-solTrain$Solubility
grid = 10^(seq( -5, 5, length = 100))
head(grid)
library(glmnet)
ridge_mod <- glmnet(x, y, alpha = 0, lambda = grid)
options(digits=3)
coef(ridge_mod)[1:5,1:6]
coef(ridge_mod)[1:5,95:100]
ridge_mod$lambda[1:20]
ridge_mod$lambda[17]
coef(ridge_mod)[,17]
plot(ridge_mod, xvar = "lambda")
library(broom)
tidied <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
x_tst <- model.matrix(Solubility ~., data = solTest)[,-1]
preds<- predict(ridge_mod, s = c(0.001, 1, 1000), newx = x_tst) %>% as.data.frame()
head(preds)
get_mse <- function(x){mean((solTest$Solubility-x)^2)}
preds %>% summarize(across(everything(), get_mse) )
set.seed(1010)
my_cv<-cv.glmnet(x, y, alpha = 0, lambda = grid, nfolds = 10)
plot(my_cv)
best_L<-my_cv$lambda.min
best_L
reg_L <-my_cv$lambda.1se
reg_L
tidied <- tidy(my_cv)
ggplot(tidied, aes(x = lambda, y = estimate))+geom_point( color = "red")+
scale_x_log10()+theme_bw()+labs(y = "MSE")+
geom_vline(xintercept = best_L, linetype = "dashed" )+
geom_vline(xintercept = reg_L, linetype = "dashed")
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(mod15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(best15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
preds %>% summarize(across(everything(),get_mse)) %>% mutate(mse = c("MSE"))
full_mod <- lm(Solubility ~ ., data = solTrain)
preds <- data.frame(
full = predict(full_mod, solTest),
best_15 = predict(best15, solTest),
rr_min = c(predict(ridge_mod, s = best_L, newx = x_tst)),
rr_1se = c(predict(ridge_mod, s = reg_L, newx = x_tst))
)
preds %>% summarize(across(everything(),get_mse))
best_L
