geom_abline(slope = beta_1, intercept = 12)+
geom_point()+
geom_abline(data = many_mods, slope = slope, intercept = intercept, alpha = .02)+
geom_smooth(method = "lm", se = F)+
theme_bw()
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12)+
geom_point()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
annotate("text", x = 26, y = 32.5, label = "hat(f)(x)", color = "blue", parse = T)+
geom_smooth(method = "lm", se = F)+
theme_bw()
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod")+
geom_point()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
annotate("text", x = 26, y = 32.5, label = "hat(f)(x)", color = "blue", parse = T)+
geom_smooth(method = "lm", se = F)+
theme_bw()
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
geom_point()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
annotate("text", x = 26, y = 32.5, label = "hat(f)(x)", color = "blue", parse = T)+
geom_smooth(method = "lm", se = F)+
theme_bw()
set.seed(145)
n <- 60
beta_0 <- 12
beta_1 <- .7
sigma <- 2
x <- rnorm(n, mean = 20, sd = 3)
f_mean <- beta_0 + beta_1*x
y <- f_mean + rnorm(n, mean = 0, sd = sigma)
my_data <- data.frame(x,y)
ggplot(my_data, aes(x = x, y = y))+geom_abline(slope = beta_1, intercept = 12)+geom_point()+theme_bw()+annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
set.seed(145)
n <- 60
beta_0 <- 12
beta_1 <- .7
sigma <- 2
x <- rnorm(n, mean = 20, sd = 3)
f_mean <- beta_0 + beta_1*x
y <- f_mean + rnorm(n, mean = 0, sd = sigma)
my_data <- data.frame(x,y)
ggplot(my_data, aes(x = x, y = y))+geom_abline(slope = beta_1, intercept = 12)+geom_point()+theme_bw()+annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)
set.seed(145)
n <- 60
beta_0 <- 12
beta_1 <- .7
sigma <- 2
x <- rnorm(n, mean = 20, sd = 3)
f_mean <- beta_0 + beta_1*x
y <- f_mean + rnorm(n, mean = 0, sd = sigma)
my_data <- data.frame(x,y)
ggplot(my_data, aes(x = x, y = y))+geom_abline(slope = beta_1, intercept = 12)+
geom_point()+
theme_bw()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
geom_point()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
annotate("text", x = 26, y = 32.5, label = "hat(f)(x)", color = "blue", parse = T)+
geom_smooth(method = "lm", se = F)+
theme_bw()
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
geom_point()+
geom_abline(data = many_mods, slope = slope, intercept = intercept, alpha = .02)+
geom_smooth(method = "lm", se = F)+
theme_bw()
ggplot(my_data, aes(x = x, y = y))+
geom_point()+
geom_abline(data = many_mods, slope = slope, intercept = intercept, alpha = .02)+
geom_smooth(method = "lm", se = F)+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
theme_bw()
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
geom_point()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
annotate("text", x = 26, y = 32.5, label = "hat(f)(x)", color = "black", parse = T)+
geom_smooth(method = "lm", se = F, color = "black")+
theme_bw()
set.seed(1020)
it <- 1000
slope <- rep(NA, times = it)
intercept <- rep(NA, times = it)
for(i in 1:it) {
x <- rnorm(n, mean = 20, sd = 3)
f_mean <- beta_0 + beta_1 * x
y <- f_mean + rnorm(n, mean = 0, sd = sigma)
slope[i] <- lm(y ~ x)$coef[[2]]
intercept[i] <- lm(y ~ x)$coef[[1]]
}
many_mods <- data.frame(slope, intercept)
ggplot(my_data, aes(x = x, y = y))+
geom_point()+
geom_abline(data = many_mods, slope = slope, intercept = intercept, alpha = .02)+
geom_smooth(method = "lm", se = F, color = "black")+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
theme_bw()
plot(20, 25, xlim = c(12, 28), ylim = c(17, 35), ylab = "y", xlab = "x", type = "n") # set up an empty plot
points(x, f_data, pch = 16, col = "steelblue") # add generated data
for(i in 1:it) {
abline(coef_mat[i, 1], coef_mat[i, 2], col = rgb(0, 0, 0, 0.02))
}
abline(a = beta_0, b = beta_1, col = "goldenrod", lwd = 2) # add mean function
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
# mean(beta_1s)
# sd(beta_1s)
ggplot(my_data, aes(x = x, y = y))+
geom_point(color = "steelblue")+
geom_abline(data = many_mods, slope = slope, intercept = intercept, alpha = .02)+
geom_smooth(method = "lm", se = F, color = "black")+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
theme_bw()
set.seed(145)
n <- 60
beta_0 <- 12
beta_1 <- .7
sigma <- 2
x <- rnorm(n, mean = 20, sd = 3)
f_mean <- beta_0 + beta_1*x
y <- f_mean + rnorm(n, mean = 0, sd = sigma)
my_data <- data.frame(x,y)
ggplot(my_data, aes(x = x, y = y))+geom_abline(slope = beta_1, intercept = 12)+
geom_point(color = "steelblue")+
theme_bw()+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)
ggplot(my_data, aes(x = x, y = y))+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
geom_point(color = "steelblue")+
annotate("text", x = 26, y = 29, label = "f(x)", color = "goldenrod",parse = T)+
annotate("text", x = 26, y = 32.5, label = "hat(f)(x)", color = "black", parse = T)+
geom_smooth(method = "lm", se = F, color = "black")+
theme_bw()
set.seed(1020)
it <- 1000
slope <- rep(NA, times = it)
intercept <- rep(NA, times = it)
for(i in 1:it) {
x <- rnorm(n, mean = 20, sd = 3)
f_mean <- beta_0 + beta_1 * x
y <- f_mean + rnorm(n, mean = 0, sd = sigma)
slope[i] <- lm(y ~ x)$coef[[2]]
intercept[i] <- lm(y ~ x)$coef[[1]]
}
many_mods <- data.frame(slope, intercept)
ggplot(my_data, aes(x = x, y = y))+
geom_point(color = "steelblue")+
geom_abline(data = many_mods, slope = slope, intercept = intercept, alpha = .02)+
geom_smooth(method = "lm", se = F, color = "black")+
geom_abline(slope = beta_1, intercept = 12,color = "goldenrod", size = 1)+
theme_bw()
ggplot(my_data, aes(x = slope))+geom_histogram(bins = 20, color ="white")
ggplot(my_data, aes(x = slope))+geom_histogram(bins = 20, color ="white")
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, color ="white")
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]))
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
# mean(beta_1s)
# sd(beta_1s)
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
abline(v = beta_1, col = "orange", lwd = 2)
text(beta_1+.02, .5, expression(beta[1]))
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod")+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
lines(xl, dnorm(xl, mean = beta_1, sd = sqrt(sigma^2/sum((x-mean(x))^2))),
lwd = 2, col = "thistle3")
ggplot(many_mods, aes(x = slope))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_density()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
?geom_density
ggplot(many_mods, aes(x = slope, after_stat(count)))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_density()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_density()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
sqrt(sigma^2/sum((x-mean(x))^2))
z <- dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
t <- seq(from = .5, to = 1, length.out = 100)
z <- dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
z <- 60*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z))+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
z <- sqrt(60)*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
t <- seq(from = .5, to = 1, length.out = 100)
z <- sqrt(60)*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z))+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
z <- sqrt(1000)*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
t <- seq(from = .5, to = 1, length.out = 100)
z <- sqrt(1000)*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z))+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- sqrt(1000)*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(bins = 20, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
100/25
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.025, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
z <- 1000*.04*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.04*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.03*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.03*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
abline(v = beta_1, col = "orange", lwd = 2)
text(beta_1+.02, .5, expression(beta[1]))
xl <- seq(min(beta_1s), max(beta_1s), length.out = 100)
lines(xl, dnorm(xl, mean = beta_1, sd = sqrt(sigma^2/sum((x-mean(x))^2))),
lwd = 2, col = "thistle3")
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.03*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
abline(v = beta_1, col = "orange", lwd = 2)
text(beta_1+.02, .5, expression(beta[1]))
xl <- seq(min(beta_1s), max(beta_1s), length.out = 100)
lines(xl, dnorm(xl, mean = beta_1, sd = sqrt(sigma^2/sum((x-mean(x))^2))),
lwd = 2, col = "thistle3")
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.03*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.04*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
knitr::opts_chunk$set(echo = FALSE,
fig.align = "center",
message = F,
warning = F,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
## Constructing a CI for $\hat{\beta}_1$
\[ \hat{\beta}_1 \pm t_{\alpha/2, n-2} \cdot SE(\hat{\beta}_1) \]
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = TRUE,
fig.width = 6,
fig.height = 4
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(gglm)
install.packages("gglm")
library(gglm)
?gglm
gglm(my_mod)
my_mod<-lm(Y ~ X, data = my_data)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = TRUE,
fig.width = 6,
fig.height = 4
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
set.seed(254)
X<-runif(20, 1, 4)
Y<-X + rnorm(20,0,0.2)
dd<-tibble(X,Y)
ggplot(dd )+
geom_point( aes(x = X, y =Y))+
geom_point( aes( x = 0, y = Y), color = "darkgrey")+
geom_point( aes( x = X, y = 0),color = "darkgrey")+
annotate(geom = "text", x = 1, y = 3, label = "R = 0.97")+
annotate(geom = "text", x = 1, y = 2.5, label = "R^2 = 0.94")
set.seed(254)
X<-runif(20, 1, 4)
Y<- X/10+rnorm(20,0,1)
dd<-tibble(X,Y)
ggplot(dd )+
geom_point( aes(x = X, y =Y))+
geom_point( aes( x = 0, y = Y), color = "darkgrey")+
geom_point( aes( x = X, y = 0),color = "darkgrey")+
annotate(geom = "text", x = 1, y = 3, label = "R = 0.27")+
annotate(geom = "text", x = 1, y = 2.5, label = "R^2 = 0.07")
mod_credit<-lm(Balance ~ Income + Limit , data = Credit)
summary(mod_credit)
X = seq(0,8, by = .1)
Y= df(X, 4, 20)
data.frame(X,Y) %>%
ggplot(aes(x= X, y = Y))+
geom_line()+
labs(title = "Density for 4 predictors, 25 observations", x = "F")
include_graphics("img/3dplot_plane.png")
set.seed(1)
x_nl<-runif(50, 0, 1)
y_nl<- 1  +.5*x_nl-x_nl^2 + rnorm(50, 0,.03)
df_nl<-data.frame(x_nl, y_nl)
ggplot(df_nl, aes(x = x_nl, y = y_nl))+geom_point()+geom_smooth(method ="lm", se = F)+labs(x = "X", y = "Y")
set.seed(1)
x_cor<-seq(0,1, length.out = 50)
y_cor<-  sin(x_cor*20)+rnorm(50, 0, .55)
df_cor<-data.frame(x_cor, y_cor)
ggplot(df_cor, aes(x = x_cor, y = y_cor))+geom_point()+labs(x = "X", y = "Residual")+geom_abline(intercept = 0, slope = 0)
set.seed(3)
x_var<-seq(0, 1, length.out = 50)
sd<-seq(from = .01, to = .4, length.out = 50)
y_var<- x_var + rnorm(50, 0, sd )
df_var<-data.frame(x_var, y_var)
ggplot(df_var, aes(x = x_var, y = y_var))+geom_point()+labs(x = "X", y = "Y")+geom_smooth(method ="lm", se = F)
set.seed(3)
x_out<-seq(0, 1, length.out = 50)
y_out<- x_out + rnorm(50, 0, .1 )
df_out<-data.frame(x_out = c(x_out, .5), y_out = c(y_out,1.1))
ggplot(df_out, aes(x = x_out, y = y_out))+geom_point()+labs(x = "X", y = "Y")+geom_smooth(method ="lm", se = F)
set.seed(3)
x_out<-seq(0, 1, length.out = 50)
y_out<- x_out + rnorm(50, 0, .1 )
df_out<-data.frame(x_out = c(x_out, 0), y_out = c(y_out,1.1))
df_out1<-data.frame(x_out, y_out)
ggplot(df_out, aes(x = x_out, y = y_out))+geom_point()+labs(x = "X", y = "Y")+geom_smooth(method ="lm", se = F) + geom_smooth(data = df_out1, aes(x = x_out, y=y_out), method = "lm", se = F, color = "red")
set.seed(3)
x_1<-seq(0, 1, length.out = 50)
x_2<- x_1+rnorm(50,0, .1)
y_12<- x_1+x_2
df_coll<-data.frame(x_1, x_2, y_12)
ggplot(df_coll, aes(x = x_1, y = x_2))+geom_point()+labs(x = "X1", y = "X2")+geom_smooth(method ="lm", se = F)
set.seed(700)
X <- runif(80, 0, 1)
e <- rnorm(80, 0, .25)
Y <- 1 + 2*X + e
my_data <- data.frame(X,Y)
ggplot(my_data, aes(x = X , y = Y)) + geom_point()
my_mod<-lm(Y ~ X, data = my_data)
beta_0 <- summary(my_mod)$coefficients[1]
beta_1 <- summary(my_mod)$coefficients[2]
c(beta_0, beta_1)
gglm(my_mod)
gglm(my_mod) %>% pull()
library(gglm)
ggplot(data = model) +stat_fitted_resid()
ggplot(data = my_mod) +stat_fitted_resid()
ggplot(data = my_mod) +stat_normal_qq()
ggplot(data = my_mod) +scale_location()
ggplot(data = my_mod) +stat_scale_location()
ggplot(data = my_mod) +stat_resid_leverage()
ggplot(data = my_mod) +stat_resid_leverage()
gglm(my_mod)
