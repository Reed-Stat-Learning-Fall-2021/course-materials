discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0))
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0, color = Y))
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d0), color = "teal")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d0), color = "teel")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d0), color = "teal")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d0), color = "blue")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()
c<- (mu0 + mu1)/2 + (sigma2*log(pi0 - pi1))/(mu1-mu0)
c
c
c<- (mu0 + mu1)/2 + (sigma2*log(pi0) - log(pi1))/(mu1-mu0)
c
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,3)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,4)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,4)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,4)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
d0 <- discriminant(d$X, pi0, mu0, sigma2)
d1 <- discriminant(d$X, pi1, mu1, sigma2)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,4)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
x<-seq(from = -3, to = 7, by = .1)
f1<-dnorm(x,0,1)
f2<-dnorm(x,4,1)
d<-data.frame(x,f1,f2)
ggplot(d) + geom_line(aes(x = x, y = f1), color = "red")+geom_line(aes(x = x, y = f2), color = "blue") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
set.seed(212)
n<-100
Y<-rep(c("0","1"), c(3*n/4, n/4))
X<-c(rnorm(3*n/4, 1, 1), rnorm(n/4, 3, 1) )
d<-data.frame(X,Y)
library(dplyr)
train_d<-d %>% sample_frac(.75)
test_d<-anti_join(d, train_d)
mu0<-d %>% filter(Y == 0) %>% summarise(mu = mean(X) ) %>% pull()
mu1<-d %>% filter(Y == 1) %>% summarise(mu = mean(X) ) %>% pull()
ssx <- d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1), n()) %>% pull(2,)
sigma2 <- sum(ssx)/(n - 2)
density0 <- function(x){dnorm(x, mean = mu0, sd = sqrt(sigma2))}
density1 <- function(x){dnorm(x, mean = mu1, sd = sqrt(sigma2))}
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
d %>% group_by(Y) %>% summarize(pi = n()/n, mu = mean(X))
d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1)) %>%
summarize(sigma_sq = sum(ssx)/(n-2))
c<- (mu0 + mu1)/2 + (sigma2*log(pi0) - log(pi1))/(mu1-mu0)
c
discriminant <- function(x, pi, mu, sigma2) {
x * (mu/sigma2) - (mu^2)/(2 * sigma2) + log(pi)
}
d0 <- discriminant(d$X, pi0, mu0, sigma2)
d1 <- discriminant(d$X, pi1, mu1, sigma2)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) + geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+geom_line(aes(x = X, y = d0), color = "salmon")+geom_line(aes(x = X, y = d1), color = "blue")+theme_bw()+ylim(-1,4)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")+labs(x = "X", y = "discriminant")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,4)+
labs(x = "X", y = "discriminant")
d0 <- discriminant(d$X, pi0, mu0, sigma2)
d1 <- discriminant(d$X, pi1, mu1, sigma2)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,5)+
labs(x = "X", y = "discriminant")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,10)+
labs(x = "X", y = "discriminant")
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+
labs(x = "X", y = "discriminant")
?ylim
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .01)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .5)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .1)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 2, y = 6, label = "c = 2.48", color = "purple")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 2, y = 6, label = "c = 2.48", color = "purple", size = 1)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 2, y = 6, label = "c = 2.48", color = "purple", size = 4)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 2, y = 6, label = "c = 2.48", color = "purple", size = 2)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 2, y = 6, label = "c = 2.48", color = "purple", size = 3)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 2, y = 6, label = "c = 2.48", color = "purple", size = 3)
ggplot()+geom_line(data = data1, aes(x = t, y = dx1), color = "red")+geom_line(data = data2, aes(x = t, y = dx2), color = "blue") +labs(x = "X", y = "discriminant") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)  + ylim(-1,3)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
ggplot()+labs(x = "X", y = "density") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)    +geom_density(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
ggplot()+labs(x = "X", y = "density") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)    +geom_density(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot()+labs(x = "X", y = "density") +theme_bw()+geom_point(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)    +geom_density(data = d %>% mutate(Y = as.factor(Y)), aes(x = X, color =Y) ,y = 0, alpha = .55)+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
pi0 <- sum(d$Y ==0)/n
pi0
pi1 <- sum(d$Y ==1)/n
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
x<-seq(from = -3, to = 7, by = .1)
f1<-dnorm(x,0,1)
f2<-dnorm(x,4,1)
d<-data.frame(x,f1,f2)
ggplot(d) + geom_line(aes(x = x, y = f1), color = "red")+geom_line(aes(x = x, y = f2), color = "blue") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
set.seed(212)
n<-100
Y<-rep(c("0","1"), c(3*n/4, n/4))
X<-c(rnorm(3*n/4, 1, 1), rnorm(n/4, 3, 1) )
d<-data.frame(X,Y)
library(dplyr)
train_d<-d %>% sample_frac(.75)
test_d<-anti_join(d, train_d)
mu0<-d %>% filter(Y == 0) %>% summarise(mu = mean(X) ) %>% pull()
mu1<-d %>% filter(Y == 1) %>% summarise(mu = mean(X) ) %>% pull()
ssx <- d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1), n()) %>% pull(2,)
sigma2 <- sum(ssx)/(n - 2)
density0 <- function(x){dnorm(x, mean = mu0, sd = sqrt(sigma2))}
density1 <- function(x){dnorm(x, mean = mu1, sd = sqrt(sigma2))}
pi0 <- sum(d$Y ==0)/n
pi1 <- sum(d$Y ==1)/n
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
pi0 <- sum(d$Y ==0)/n
pi0
set.seed(212)
n<-100
Y<-rep(c("0","1"), c(3*n/4, n/4))
X<-c(rnorm(3*n/4, 1, 1), rnorm(n/4, 3, 1) )
d<-data.frame(X,Y)
pi1 <- sum(d$Y =="1")/n
pi1
pi0
um(d$Y =="0")/n
sum(d$Y =="0")/n
mu0<-d %>% filter(Y == 0) %>% summarise(mu = mean(X) ) %>% pull()
mu1<-d %>% filter(Y == 1) %>% summarise(mu = mean(X) ) %>% pull()
ssx <- d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1), n()) %>% pull(2,)
sigma2 <- sum(ssx)/(n - 2)
density0 <- function(x){dnorm(x, mean = mu0, sd = sqrt(sigma2))}
density1 <- function(x){dnorm(x, mean = mu1, sd = sqrt(sigma2))}
pi0 <- sum(d$Y =="0")/n
pi1 <- sum(d$Y =="1")/n
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
x<-seq(from = -3, to = 7, by = .1)
f1<-dnorm(x,0,1)
f2<-dnorm(x,4,1)
d<-data.frame(x,f1,f2)
ggplot(d) + geom_line(aes(x = x, y = f1), color = "red")+geom_line(aes(x = x, y = f2), color = "blue") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
set.seed(212)
n<-100
Y<-rep(c("0","1"), c(3*n/4, n/4))
X<-c(rnorm(3*n/4, 1, 1), rnorm(n/4, 3, 1) )
d<-data.frame(X,Y)
mu0<-d %>% filter(Y == 0) %>% summarise(mu = mean(X) ) %>% pull()
mu1<-d %>% filter(Y == 1) %>% summarise(mu = mean(X) ) %>% pull()
ssx <- d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1), n()) %>% pull(2,)
sigma2 <- sum(ssx)/(n - 2)
density0 <- function(x){dnorm(x, mean = mu0, sd = sqrt(sigma2))}
density1 <- function(x){dnorm(x, mean = mu1, sd = sqrt(sigma2))}
pi0 <- sum(d$Y =="0")/n
pi1 <- sum(d$Y =="1")/n
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
d %>% group_by(Y) %>% summarize(pi = n()/n, mu = mean(X))
d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1)) %>%
summarize(sigma_sq = sum(ssx)/(n-2))
c<- (mu0 + mu1)/2 + (sigma2*log(pi0) - log(pi1))/(mu1-mu0)
c
discriminant <- function(x, pi, mu, sigma2) {
x * (mu/sigma2) - (mu^2)/(2 * sigma2) + log(pi)
}
d0 <- discriminant(d$X, pi0, mu0, sigma2)
d1 <- discriminant(d$X, pi1, mu1, sigma2)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
x<-seq(from = -3, to = 7, by = .1)
f1<-dnorm(x,0,1)
f2<-dnorm(x,4,1)
d<-data.frame(x,f1,f2)
ggplot(d) + geom_line(aes(x = x, y = f1), color = "red")+geom_line(aes(x = x, y = f2), color = "blue") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
set.seed(212)
n<-100
Y<-rep(c("0","1"), c(3*n/4, n/4))
X<-c(rnorm(3*n/4, 1, 1), rnorm(n/4, 3, 1) )
d<-data.frame(X,Y)
mu0<-d %>% filter(Y == 0) %>% summarise(mu = mean(X) ) %>% pull()
mu1<-d %>% filter(Y == 1) %>% summarise(mu = mean(X) ) %>% pull()
ssx <- d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1), n()) %>% pull(2,)
sigma2 <- sum(ssx)/(n - 2)
density0 <- function(x){dnorm(x, mean = mu0, sd = sqrt(sigma2))}
density1 <- function(x){dnorm(x, mean = mu1, sd = sqrt(sigma2))}
pi0 <- sum(d$Y =="0")/n
pi1 <- sum(d$Y =="1")/n
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
d %>% group_by(Y) %>% summarize(pi = n()/n, mu = mean(X))
d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1)) %>%
summarize(sigma_sq = sum(ssx)/(n-2))
c<- (mu0 + mu1)/2 + (sigma2*log(pi0) - log(pi1))/(mu1-mu0)
c
discriminant <- function(x, pi, mu, sigma2) {
x * (mu/sigma2) - (mu^2)/(2 * sigma2) + log(pi)
}
d0 <- discriminant(d$X, pi0, mu0, sigma2)
d1 <- discriminant(d$X, pi1, mu1, sigma2)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "blue")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")+geom_vline(xintercept = c , color = "purple", linetype = "dashed")
ggplot(d) + geom_line(aes(x = x, y = f1), color = "salmon")+geom_line(aes(x = x, y = f2), color = "blue") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
x<-seq(from = -3, to = 7, by = .1)
f1<-dnorm(x,0,1)
f2<-dnorm(x,4,1)
d<-data.frame(x,f1,f2)
ggplot(d) + geom_line(aes(x = x, y = f1), color = "salmon")+geom_line(aes(x = x, y = f2), color = "blue") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
ggplot(d) + geom_line(aes(x = x, y = f1), color = "salmon")+geom_line(aes(x = x, y = f2), color = "teal") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
ggplot(d) + geom_line(aes(x = x, y = f1), color = "salmon")+geom_line(aes(x = x, y = f2), color = "cyan4") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
ggplot(d) + geom_line(aes(x = x, y = f1), color = "salmon")+geom_line(aes(x = x, y = f2), color = "darkturquoise") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon")+
geom_line(aes(x = X, y = d1), color = "darkturquoise")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon", size = 1)+
geom_line(aes(x = X, y = d1), color = "darkturquoise")+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon", size = 1)+
geom_line(aes(x = X, y = d1), color = "darkturquoise", size= 1)+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon", size = 1)+
geom_line(aes(x = X, y = d1), color = "darkturquoise", size= 1)+
geom_vline(xintercept = c , color = "purple", linetype = "dashed", size= 1)+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
discriminant_data <- data.frame(d, d0,d1, y = 0)
discriminant_data <- data.frame(d, d0,d1, y = 0)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
x<-seq(from = -3, to = 7, by = .1)
f1<-dnorm(x,0,1)
f2<-dnorm(x,4,1)
d<-data.frame(x,f1,f2)
ggplot(d) + geom_line(aes(x = x, y = f1), color = "salmon")+geom_line(aes(x = x, y = f2), color = "darkturquoise") +theme_bw()+scale_x_continuous(breaks = c(-2, 0, 2, 4, 6)) +annotate(geom ="text", x = -2, y = .25, label = "X|Y = 0")+annotate(geom ="text", x = 6, y = .25, label = "X|Y = 1") + annotate(geom = "point", x = 2, y = 0, color = "purple") + geom_vline(xintercept = 2, color = "purple", linetype = "dashed")+labs(y = "density")
set.seed(212)
n<-100
Y<-rep(c("0","1"), c(3*n/4, n/4))
X<-c(rnorm(3*n/4, 1, 1), rnorm(n/4, 3, 1) )
d<-data.frame(X,Y)
mu0<-d %>% filter(Y == 0) %>% summarise(mu = mean(X) ) %>% pull()
mu1<-d %>% filter(Y == 1) %>% summarise(mu = mean(X) ) %>% pull()
ssx <- d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1), n()) %>% pull(2,)
sigma2 <- sum(ssx)/(n - 2)
density0 <- function(x){dnorm(x, mean = mu0, sd = sqrt(sigma2))}
density1 <- function(x){dnorm(x, mean = mu1, sd = sqrt(sigma2))}
pi0 <- sum(d$Y =="0")/n
pi1 <- sum(d$Y =="1")/n
d %>% mutate(y = 0) %>%
ggplot(aes(x = X, color = Y) )+geom_jitter(aes(x= X, color = Y,y = y), alpha = .55, size = 2, height = .01)+geom_function(fun = density0, color = "salmon")+geom_function(fun = density1)+theme_bw()+labs(y = "density")
d %>% group_by(Y) %>% summarize(pi = n()/n, mu = mean(X))
d %>% group_by(Y) %>% summarize(ssx = var(X) * (n() - 1)) %>%
summarize(sigma_sq = sum(ssx)/(n-2))
c<- (mu0 + mu1)/2 + (sigma2*log(pi0) - log(pi1))/(mu1-mu0)
c
discriminant <- function(x, pi, mu, sigma2) {
x * (mu/sigma2) - (mu^2)/(2 * sigma2) + log(pi)
}
d0 <- discriminant(d$X, pi0, mu0, sigma2)
d1 <- discriminant(d$X, pi1, mu1, sigma2)
discriminant_data <- data.frame(d, d0,d1, y = 0)
ggplot(discriminant_data) +
geom_jitter(aes(x = X, y = 0, color = Y), height = .15,alpha = .55, size = 2)+
geom_line(aes(x = X, y = d0), color = "salmon", size = 1)+
geom_line(aes(x = X, y = d1), color = "darkturquoise", size= 1)+
geom_vline(xintercept = c , color = "purple", linetype = "dashed")+
theme_bw()+ylim(-1,NA)+
labs(x = "X", y = "discriminant")+
annotate(geom = "text", x = 3, y = 6, label = "c = 2.48", color = "purple", size = 3)
