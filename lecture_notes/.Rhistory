t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.03*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.03, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
beta_1s <- coef_mat[, 2]
hist(beta_1s, breaks = 20,
main = expression(paste("Sampling distribution of ", hat(beta)[1])),
xlab = expression(hat(beta)[1]), prob = TRUE)
abline(v = beta_1, col = "orange", lwd = 2)
text(beta_1+.02, .5, expression(beta[1]))
xl <- seq(min(beta_1s), max(beta_1s), length.out = 100)
lines(xl, dnorm(xl, mean = beta_1, sd = sqrt(sigma^2/sum((x-mean(x))^2))),
lwd = 2, col = "thistle3")
ggplot(many_mods, aes(x = slope))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.03*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
t <- seq(from = .4, to = 1, length.out = 100)
z <- 1000*.04*dnorm(t, mean =beta_1 , sd = sqrt(sigma^2/sum((x-mean(x))^2)))
my_norm<-data.frame(t,z)
ggplot(many_mods, aes(x = slope ))+geom_histogram(binwidth = 0.04, fill = "steelblue", color ="white")+theme_bw()+
geom_vline(xintercept = 0.7, color = "goldenrod", size = 2)+
geom_line(data = my_norm, aes(x = t, y = z), size = 1)+
labs(x = expression(hat(beta)[1]),
title =expression(paste("Sampling distribution of ", hat(beta)[1])))
knitr::opts_chunk$set(echo = FALSE,
fig.align = "center",
message = F,
warning = F,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
## Constructing a CI for $\hat{\beta}_1$
\[ \hat{\beta}_1 \pm t_{\alpha/2, n-2} \cdot SE(\hat{\beta}_1) \]
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = TRUE,
fig.width = 6,
fig.height = 4
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(gglm)
install.packages("gglm")
library(gglm)
?gglm
gglm(my_mod)
my_mod<-lm(Y ~ X, data = my_data)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = TRUE,
fig.width = 6,
fig.height = 4
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
set.seed(254)
X<-runif(20, 1, 4)
Y<-X + rnorm(20,0,0.2)
dd<-tibble(X,Y)
ggplot(dd )+
geom_point( aes(x = X, y =Y))+
geom_point( aes( x = 0, y = Y), color = "darkgrey")+
geom_point( aes( x = X, y = 0),color = "darkgrey")+
annotate(geom = "text", x = 1, y = 3, label = "R = 0.97")+
annotate(geom = "text", x = 1, y = 2.5, label = "R^2 = 0.94")
set.seed(254)
X<-runif(20, 1, 4)
Y<- X/10+rnorm(20,0,1)
dd<-tibble(X,Y)
ggplot(dd )+
geom_point( aes(x = X, y =Y))+
geom_point( aes( x = 0, y = Y), color = "darkgrey")+
geom_point( aes( x = X, y = 0),color = "darkgrey")+
annotate(geom = "text", x = 1, y = 3, label = "R = 0.27")+
annotate(geom = "text", x = 1, y = 2.5, label = "R^2 = 0.07")
mod_credit<-lm(Balance ~ Income + Limit , data = Credit)
summary(mod_credit)
X = seq(0,8, by = .1)
Y= df(X, 4, 20)
data.frame(X,Y) %>%
ggplot(aes(x= X, y = Y))+
geom_line()+
labs(title = "Density for 4 predictors, 25 observations", x = "F")
include_graphics("img/3dplot_plane.png")
set.seed(1)
x_nl<-runif(50, 0, 1)
y_nl<- 1  +.5*x_nl-x_nl^2 + rnorm(50, 0,.03)
df_nl<-data.frame(x_nl, y_nl)
ggplot(df_nl, aes(x = x_nl, y = y_nl))+geom_point()+geom_smooth(method ="lm", se = F)+labs(x = "X", y = "Y")
set.seed(1)
x_cor<-seq(0,1, length.out = 50)
y_cor<-  sin(x_cor*20)+rnorm(50, 0, .55)
df_cor<-data.frame(x_cor, y_cor)
ggplot(df_cor, aes(x = x_cor, y = y_cor))+geom_point()+labs(x = "X", y = "Residual")+geom_abline(intercept = 0, slope = 0)
set.seed(3)
x_var<-seq(0, 1, length.out = 50)
sd<-seq(from = .01, to = .4, length.out = 50)
y_var<- x_var + rnorm(50, 0, sd )
df_var<-data.frame(x_var, y_var)
ggplot(df_var, aes(x = x_var, y = y_var))+geom_point()+labs(x = "X", y = "Y")+geom_smooth(method ="lm", se = F)
set.seed(3)
x_out<-seq(0, 1, length.out = 50)
y_out<- x_out + rnorm(50, 0, .1 )
df_out<-data.frame(x_out = c(x_out, .5), y_out = c(y_out,1.1))
ggplot(df_out, aes(x = x_out, y = y_out))+geom_point()+labs(x = "X", y = "Y")+geom_smooth(method ="lm", se = F)
set.seed(3)
x_out<-seq(0, 1, length.out = 50)
y_out<- x_out + rnorm(50, 0, .1 )
df_out<-data.frame(x_out = c(x_out, 0), y_out = c(y_out,1.1))
df_out1<-data.frame(x_out, y_out)
ggplot(df_out, aes(x = x_out, y = y_out))+geom_point()+labs(x = "X", y = "Y")+geom_smooth(method ="lm", se = F) + geom_smooth(data = df_out1, aes(x = x_out, y=y_out), method = "lm", se = F, color = "red")
set.seed(3)
x_1<-seq(0, 1, length.out = 50)
x_2<- x_1+rnorm(50,0, .1)
y_12<- x_1+x_2
df_coll<-data.frame(x_1, x_2, y_12)
ggplot(df_coll, aes(x = x_1, y = x_2))+geom_point()+labs(x = "X1", y = "X2")+geom_smooth(method ="lm", se = F)
set.seed(700)
X <- runif(80, 0, 1)
e <- rnorm(80, 0, .25)
Y <- 1 + 2*X + e
my_data <- data.frame(X,Y)
ggplot(my_data, aes(x = X , y = Y)) + geom_point()
my_mod<-lm(Y ~ X, data = my_data)
beta_0 <- summary(my_mod)$coefficients[1]
beta_1 <- summary(my_mod)$coefficients[2]
c(beta_0, beta_1)
gglm(my_mod)
gglm(my_mod) %>% pull()
library(gglm)
ggplot(data = model) +stat_fitted_resid()
ggplot(data = my_mod) +stat_fitted_resid()
ggplot(data = my_mod) +stat_normal_qq()
ggplot(data = my_mod) +scale_location()
ggplot(data = my_mod) +stat_scale_location()
ggplot(data = my_mod) +stat_resid_leverage()
ggplot(data = my_mod) +stat_resid_leverage()
gglm(my_mod)
library(AppliedPredictiveModeling)
?FuelEconomy
fueleconomy
data(FuelEconomy)
View(cars2010)
?cars2010
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
warning = FALSE,
cache = TRUE,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(MASS)
include_graphics("img/fueleconomy.png")
include_graphics("img/fueleconomy.png")
include_graphics("img/fueleconomy.jpg")
include_graphics("img/fueleconomy.jpg")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = T,
fig.width = 6,
fig.height = 4,
warning = FALSE
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(moderndive)
include_graphics("img/fueleconomy.jpg")
include_graphics("img/fueleconomy.pmg")
include_graphics("img/fueleconomy.png")
data(cars2010)
head(cars2010)
data(FuelEconomy)
library(GGally)
cars2010 %>% select_if(is.numeric) %>% ggpairs()
cars2010 %>% select_if(is.numeric) %>% cor()
cars2010 %>% select_if(is.numeric) %>% cor()[FE]
cars2010 %>% select_if(is.numeric) %>% cor()["FE",]
cars2010 %>% select_if(is.numeric) %>% cor()[,"FE"]
cars2010 %>% select_if(is.numeric) %>% cor()[,FE
library(GGally)
cars2010 %>% select_if(is.numeric) %>% cor()[,FE]
1
cars2010 %>% select_if(is.numeric) %>% cor()[FE,FE]
cars2010 %>% select_if(is.numeric) %>% cor()[FE,1]
cars2010 %>% select_if(is.numeric) %>% cor()
ttt <- cars2010 %>% select_if(is.numeric) %>% cor()
View(ttt)
cars2010 %>% select_if(is.numeric) %>% cor()[FE]
cars2010 %>% select_if(is.numeric) %>% cor()["FE"]
cars2010 %>% select_if(is.numeric) %>% cor(, cars20210$FE)
cars2010 %>% select_if(is.numeric) %>% cor(, cars2010$FE)
library(GGally)
cars2010 %>% select_if(is.numeric) %>% cor(, cars2010$FE)
cars2010 %>% select_if(is.numeric) %>% cor( cars2010$FE)
cars2010 %>% select_if(!is.numeric)
cars2010 %>% select_if(is.factor)
cars2010 %>% select_if(is.factor) %>% cor()
cars2010 %>% select_if(is.factor) %>% ggpairs()
cars2010 %>% select_if(is.factor) %>% select(-Transmission) %>% ggpairs()
cars2010 %>% select_if(is.factor) %>% select(-Transmission)
cars2010 %>% select_if(is.factor) %>% names()
cars2010 %>% select_if(is.factor) %>% select(-Transmission)
cars2010 %>% select_if(is.factor) %>% select(Transmission)
cars2010 %>% select_if(is.factor) %>% dplyr::select(Transmission)
cars2010 %>% select_if(is.factor) %>% dplyr::select(-Transmission)
cars2010 %>% select_if(is.factor) %>% dplyr::select(-Transmission) %>% ggpairs()
attach(cars2010)
cor(EngDispl, NumCyl)
plot(NumCyl, EngDispl)
\footnotesize
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)
g1
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
library(gridExtra)
grid.arrange(g1,g2, ncol = 1)
library(gridExtra)
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
grid.arrange(g1,g2, ncol = 1)
library(gridExtra)
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
g2 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
grid.arrange(g1,g2, ncol = 1)
g2 <- ggplot(cars2010, aes(x = NumCyl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
library(gridExtra)
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
g2 <- ggplot(cars2010, aes(x = NumCyl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
grid.arrange(g1,g2, ncol = 1)
library(gridExtra)
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
g2 <- ggplot(cars2010, aes(x = NumCyl, y = FE))+geom_point(alpha = .25) + geom_smooth(method = "lm", se = F)+theme_bw()
grid.arrange(g1,g2, ncol = 1)
cars2010 %>% ggplot(aes(x = NumCyl, y = EngDispl))+geom_point(alpha = .25)+geom_smooth(method = "lm", se = F)+theme_bw()
cor(cars2010$EngDispl, cars2010$NumCyl)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = T,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(moderndive)
```{r fig.height = 3, fig.width = 5}
cars2010 %>% ggplot(aes(x = NumCyl, y = EngDispl))+geom_point(alpha = .25)+geom_smooth(method = "lm", se = F)+theme_bw()
library(gridExtra)
g1 <- ggplot(cars2010, aes(x = EngDispl, y = FE))+geom_point(alpha = .5) + geom_smooth(method = "lm", se = F)+theme_bw()
g2 <- ggplot(cars2010, aes(x = NumCyl, y = FE))+geom_point(alpha = .25) + geom_smooth(method = "lm", se = F)+theme_bw()
grid.arrange(g1,g2, ncol = 1)
?predict
mod <- lm(FE ~ EngDispl, data = cars2010)
predict(mod, cars2011)
t<- predict(mod, cars2011 )
predict(mod, cars2011, se.fit = T )
?mse
?modelr
mod1 <- lm(FE ~ EngDispl + NumCyl, data = cars2010)
mod1 <- lm(FE ~ EngDispl, data = cars2010)
summary(mod1)
summary(mod2)
mod2 <- lm(FE ~ EngDispl + NumCyl, data = cars2010)
mod1 <- lm(FE ~ EngDispl, data = cars2010)
summary(mod1)
summary(mod2)
mod1_preds <- predict(mod1, cars2011)
mean( (cars2011$FE - mod1_preds)^2)
mean( (cars2011$FE - mod2_preds)^2)
mod2_preds <- predict(mod2, cars2011)
mean( (cars2011$FE - mod2_preds)^2)
mod1_preds <- predict(mod1, cars2011)
mean( (cars2012$FE - mod1_preds)^2)
mod2_preds <- predict(mod2, cars2011)
mean( (cars2012$FE - mod2_preds)^2)
mod1_preds <- predict(mod1, cars2011)
mean( (cars2011$FE - mod1_preds)^2)
mod2_preds <- predict(mod2, cars2011)
mean( (cars2011$FE - mod2_preds)^2)
cars_initial <- intial_split(cars2010)
library(rsample)
cars_initial <- intial_split(cars2010)
library(rsample)
cars_initial <- intial_split(cars2010)
cars_initial <- initial_split(cars2010)
cars_train <- training(cars_initial)
cars_val <- testing(cars_initial)
library(rsample)
cars_initial <- initial_split(cars2010)
cars_train <- training(cars_initial)
cars_val <- testing(cars_initial)
cars_val %>% dim()
library(rsample)
cars_initial <- initial_split(cars2010)
cars_train <- training(cars_initial)
cars_val <- testing(cars_initial)
cars_train %>% dim()
cars_val %>% dim()
set.seed(927)
cars_initial <- initial_split(cars2010)
cars_train <- training(cars_initial)
cars_val <- testing(cars_initial)
cars_train %>% dim()
cars_val %>% dim()
mod1 <- lm(FE ~ EngDispl, data = cars_train)
summary(mod1)
mod2 <- lm(FE ~ EngDispl + NumCyl, data = cars_train)
summary(mod2)
set.seed(999)
cars_initial <- initial_split(cars2010)
cars_train <- training(cars_initial)
cars_val <- testing(cars_initial)
cars_train %>% dim()
cars_val %>% dim()
mod1 <- lm(FE ~ EngDispl, data = cars_train)
summary(mod1)
mod2 <- lm(FE ~ EngDispl + NumCyl, data = cars_train)
summary(mod2)
mod1_preds <- predict(mod1, cars_val)
mod1_mse <- mean( (cars2011$FE - mod1_preds)^2)
mod1_mse
mod2_preds <- predict(mod2, cars_val)
mod2_mse <- mean( (cars2011$FE - mod2_preds)^2)
mod2_mse
mod1_preds <- predict(mod1, cars_val)
mod1_mse <- mean( (cars2011$FE - mod1_preds)^2)
mod1_mse
mod2_preds <- predict(mod2, cars_val)
mod2_mse <- mean( (cars2011$FE - mod2_preds)^2)
mod2_mse
mod1 <- lm(FE ~ EngDispl, data = cars_train)
summary(mod1)
mod1_mse <- sqrt( mean( (cars2011$FE - mod1_preds)^2) )
mod1_mse
mod1_mse <- mean( (cars2011$FE - mod1_preds)^2)
mod1_mse
mod2_mse <- mean( (cars2011$FE - mod2_preds)^2)
mod2_mse
?cfold_cv
?vvfold_cv
library(rsample)
>vfold_cv
?vfold_cv
resample_cars <- cfold_cv(cars2010, v = 10)
resample_cars <- vfold_cv(cars2010, v = 10)
View(resample_cars)
View(resample_cars[[1]][[1]])
folds_cars
folds_cars <- vfold_cv(cars2010, v = 10)
folds_cars
dim(folds_cars)
folds_cars <- vfold_cv(cars2010, v = 10)
include_graphics("three-CV-iter.svg")
include_graphics("img/three-CV-iter.svg")
include_graphics("img/three-CV.svg")
include_graphics("img/three-CV.svg")
include_graphics("img/three-CV.pdf")
include_graphics("img/three-CV.pdf")
include_graphics("img/three-CV-iter.pdf")
include_graphics("img/three-CV-iter.png")
include_graphics("img/three-CV-iter.png")
include_graphics("img/three-CV-iter.png")
include_graphics("img/three-CV.png")
include_graphics("img/three-CV.png")
include_graphics("img/three-CV.png")
include_graphics("img/three-CV.png")
include_graphics("img/three-CV.png")
include_graphics("img/three-CV-iter.png")
include_graphics("img/three-CV-iter.png")
include_graphics("img/three_CV.png")
include_graphics("img/three_CV_iter.png")
include_graphics("img/three_CV_iter.png")
include_graphics("img/three_CV.png")
include_graphics("img/three_CV.png")
folds_cars$splits
?vfold_cv
folds_cars$id
folds_cars$splits[[1]]
analysis(folds_cars$splits[[1]])
analysis(folds_cars$splits[[1]] %>% head()
analysis(folds_cars$splits[[1]] %>% head()
analysis(folds_cars$splits[[1]] %>% head()
analysis(folds_cars$splits[[1]] %>% head()
analysis(folds_cars$splits[[1]]) %>% head()
library(tidymodels)
?fit_resamples
build_model1 <- function(split){
mod <- lm(FE ~ EngDispl, data = analysis(split))
}
build_model1 <- function(split){
mod <- lm(FE ~ EngDispl, data = analysis(split))
val <- assessment(split)
preds <- predict(mod, val)
mse <- mean( (val$FE - preds)^2)
}
cv_model1 <- function(split){
mod <- lm(FE ~ EngDispl, data = analysis(split))
val <- assessment(split)
preds <- predict(mod, val)
mse <- mean( (val$FE - preds)^2)
}
cv_model1(folds_cars$splits[[1]])
mse
cv_model1 <- function(split){
mod <- lm(FE ~ EngDispl, data = analysis(split))
val <- assessment(split)
preds <- predict(mod, val)
mse <- mean( (val$FE - preds)^2)
mse
}
cv_model1(folds_cars$splits[[1]])
folds_cars$results <- map(folds_cars$splits, cv_model1)
folds_cars
mean(folds_cars$results)
folds_cars$accuracy <- map_dbl(folds_car$results, function(x) x)
folds_cars$accuracy <- map_dbl(folds_cars$results, function(x) x)
folds_cars
summary(folds_cars)
summary(folds_cars$results)
summary(folds_cars$accuracy)
?map_dbl
folds_cars$results <- map_dbl(folds_cars$splits, cv_model1)
folds_cars
folds_cars <- vfold_cv(cars2010, v = 10)
folds_cars$splits[[1]] %>% analysis()
folds_cars$splits[[1]] %>% assessment()
cv_model1 <- function(split){
mod <- lm(FE ~ EngDispl, data = analysis(split))
val <- assessment(split)
preds <- predict(mod, val)
mse <- mean( (val$FE - preds)^2)
mse
}
library(purrr)
folds_cars$results <- map_dbl(folds_cars$splits, cv_model1)
folds_cars
mean(folds_cars$results)
library(purrr)
folds_cars$mod1_results <- map_dbl(folds_cars$splits, cv_model1)
folds_cars
folds_cars <- vfold_cv(cars2010, v = 10)
folds_cars <- vfold_cv(cars2010, v = 10)
library(purrr)
folds_cars$mod1_results <- map_dbl(folds_cars$splits, cv_model1)
folds_cars
CV_MSE_mod1 <- mean(folds_cars$mod1_results)
CV_MSE_mod1 <- mean(folds_cars$mod1_results)
CV_MSE_mod1
cv_model2 <- function(split){
mod <- lm(FE ~ EngDispl + NumCyl, data = analysis(split))
val <- assessment(split)
preds <- predict(mod, val)
mse <- mean( (val$FE - preds)^2)
mse
}
cv_model2 <- function(split){
mod <- lm(FE ~ EngDispl + NumCyl, data = analysis(split))
val <- assessment(split)
preds <- predict(mod, val)
mse <- mean( (val$FE - preds)^2)
mse
}
folds_cars$mod2_results <- map_dbl(folds_cars$splits, cv_model2)
CV_MSE_mod2 <- mean(folds_cars$mod2_results)
CV_MSE_mod2
data.frame(model = c("1", "2"), cv_mse = c(CV_MSE_mod1, CV_MSE_mod2))
