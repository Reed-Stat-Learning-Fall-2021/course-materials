rMSE %>% mutate(bootstrap = 1:20) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse)) +geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")
rMSE %>% mutate(bootstrap = 1:20) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse)) +geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")
?stat_summary
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
stat_summary(fun = "mean", geom = "bar")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
stat_summary(fun = "mean", geom = "point")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
stat_summary(fun = "mean", geom = "point", color = "red")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
stat_summary(fun = "mean", geom = "point", color = "red", size = 1)
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
theme_bw()
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +geom_point()+coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data", legend = NULL)+
theme_bw()+
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data", legend = NULL)+
theme_bw()+
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data" )+
theme_bw()+
theme(legend. position = "none")
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data" )+
theme_bw()+
theme(legend. position = "none")
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data" )+
theme_bw()+
theme(legend.position = "none")
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
rMSE <- data.frame()
for(i in 1:20){
boot <- house_test %>% sample_n(597)
results <- construct_results(training_data,
boot)
get_rmse <- function(preds){
sqrt(
mean(
(preds - boot$Sale_Price)^2
)
)
}
rMSE <- rbind(rMSE, results %>%
summarize(
across(.cols = everything(), get_rmse)
))
}
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
rMSE <- data.frame()
for(i in 1:20){
boot <- house_test %>% sample_n(size=597, replace = T)
results <- construct_results(training_data,
boot)
get_rmse <- function(preds){
sqrt(
mean(
(preds - boot$Sale_Price)^2
)
)
}
rMSE <- rbind(rMSE, results %>%
summarize(
across(.cols = everything(), get_rmse)
))
}
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
Full_Model_processing <- function(my_data){
my_data
}
Full_Model_model <- function(training_data){
library(tidyverse)     ## Load whatever packages you need
my_mod <- lm(Sale_Price ~ .,
data = training_data)
my_mod
}
Full_Model_predictions <- function(model, test_data){
library(tidyverse)     ## Load whatever packages you need
my_preds <- predict(model, test_data)   ## Make predictions based on your model. Don't change this line.
my_preds<- my_preds*1
my_preds
}
library(tidyverse)
training_data <- read_csv("house_train.csv")
#Vector of student names to iterate over
names <- c("Ananke_Krishnan",
"Bhavjot_Khurana",
"Calvin_BeemanWeber",
"Emma_Thoron",
"Gillian_McGinnis",
"Isabelle_Caldwell",
"Jakob_Shimer",
"Jon_deVries",
"Rishi_Krishnamurthy",
"Robin_H",
"Rohan_Buggana",
"simon_ahn",
"SkyPeterson",
"Tina_Qin",
"Maxwell_VanLandschoot",
"Taylor_Blair",
"Full_Model"
)
#Call the processing data function, model construction function, and predictions function associated with a given name,
#model built on input training data, model tested on input test data
evaluate_model <- function(name, training_data, test_data){
processed_training_data <- do.call(paste(name, "processing", sep = "_"),
list(training_data))
processed_test_data <- do.call(paste(name, "processing", sep = "_"),
list(test_data))
mod <- do.call(paste(name, "model", sep = "_"),
list(processed_training_data))
predictions <- do.call(paste(name, "predictions", sep = "_"),
list(mod, processed_test_data))
return(predictions)
}
#called evaluate model function on each name, builds data frame of predictions for each student's model
#column of df is a student's model, rows are individual predictions
construct_results <- function(training_data, test_data){
results <- sapply(names, function(x){evaluate_model(x,
training_data,
test_data) }) %>% as.data.frame()
}
#Test of construct_results function
results_example <- construct_results(training_data,
sample_n(training_data, size = 200))
house_test <- read_csv("house_test.csv")
results <- construct_results(training_data,
house_test)
get_rmse <- function(preds){
sqrt(
mean(
(preds - house_test$Sale_Price)^2
)
)
}
results %>%
summarize(
across(.cols = everything(), get_rmse)
)
rMSE <- data.frame()
for(i in 1:20){
boot <- house_test %>% sample_n(size=597, replace = T)
results <- construct_results(training_data,
boot)
get_rmse <- function(preds){
sqrt(
mean(
(preds - boot$Sale_Price)^2
)
)
}
rMSE <- rbind(rMSE, results %>%
summarize(
across(.cols = everything(), get_rmse)
))
}
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
house<-read_csv("data/house_train.csv")
glimpse(house)
include_graphics("img/house_rmse.png")
include_graphics("img/house_rmse.png")
include_graphics("img/house_rmse_color.png")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% summarize(median(rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% summarize(min(rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names)
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(rmse = mean(rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(rmse = mean(rmse)) %>% arrange(desc(rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(rmse = mean(rmse), sd_rmse(rmse)) %>% arrange(desc(sd_rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(rmse = mean(rmse), sd_rmse= sd(rmse)) %>% arrange(desc(sd_rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(mean_rmse = mean(rmse), sd_rmse= sd(rmse)) %>% arrange(desc(sd_rmse))
Simple_Model_processing <- function(my_data){
my_data
}
Simple_Model_model <- function(training_data){
library(tidyverse)     ## Load whatever packages you need
my_mod <- lm(Sale_Price ~ Gr_Liv_Area,
data = training_data)
my_mod
}
Simple_Model_predictions <- function(model, test_data){
library(tidyverse)     ## Load whatever packages you need
my_preds <- predict(model, test_data)   ## Make predictions based on your model. Don't change this line.
my_preds<- my_preds*1
my_preds
}
library(tidyverse)
training_data <- read_csv("house_train.csv")
#Vector of student names to iterate over
names <- c("Ananke_Krishnan",
"Bhavjot_Khurana",
"Calvin_BeemanWeber",
"Emma_Thoron",
"Gillian_McGinnis",
"Isabelle_Caldwell",
"Jakob_Shimer",
"Jon_deVries",
"Rishi_Krishnamurthy",
"Robin_H",
"Rohan_Buggana",
"simon_ahn",
"SkyPeterson",
"Tina_Qin",
"Maxwell_VanLandschoot",
"Taylor_Blair",
"Full_Model",
"Simple_Model"
)
#Call the processing data function, model construction function, and predictions function associated with a given name,
#model built on input training data, model tested on input test data
evaluate_model <- function(name, training_data, test_data){
processed_training_data <- do.call(paste(name, "processing", sep = "_"),
list(training_data))
processed_test_data <- do.call(paste(name, "processing", sep = "_"),
list(test_data))
mod <- do.call(paste(name, "model", sep = "_"),
list(processed_training_data))
predictions <- do.call(paste(name, "predictions", sep = "_"),
list(mod, processed_test_data))
return(predictions)
}
#called evaluate model function on each name, builds data frame of predictions for each student's model
#column of df is a student's model, rows are individual predictions
construct_results <- function(training_data, test_data){
results <- sapply(names, function(x){evaluate_model(x,
training_data,
test_data) }) %>% as.data.frame()
}
#Test of construct_results function
results_example <- construct_results(training_data,
sample_n(training_data, size = 200))
house_test <- read_csv("house_test.csv")
results <- construct_results(training_data,
house_test)
get_rmse <- function(preds){
sqrt(
mean(
(preds - house_test$Sale_Price)^2
)
)
}
results %>%
summarize(
across(.cols = everything(), get_rmse)
)
rMSE <- data.frame()
for(i in 1:20){
boot <- house_test %>% sample_n(size=597, replace = T)
results <- construct_results(training_data,
boot)
get_rmse <- function(preds){
sqrt(
mean(
(preds - boot$Sale_Price)^2
)
)
}
rMSE <- rbind(rMSE, results %>%
summarize(
across(.cols = everything(), get_rmse)
))
}
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>%
ggplot(aes(x = names, y = rmse)) +
geom_point()+
stat_summary(fun = "mean", geom = "point", color = "red", size = 2)+
coord_flip()+labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Red dot indicates mean rMSE")+
theme_bw()
rMSE %>% mutate(bootstrap = as.factor(1:20)) %>% pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% ggplot(aes(x = names, y = rmse, color = bootstrap)) +
geom_point()+
coord_flip()+
labs(title = "Model rMSE, Based on 20 Bootstraps from Test Data",
caption = "Colors indicate distinct bootstrap samples")+
theme_bw()+
theme(legend.position = "none")
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(mean_rmse = mean(rmse), sd_rmse= sd(rmse)) %>% arrange(desc(sd_rmse))
rMSE %>%
mutate(bootstrap = as.factor(1:20)) %>%
pivot_longer(!bootstrap, names_to = "names", values_to = "rmse") %>% group_by(names) %>% summarize(mean_rmse = mean(rmse), sd_rmse= sd(rmse)) %>% arrange(desc(mean_rmse))
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY)
solTest <- solTest %>% select(!starts_with("FP"))
solTrain <- solTrain %>% select(!starts_with("FP"))
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY)
solTest <- solTest %>% select(!starts_with("FP"))
solTrain <- solTrain %>% select(!starts_with("FP"))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY)
solTest <- solTest %>% select(!starts_with("FP"))
solTrain <- solTrain %>% select(!starts_with("FP"))
cor(SolTrain,Solubility)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY)
solTest <- solTest %>% select(!starts_with("FP"))
solTrain <- solTrain %>% select(!starts_with("FP"))
cor(SolTrain,Solubility)
cor(SolTrain,solTrain$Solubility)
cor(solTrain,solTrain$Solubility)
cor(solTrain,solTrain$Solubility) %>% sort()
cor(solTrain,solTrain$Solubility) %>% data.frame()
cor(solTrain,solTrain$Solubility) %>% data.frame() %>% arrange(.)
small_mod <- lm(Solubility ~ MolWeight + NumCarbon + NumBonds, data = solTrain)
small_mod <- lm(Solubility ~ MolWeight + NumCarbon + NumBonds, data = solTrain)
summary(small_mod)
small_mod <- lm(Solubility ~ MolWeight + NumCarbon, data = solTrain)
summary(small_mod)
include_graphics("img/xkcd1.png")
?include_graphics
