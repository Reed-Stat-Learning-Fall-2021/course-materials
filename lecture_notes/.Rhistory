echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
library(randomForest)
library(pdxTrees)
my_pdxTrees <- get_pdxTrees_parks(park = c("Berkeley Park", "Woodstock Park", "Westmoreland Park", "Mt Scott Park", "Powell Park", "Kennilworth Park", "Sellwood Park", "Crystal Springs Rhododendron Garden", "Laurelhurst Park"))%>%  mutate_if(is.character, as.factor) %>%  dplyr::select(DBH, Condition, Tree_Height, Crown_Width_NS, Crown_Width_EW, Crown_Base_Height, Functional_Type, Mature_Size, Carbon_Sequestration_lb) %>% drop_na()
names(my_pdxTrees)
dim(my_pdxTrees)
set.seed(1)
library(rsample)
my_pdxTrees_split <- initial_split(my_pdxTrees )
my_pdxTrees_train <- training(my_pdxTrees_split)
my_pdxTrees_test <- testing(my_pdxTrees_split)
library(randomForest)
rfmodel <- randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train)
rfmodel
set.seed(1)
rfmodel2 <- randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train,
ntree = 10, mtry = 5)
rfmodel2
my_preds<- predict(rfmodel, my_pdxTrees_test)
results <- data.frame(obs =  my_pdxTrees_test$Carbon_Sequestration_lb, preds = my_preds)
results %>% head()
my_preds<- predict(rfmodel, my_pdxTrees_test)
results <- data.frame(obs =  my_pdxTrees_test$Carbon_Sequestration_lb, preds = my_preds)
results %>% head()
?predict.randomForest
importance(rfmodel)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
varImpPlot(rfmodel)
?varImpPlot
?importance
?importance
library(randomForest)
?mean
library(randomForest)
?varImpPlot
rfmodel$importance
library(broom)
tidy(rfmodel)
tidy(rfmodel$importance)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
library(randomForest)
set.seed(11)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
library(yardstick)
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
library(randomForest)
include_graphics("img/wwtbm.jpeg")
include_graphics("img/lifelines.jpeg")
include_graphics("img/lifelines.jpeg")
library(pdxTrees)
my_pdxTrees <- get_pdxTrees_parks(park = c("Berkeley Park", "Woodstock Park", "Westmoreland Park", "Mt Scott Park", "Powell Park", "Kennilworth Park", "Sellwood Park", "Crystal Springs Rhododendron Garden", "Laurelhurst Park"))%>%  mutate_if(is.character, as.factor) %>%  dplyr::select(DBH, Condition, Tree_Height, Crown_Width_NS, Crown_Width_EW, Crown_Base_Height, Functional_Type, Mature_Size, Carbon_Sequestration_lb) %>% drop_na()
names(my_pdxTrees)
dim(my_pdxTrees)
set.seed(1)
library(rsample)
my_pdxTrees_split <- initial_split(my_pdxTrees )
my_pdxTrees_train <- training(my_pdxTrees_split)
my_pdxTrees_test <- testing(my_pdxTrees_split)
library(rsample)
set.seed(1115)
pdx_bootstrap <- bootstraps(my_pdxTrees_train, times = 4)
library(rpart)
get_tree <- function(split){
bootstrap_sample <- analysis(split)
model <- rpart(Carbon_Sequestration_lb ~., data = bootstrap_sample)
}
pdx_bootstrap$model <- map(pdx_bootstrap$splits, get_tree)
par(mfcol = c(2, 2), mar = c(1, 1, 1, 1))
library(rpart.plot)
rpart.plot(pdx_bootstrap$model[[1]], box.palette = "Greens")
rpart.plot(pdx_bootstrap$model[[2]], box.palette = "Greens")
rpart.plot(pdx_bootstrap$model[[3]], box.palette = "Greens")
rpart.plot(pdx_bootstrap$model[[4]], box.palette = "Greens")
get_predictions <- function(model){
predictions <- predict(model, my_pdxTrees_test)
tibble(obs = my_pdxTrees_test$Carbon_Sequestration_lb, preds = predictions)
}
pdx_bootstrap$predictions <- map(pdx_bootstrap$model, get_predictions)
library(yardstick)
results <- map_dfr(pdx_bootstrap$predictions, rmse, obs, preds)
results
mean(results$.estimate)
some_preds <- tibble(
tree1 =  pdx_bootstrap[[4]][[1]]$preds,
tree2 = pdx_bootstrap[[4]][[2]]$preds,
tree3 = pdx_bootstrap[[4]][[3]]$preds,
tree4 = pdx_bootstrap[[4]][[4]]$preds
) %>% rowwise() %>% mutate(bagged = mean(c_across( )))
some_preds%>% head()
bagged_results <- data.frame(obs = my_pdxTrees_test$Carbon_Sequestration_lb, preds = some_preds$bagged)
rbind(results, rmse(bagged_results, truth = obs, estimate = preds )) %>% mutate(model = c("tree 1", "tree 2", "tree 3", "tree 4", "bagged")) %>% select(model, everything())
set.seed(11)
library(randomForest)
rfmodels<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
bagged_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
library(randomForest)
rfmodel <- randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train)
rfmodel
set.seed(1)
rfmodel2 <- randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train,
ntree = 10, mtry = 5)
rfmodel2
my_preds<- predict(rfmodel, my_pdxTrees_test)
results <- data.frame(obs =  my_pdxTrees_test$Carbon_Sequestration_lb, preds = my_preds)
results %>% head()
importance(rfmodel)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
varImpPlot(rfmodel)
set.seed(11)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
rf_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
bagged_RMSE
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% pivot_longer(!.estimate, names_to = "model", values_to = "RMSE")
bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% pivot_longer(!n_trees, names_to = "model", values_to = "RMSE")
bagged_RMSE
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% select(-.metric - .estimator) %>%  pivot_longer(!n_trees,  names_to = "model", values_to = "RMSE")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% select(-.metric - .estimator) %>%  pivot_longer(!n_trees,  names_to = "model", values_to = "RMSE")
rf_RMSE
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% select(n_trees, .estimate, model) %>%  pivot_longer(!n_trees,  names_to = "model", values_to = "RMSE")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% select(n_trees, .estimate, model) %>%  pivot_longer(!c(n_trees, model),  names_to = "model", values_to = "RMSE")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE) %>% select(n_trees, .estimate, model) %>%  pivot_longer(!c("n_trees", "model"),  names_to = "model", values_to = "RMSE")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(11)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 5, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(11)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 5, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(1111)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(1010)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(1010)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 2, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(1010)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 5, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(1010)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 6, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(271)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(271)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(271)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(271)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 3, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(271)
library(randomForest)
rfmodels2<-list()
tree_size <- c(1:5,10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(271)
library(randomForest)
rfmodels2<-list()
tree_size <- c(10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
