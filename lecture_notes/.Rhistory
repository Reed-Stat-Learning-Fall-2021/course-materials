solTrain <- solTrain %>% select(!starts_with("FP"))
solTrain %>% ggplot(aes(x = Solubility))+geom_histogram(color = "white", fill = "steelblue")+labs(title = "Distribution of Solubility")+theme_bw()
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16, color = "steelblue")+facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "red") + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "red", size = .5) + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "red", size = .5, alpha = .75) + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "red", size = .5, alpha = .75) + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "red", size = .5, alpha = .5) + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "red", size = .5, alpha = .25) + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "maroon", size = .5, alpha = .25) + facet_wrap(~var, scales = "free")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "maroon", size = .35) + facet_wrap(~var, scales = "free")+theme_bw()
ggcor(solTrain)
library(GGally)
ggcor(solTrain)
library(GGally)
ggcorr(solTrain)
ggcorr(solTrain, geom = "circle")
corrplot(solTrain, geom = "circle")
library(corrplot)
install.packages("corrplot")
library(corrplot)
corrplot(solTrain )
my_cor <- cor(SOlTrain)
my_cor <- cor(solTrain)
corrplot(my_cor )
library(GGally)
ggcorr(solTrain)
ggcorr(solTrain, hjust = 0.75, size = 5)
ggcorr(solTrain, hjust = 0.75, size = 1)
ggcorr(solTrain, hjust = 0.75, size = 2)
ggcorr(solTrain, hjust = 2, size = 2)
ggcorr(solTrain, hjust = 1, size = 2)
library(GGally)
ggcorr(solTrain, hjust = 1, size = 2)
library(GGally)
ggcorr(solTrain, hjust = 1, size = 2, layout.exp = 1)
library(GGally)
ggcorr(solTrain, hjust = 1, size = 2, layout.exp = 4)
library(GGally)
ggcorr(solTrain, hjust = 1, size = 2, layout.exp = 5)
sol_mod <- lm(Solubility ~ ., data = SolTrain)
sol_mod <- lm(Solubility ~ ., data = solTrain)
summary(sol_mod)
sol_mod <- lm(Solubility ~ ., data = solTrain)
summary(sol_mod)
summary(sol_mod)$coef
summary(sol_mod)
library(broom)
?broom
?tidy
tidy(summary(sol_mod))
summary(sol_mod)
summary(sol_mod)$error
?summary.lm
summary(sol_mod)$coefficients
sol_mod <- lm(Solubility ~ -NumNonHBonds -NumHydrogen -NumRings, data = solTrain)
summary(sol_mod)
sol_mod <- lm(Solubility ~ . -NumNonHBonds -NumHydrogen -NumRings, data = solTrain)
summary(sol_mod)
sol_mod <- lm(Solubility ~ ., data = solTrain)
summary(sol_mod)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 8)
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 8)
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 20)
?regsubsets
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
d<-data.frame(model = 1:20, adj_r_sq, rss, cp )
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
d<-data.frame(model = 1:17, adj_r_sq, rss, cp )
d
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 17)
summary(best_subset)
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
d<-data.frame(model = 1:17, adj_r_sq, rss, cp )
d
aic<-summary(best_subset)$aic
d<-data.frame(model = 1:17, adj_r_sq, rss, cp, aic )
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
aic<-summary(best_subset)$aic
d<-data.frame(model = 1:17, adj_r_sq, rss, cp, aic )
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
aic<-summary(best_subset)$aic
d<-data.frame(model = 1:17, adj_r_sq, rss, cp, aic )
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 18)
summary(best_subset)
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 19)
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 17)
summary(best_subset)
summary(best_subset)$outmat
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
aic<-summary(best_subset)$aic
d<-data.frame(model = 1:17, adj_r_sq, rss, cp, aic )
summary(best_subset)$aic
aic<-summary(best_subset)$bic
d<-data.frame(model = 1:17, adj_r_sq, rss, cp, aic )
d
adj_r_sq<-summary(best_subset)$adjr2
rss<-summary(best_subset)$rss
cp<-summary(best_subset)$cp
bic<-summary(best_subset)$bic
d<-data.frame(model = 1:17, adj_r_sq, rss, cp, bic )
d
summary(best_subset)$outmat
summary(best_subset)$which
summary(best_subset)$outmat
best_subset$obj
best_subset
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 5)
summary(best_subset)$outmat
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 17)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 5)
summary(best_subset)$outmat
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(AppliedPredictiveModeling)
data(solubility)
solTest <- data.frame(solTestX, Solubility = solTestY)
solTrain <- data.frame(solTrainX, Solubility =  solTrainY)
solTest <- solTest %>% select(!starts_with("FP"))
solTrain <- solTrain %>% select(!starts_with("FP"))
solTrain %>% ggplot(aes(x = Solubility))+geom_histogram(color = "white", fill = "steelblue")+labs(title = "Distribution of Solubility")+theme_bw()
solTrain %>% gather(-Solubility, key = "var", value = "value") %>% ggplot(aes(x = value, y = Solubility ))+geom_point(alpha = .15, shape = 16)+geom_smooth(se = F, color = "maroon", size = .35) + facet_wrap(~var, scales = "free")+theme_bw()
library(GGally)
ggcorr(solTrain, hjust = 1, size = 2, layout.exp = 5)
sol_mod <- lm(Solubility ~ ., data = solTrain)
summary(sol_mod)
sol_mod <- lm(Solubility ~ . -NumNonHBonds -NumHydrogen -NumRings, data = solTrain)
summary(sol_mod)
library(leaps)
best_subset<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 17)
summary(best_subset)$outmat
best_subset5<-regsubsets(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings , data = solTrain, nvmax = 5)
summary(best_subset5)$outmat
d <- data.frame(
model = 1:17,
adj_r_sq<-summary(best_subset)$adjr2,
rss<-summary(best_subset)$rss,
cp<-summary(best_subset)$cp,
bic<-summary(best_subset)$bic
)
d %>% head()
d <- data.frame(model = 1:17,
adj_r_sq = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic)
d %>% head()
ggplot(d, aes(x = model, y = adjr2))+geom_line()+theme_bw()
d <- data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic)
d %>% head()
ggplot(d, aes(x = model, y = adjr2))+geom_line()+theme_bw()
ggplot(d, aes(x = model, y = rss))+geom_line()+theme_bw()
ggplot(d, aes(x = model, y = cp))+geom_line()+theme_bw()
ggplot(d, aes(x = model, y = bic))+geom_line()+theme_bw()
regsubsets(Solubility ~ ., nbest = 2, data = solTrain)
regsubsets(Solubility ~ ., nbest = 2, data = solTrain) %>% summary()
coef(best_subset)
coef(best_subset, 1:3)
vcov(best_subset,3)
regsubsets.formula
?regsubsets.formula
formula(best_subset)
coef(best_subset, 1:3)
coef(best_subset, 3)
names(coef(best_subset,3))
names(coef(best_subset,best.bic))
names(coef(best_subset,bic.min))
cp.min <- which.min(summary(best_subset)$co)
cp.min <- which.min(summary(best_subset)$cp)
adjr2.min <- which.min(summary(best_subset)$adjr2)
cp.min <- which.min(summary(best_subset)$cp)
adjr2.min <- which.min(summary(best_subset)$adjr2)
rss.min <- which.min(summary(best_subset)$rss)
cp.min <- which.min(summary(best_subset)$cp)
bic.min <- which.min(summary(best_subset)$bic)
data.frame(adjr2.min, rss.min, cp.min, bic.min)
adjr2.max <- which.max(summary(best_subset)$adjr2)
rss.min <- which.min(summary(best_subset)$rss)
cp.min <- which.min(summary(best_subset)$cp)
bic.min <- which.min(summary(best_subset)$bic)
data.frame(adjr2.max, rss.min, cp.min, bic.min)
coef(best_subset, bic.min)
names(coef(best_subset, bic.min))
forward_select<-regsubsets(Solubility~.-NumNonHBonds -NumHydrogen -NumRings,
data = solTrain, nvmax = 17, method = "forward")
forward_select<-regsubsets(Solubility~.-NumNonHBonds -NumHydrogen -NumRings,
data = solTrain, nvmax = 17, method = "forward")
backward_elim<-regsubsets(Solubility~.-NumNonHBonds -NumHydrogen -NumRings,
data = solTrain, nvmax = 17, method = "backward")
summary(forward_select)$outmat
summary(forward_select)$outmat
data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)
data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)
data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)
%>%
data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)%>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(backward_elim)$adjr2,
rss = summary(backward_elim)$rss,
cp = summary(backward_elim)$cp,
bic = summary(backward_elim)$bic
)
)
data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)%>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(backward_elim)$adjr2,
rss = summary(backward_elim)$rss,
cp = summary(backward_elim)$cp,
bic = summary(backward_elim)$bic
)
) %>% mutate(method = rep(c("best", "forward", "backward"), each = 17))
metrics <- data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)%>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(backward_elim)$adjr2,
rss = summary(backward_elim)$rss,
cp = summary(backward_elim)$cp,
bic = summary(backward_elim)$bic
)
) %>% mutate(method = rep(c("best", "forward", "backward"), each = 17))
ggplot(metrics, aes( x = model, y = adjr2, color = method))+geom_line()
ggplot(metrics, aes( x = model, y = adjr2, color = method))+geom_line()+theme_bw()
ggplot(metrics, aes( x = model, y = adjr2, color = method))+geom_line(size = 1)+theme_bw()
ggplot(metrics, aes( x = model, y = rss, color = method))+geom_line(size = 1)+theme_bw()
ggplot(metrics, aes( x = model, y = cp, color = method))+geom_line(size = 1)+theme_bw()
ggplot(metrics, aes( x = model, y = bic, color = method))+geom_line(size = 1)+theme_bw()
g1 <- ggplot(metrics, aes( x = model, y = adjr2, color = method))+geom_line(size = 1)+theme_bw()
g2 <- ggplot(metrics, aes( x = model, y = rss, color = method))+geom_line(size = 1)+theme_bw()
g3 <- ggplot(metrics, aes( x = model, y = cp, color = method))+geom_line(size = 1)+theme_bw()
g4 <- ggplot(metrics, aes( x = model, y = bic, color = method))+geom_line(size = 1)+theme_bw()
library(gridExtra)
grid.arrange(g1,g2,g3,g4, ncol = 2)
metrics %>% gather(!model, value = "var", value = "value")
metrics %>% gather(!model, value = "var", value = "value")
metrics %>% gather(-model, value = "var", value = "value")
metrics %>% gather(-model, value = "var", value = "value")
metrics %>% gather(-model, value = "var", value = "value")
metrics <- data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)%>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(backward_elim)$adjr2,
rss = summary(backward_elim)$rss,
cp = summary(backward_elim)$cp,
bic = summary(backward_elim)$bic
)
) %>% mutate(method = rep(c("best", "forward", "backward"), each = 17))
View(metrics)
metrics %>% gather(-model - method, value = "var", value = "value")
?gather
metrics %>% pivot_longer(-model - method, value = "var", value = "value")
?pivot_longer
metrics %>% pivot_longer(!model, names_to =  "var", values_to =  = "value")
metrics %>% pivot_longer(!model, names_to =  "var", values_to =  "value")
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value")
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line()
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line()~facet_wrap(~var, scales = "free")
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line()~facet_wrap(~var, scales = "free")
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line()+facet_wrap(~var, scales = "free")
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line()+facet_wrap(~var, scales = "free")+theme_bw()
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line()+facet_wrap(~var, scales = "free")+theme_bw(size = 1)
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line(size = 1)+facet_wrap(~var, scales = "free")+theme_bw()
metrics <- data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)%>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(backward_elim)$adjr2,
rss = summary(backward_elim)$rss,
cp = summary(backward_elim)$cp,
bic = summary(backward_elim)$bic
)
) %>% mutate(method = rep(c("best", "forward", "backward"), each = 17))
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line(size = 1)+facet_wrap(~var, scales = "free")+theme_bw()
metrics <- data.frame(model = 1:17,
adjr2 = summary(best_subset)$adjr2,
rss = summary(best_subset)$rss,
cp = summary(best_subset)$cp,
bic = summary(best_subset)$bic) %>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(forward_select)$adjr2,
rss = summary(forward_select)$rss,
cp = summary(forward_select)$cp,
bic = summary(forward_select)$bic
)
)%>%
rbind(
data.frame(model = 1:17,
adjr2 = summary(backward_elim)$adjr2,
rss = summary(backward_elim)$rss,
cp = summary(backward_elim)$cp,
bic = summary(backward_elim)$bic
)
) %>% mutate(method = rep(c("best", "forward", "backward"), each = 17))
metrics %>% pivot_longer(!c(model, method), names_to =  "var", values_to =  "value") %>% ggplot(aes(x = model, y = value, color = method))+geom_line(size = .5)+facet_wrap(~var, scales = "free")+theme_bw()
plot(best_subset, scale = "adjr2")
plot(best_subset, scale = "bic")
plot(best_subset, scale = "adjr2")
plot(best_subset, scale = "adjr2", col = "red")
plot(best_subset, scale = "adjr2", col=gray(seq(0, 0.9, length = 10)))
plot(best_subset, scale = "adjr2", col=gray(seq(0, 0.9, length = 17)))
plot(best_subset, scale = "adjr2", col=gray(seq(0, 0.9, length = 20)))
plot(best_subset, scale = "adjr2", col=gray(seq(0, 0.5, length = 20)))
plot(best_subset, scale = "adjr2", col=gray(seq(0, 0.2, length = 20)))
plot(best_subset, scale = "adjr2", col=gray(seq(0, 10, length = 20)))
plot(best_subset, scale = "adjr2", col=gray(seq(0, 1, length = 20)))
plot(best_subset, scale = "adjr2")
plot(best_subset, scale = "rss")
plot(best_subset, scale = "cp")
plot(best_subset, scale = "Cp")
plot(best_subset, scale = "adjr2")
plot(best_subset, scale = "adjr2", col=gray(seq(.8, 0.9, length = 10)))
plot(best_subset, scale = "adjr2", col=gray(seq(.5, 0.9, length = 10)))
plot(best_subset, scale = "adjr2", col=gray(seq(.5, 0.7, length = 10)))
plot(best_subset, scale = "adjr2", col=gray(seq(.5, 0.9, length = 10)))
plot(best_subset, scale = "adjr2", col=gray(seq(.3, 0.9, length = 10)))
plot(best_subset, scale = "adjr2")
plot(best_subset, scale = "adjr2", col=gray(seq(0, 0.9, length = 17)))
plot(best_subset, scale = "adjr2", col=gray(seq(.2, 0.8, length = 17)))
plot(best_subset, scale = "adjr2", col=gray(seq(.2, 1, length = 17)))
plot(best_subset, scale = "adjr2")
library(gglm)
gglm(sol_mod)
mod17 <-lm(Solubility~. -.-NumNonHBonds -NumHydrogen -NumRings  , data = solTrain)
names(coef(summary(best_subset), 15))
coef(best_subset, 15)
names(coef(best_subset), 15)
names(coef(best_subset, 15))
?intersect
all_names<-names(coef(best_subset), 17)
all_names<-names(coef(best_subset, 17))
all_names
names15 <- names(coef(best_subset), 17)
names15 <- names(coef(best_subset), 15)
names15 <- names(coef(best_subset, 15))
setdiff(all_names, names15)
mod15 <-lm(. -.-NumNonHBonds -NumHydrogen -NumRings - NumNitrogen - NumOxygen , data = Solubility)
mod15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings - NumNitrogen - NumOxygen , data = Solubility)
names(coef(best_subset, 5))
mod5 <-lm(Solubility ~ NumNonHAtoms + NumBonds + NumRotBonds+ NumNitrogen + NumOxygen  , data = solTrain)
names(coef(best_subset, 9))
mod5 <-lm(Solubility ~ NumNonHAtoms + NumBonds + NumRotBonds+ NumNitrogen + NumOxygen  , data = solTrain)
mod9 <-lm(Solubility ~ MolWeight + NumBonds + NumMultBonds+ NumRotBonds + NumAromaticBonds + NumNitrogen + NumOxygen + NumChlorine + SurfaceArea2  , data = solTrain)
mod15 <-lm(Solubility ~.-NumNonHBonds -NumHydrogen -NumRings - NumNitrogen - NumOxygen , data = solTrain)
mod17 <-lm(Solubility~. -.-NumNonHBonds -NumHydrogen -NumRings  , data = solTrain)
preds5 <- predict(mod5, solTest)
preds5 <- predict(mod5, solTest)
preds9 <- predict(mod9, solTest)
preds15 <- predict(mod15, solTest)
preds17 <- predict(mod17, solTest)
all_preds <- data.frame(model5 = preds5, model9 = preds9, model15 =  preds15, model17 = preds17) %>% pivot_longer(names_to = "model", values_to = "prediction"  )
all_preds <- data.frame(model5 = preds5, model9 = preds9, model15 =  preds15, model17 = preds17, observation = 1:316) %>% pivot_longer(!observation, names_to = "model", values_to = "prediction"  )
View(all_preds)
all_preds <- data.frame(model5 = preds5, model9 = preds9, model15 =  preds15, model17 = preds17, actual = solTest$Solubility, observation = 1:316) %>% pivot_longer(!observation, names_to = "model", values_to = "prediction"  )
all_preds <- data.frame(model5 = preds5, model9 = preds9, model15 =  preds15, model17 = preds17, actual = solTest$Solubility, observation = 1:316) %>% pivot_longer(!c(observation, actual), names_to = "model", values_to = "prediction"  )
all_preds %>% mutate(sq_err = (actual - prediction)^2)
all_preds %>% mutate(sq_err = (actual - prediction)^2) %>% group_by(model) %>% summarize(mse = mean(sq_err))
all_preds %>% mutate(sq_err = (actual - prediction)^2) %>% group_by(model) %>% summarize(mse = mean(sq_err)) %>% arrange(desc(mse))
all_preds %>% mutate(sq_err = (actual - prediction)^2) %>% group_by(model) %>% summarize(mse = mean(sq_err)) %>% arrange(mse)
preds5 <- predict(mod5, solTest)
preds9 <- predict(mod9, solTest)
preds15 <- predict(mod15, solTest)
preds17 <- predict(mod17, solTest)
all_preds <- data.frame(model_5 = preds5, model_9 = preds9, model_15 =  preds15, model_17 = preds17, actual = solTest$Solubility, observation = 1:316) %>% pivot_longer(!c(observation, actual), names_to = "model", values_to = "prediction"  )
all_preds %>% mutate(sq_err = (actual - prediction)^2) %>% group_by(model) %>% summarize(mse = mean(sq_err)) %>% arrange(mse)
