bootstraps<- rbind(bootstraps,
data.frame(slope = summary(my_mod)$coefficients[4,1]))
}
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue" )+
geom_vline(xintercept = 1, color = "red")
b4
summary(my_mod)$coefficients
set.seed(10101)
n<-100
X1<-runif(n, 0, 1)
X2 <- runif(n, 0, 1)
e<-rnorm(n, 0 ,.5)
Y<-1 + 2*X1 + 3*X2 + X1*X2+ e
d<-data.frame(X1, X2, Y)
my_mod<-lm(Y ~ X1*X2, data = d)
summary(my_mod)$coefficients
b4 <- summary(my_mod)$coefficients[4,1]
trials<-1000
bootstraps<-data.frame()
for (i in 1:trials){
boot<-sample_n(d, size = n, replace = T)
boot_mod<-lm(Y ~ X1*X2 , data = boot)
bootstraps<- rbind(bootstraps,
data.frame(slope = summary(boot_mod)$coefficients[4,1]))
}
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue" )+
geom_vline(xintercept = 1, color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = text, x = 0.5, y = 90, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = text, x = 0.5, y = 90, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3, y = 90, label = "Sample Slope", color = "blue")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red", size  =1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red", size  =1)+
annotate(geom = "text", x = 0.5, y = 95, label = "True Slope", color = "red")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red", size  =1)+
annotate(geom = "text", x = 0.5, y = 100, label = "True Slope", color = "red")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red", size  =1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 2, color = "red")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red",size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red",size = 1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b1, color = "blue" ) +
geom_vline(xintercept = 2, color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b1, color = "blue" ) +
geom_vline(xintercept = 2, color = "red")+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b4, color = "blue" ) +
geom_vline(xintercept = 1, color = "red")+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
common<-intersect(a_bootstrap_sample, d)
length(common$X1)
set.seed(135)
a_bootstrap_sample<-sample_n(d, size = n, replace = T)
a_bootstrap_sample
d
common$X1
common<-intersect(a_bootstrap_sample, d)
length(common$X1)
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b4, color = "blue", size = 1 ) +
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
ggplot(d, aes( x = X1, y = Y, color = X2))+geom_point()+
theme_bw()+
labs(title = "One sample from true model")
ggplot(d, aes( x = X1, y = Y, color = X2))+geom_point()+
theme_bw()+
labs(title = "One Sample from True Model")
slopes %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
bootstraps %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
rbind(bootstraps, slopes)
rbind(bootstraps, slopes, method = rep(c("simulation", "bootstrap"), each = 1000))
rbind(bootstraps, slopes) %>% cbind(method = rep(c("simulation", "bootstrap"), each = 1000))
rbind(slopes, bootstraps) %>% cbind(method = rep(c("simulation", "bootstrap"), each = 1000))
rbind(slopes, bootstraps) %>% cbind(method = rep(c("simulation", "bootstrap"), each = 1000)) %>%
group_by(method) %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
?sample_n
?sample_n
set.seed(135)
a_bootstrap_sample<-slice_sample(d, n = n, replace = T)
common<-intersect(a_bootstrap_sample, d)
length(common$X1)
trials<-1000
bootstraps<-data.frame()
for (i in 1:trials){
boot<-sample_n(d, size = n, replace = T)
boot_mod<-lm(Y ~ X1*X2 , data = boot)
bootstraps<- rbind(bootstraps,
data.frame(slope = summary(boot_mod)$coefficients[4,1]))
}
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
bootstraps %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red",size = 1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b4, color = "blue", size = 1 ) +
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
rbind(slopes, bootstraps) %>% cbind(method = rep(c("simulation", "bootstrap"), each = 1000)) %>%
group_by(method) %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
bootstraps %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
trials<-1000
bootstraps<-data.frame()
for (i in 1:trials){
boot<-sample_n(d, size = n, replace = T)
boot_mod<-lm(Y ~ X1*X2 , data = boot)
bootstraps<- rbind(bootstraps,
data.frame(slope = summary(boot_mod)$coefficients[4,1]))
}
set.seed(929)
trials<-1000
bootstraps<-data.frame()
for (i in 1:trials){
boot<-sample_n(d, size = n, replace = T)
boot_mod<-lm(Y ~ X1*X2 , data = boot)
bootstraps<- rbind(bootstraps,
data.frame(slope = summary(boot_mod)$coefficients[4,1]))
}
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
bootstraps %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red",size = 1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b4, color = "blue", size = 1 ) +
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
rbind(slopes, bootstraps) %>% cbind(method = rep(c("simulation", "bootstrap"), each = 1000)) %>%
group_by(method) %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = T,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(moderndive)
set.seed(10101)
n<-100
X1<-runif(n, 0, 1)
X2 <- runif(n, 0, 1)
e<-rnorm(n, 0 ,.5)
Y<-1 + 2*X1 + 3*X2 + X1*X2+ e
d<-data.frame(X1, X2, Y)
ggplot(d, aes( x = X1, y = Y, color = X2))+geom_point()+
theme_bw()+
labs(title = "One Sample from True Model")
my_mod<-lm(Y ~ X1*X2, data = d)
summary(my_mod)$coefficients
b4 <- summary(my_mod)$coefficients[4,1]
set.seed(234)
trials<-1000 #Number of simulations
n<-100 #Number points in each simulation
X1<-runif(n, 0, 1) # Generate random X1; same for all sims
X2 <- runif(n, 0, 1) # Generate random X1; same for all sims
slopes<-data.frame() #Create empty dataframe for the slopes
for (i in 1:trials){
sim_e<-rnorm(n, 0 ,.5)
sim_Y<-1 + 2*X1 + 3*X2 + X1*X2+ sim_e
sim_d<-data.frame(X1, X2, sim_Y)
sim_mod<-lm(sim_Y ~ X1*X2, data = sim_d)
slopes<-rbind( slopes,
data.frame(slope = summary(sim_mod)$coefficients[4,1]))
}
head(slopes)
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red", size  =1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
slopes %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
head(d)
set.seed(135)
a_bootstrap_sample<-slice_sample(d, n = n, replace = T)
common<-intersect(a_bootstrap_sample, d)
length(common$X1)
set.seed(929)
trials<-1000
bootstraps<-data.frame()
for (i in 1:trials){
boot<-sample_n(d, size = n, replace = T)
boot_mod<-lm(Y ~ X1*X2 , data = boot)
bootstraps<- rbind(bootstraps,
data.frame(slope = summary(boot_mod)$coefficients[4,1]))
}
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
bootstraps %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red",size = 1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
ggplot(bootstraps, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b4, color = "blue", size = 1 ) +
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
rbind(slopes, bootstraps) %>% cbind(method = rep(c("simulation", "bootstrap"), each = 1000)) %>%
group_by(method) %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope), q.025 = quantile(slope,.025), q.975 = quantile(slope, .975))
set.seed(929)
interaction_slope <- function(split){
x <- analysis(split)
boot_mod <-lm(Y ~ X1*X2 , data = x)
slope <- summary(boot_mod)[4,1]
}
bt_resamples <- bootstraps(d, times = 1000)
library(rsample)
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slopes <- map_dbl(bt_resamples, interaction_slop)
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slopes <- map_dbl(bt_resamples, interaction_slope)
set.seed(929)
interaction_slope <- function(split){
x <- analysis(split)
boot_mod <-lm(Y ~ X1*X2 , data = x)
slope <- summary(boot_mod)[4,1]
}
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slopes <- map_dbl(bt_resamples, interaction_slope)
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slopes <- map_dbl(bt_resamples$splits, interaction_slope)
my_mod
my_mod$coefficients
my_mod$coefficients[4,1]
my_mod$coefficients[4]
slope <- boot_mod$coefficients[4]
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slopes <- map_dbl(bt_resamples$splits, interaction_slope)
set.seed(929)
interaction_slope <- function(split){
x <- analysis(split)
boot_mod <-lm(Y ~ X1*X2 , data = x)
slope <- boot_mod$coefficients[4]
}
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slopes <- map_dbl(bt_resamples$splits, interaction_slope)
View(bt_resamples)
bt_resamples %>%
ggplot( aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
set.seed(929)
trials<-1000
bootstraps<-data.frame()
for (i in 1:trials){
boot<-sample_n(d, size = n, replace = T)
boot_mod<-lm(Y ~ X1*X2 , data = boot)
bootstraps<- rbind(bootstraps,
data.frame(slope = summary(boot_mod)$coefficients[4,1]))
}
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slope <- map_dbl(bt_resamples$splits, interaction_slope)
bt_resamples %>%
ggplot( aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b4, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
bt_resamples %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
ggplot(bt_resamples, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b4, color = "blue", size = 1 ) +
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
rbind(slopes, bt_resamples %>% select(slope)) %>% cbind(method = rep(c("sim", "boot"), each = 1000)) %>%
group_by(method) %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope),
q.025 = quantile(slope,.025), q.975 = quantile(slope, .975))
my_mod<-lm(Y ~ X1*X2, data = d)
summary(my_mod)$coefficients
b3 <-  my_mod$coefficients[4]
bt_resamples %>% as.data.frame() %>%  summarize(mean_slope = mean(slope), sd_slope = sd(slope))
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = T,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(rsample)
# Create a function to compute statistic from bootstrap sample
set.seed(929)
interaction_slope <- function(split){
x <- analysis(split)
boot_mod <-lm(Y ~ X1*X2 , data = x)
slope <- boot_mod$coefficients[4]
slope
}
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = T,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(moderndive)
library(ISLR)
library(rsample)
set.seed(10101)
n<-100
X1<-runif(n, 0, 1)
X2 <- runif(n, 0, 1)
e<-rnorm(n, 0 ,.5)
Y<-1 + 2*X1 + 3*X2 + X1*X2+ e
d<-data.frame(X1, X2, Y)
ggplot(d, aes( x = X1, y = Y, color = X2))+geom_point()+
theme_bw()+
labs(title = "One Sample from True Model")
my_mod<-lm(Y ~ X1*X2, data = d)
summary(my_mod)$coefficients
b3 <-  my_mod$coefficients[4]
set.seed(234)
trials<-1000 #Number of simulations
n<-100 #Number points in each simulation
X1<-runif(n, 0, 1) # Generate random X1; same for all sims
X2 <- runif(n, 0, 1) # Generate random X1; same for all sims
slopes<-data.frame() #Create empty dataframe for the slopes
for (i in 1:trials){
sim_e<-rnorm(n, 0 ,.5)
sim_Y<-1 + 2*X1 + 3*X2 + X1*X2+ sim_e
sim_d<-data.frame(X1, X2, sim_Y)
sim_mod<-lm(sim_Y ~ X1*X2, data = sim_d)
slopes<-rbind( slopes,
data.frame(slope = summary(sim_mod)$coefficients[4,1]))
}
head(slopes)
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red", size  =1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
slopes %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
head(d)
set.seed(135)
a_bootstrap_sample<-slice_sample(d, n = n, replace = T)
common<-intersect(a_bootstrap_sample, d)
length(common$X1)
# Create a function to compute statistic from bootstrap sample
set.seed(929)
interaction_slope <- function(split){
x <- analysis(split)
boot_mod <-lm(Y ~ X1*X2 , data = x)
slope <- boot_mod$coefficients[4]
slope
}
# Use rsample to create bootstrap samples and apply function
library(rsample)
bt_resamples <- bootstraps(d, times = 1000)
bt_resamples$slope <- map_dbl(bt_resamples$splits, interaction_slope)
bt_resamples %>%
ggplot( aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes") +
geom_vline(xintercept = b3, color = "blue", size = 1)+
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
bt_resamples %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope))
bt_resamples %>% as.data.frame() %>%  summarize(mean_slope = mean(slope), sd_slope = sd(slope))
ggplot(slopes, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw()+
labs(title = "Simulated Distribution of Slopes")+
geom_vline(xintercept = 1, color = "red",size = 1)+
annotate(geom = "text", x = 0.65, y = 100, label = "True Slope", color = "red")
ggplot(bt_resamples, aes(x = slope))+
geom_histogram(bins= 25, color = "white")+theme_bw() +
labs(title = "Bootstrap Distribution of Slopes")+
geom_vline(xintercept = b3, color = "blue", size = 1 ) +
geom_vline(xintercept = 1, color = "red", size = 1)+
annotate(geom = "text", x = 0.5, y = 90, label = "True Slope", color = "red")+
annotate(geom = "text", x = 3.25, y = 90, label = "Sample Slope", color = "blue")
rbind(slopes, bt_resamples %>% select(slope)) %>%
cbind(method = rep(c("sim", "boot"), each = 1000)) %>%
group_by(method) %>% summarize(mean_slope = mean(slope), sd_slope = sd(slope),
q.025 = quantile(slope,.025), q.975 = quantile(slope, .975))
