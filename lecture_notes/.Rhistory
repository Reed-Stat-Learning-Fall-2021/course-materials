set.seed(1)
x<-seq(-10,100, length.out = 50)
z<- -cos(.75*pi*x/100)/2+.5
y<-c()
for (i in 1:50){
y<-c(y, sample(c(0,1), size = 1,   prob = c(1-z[i],z[i])))
}
d2 <- data.frame(x,y,z)
ggplot(d2, aes(x = x ,y =y))+geom_point()+theme_bw()
log_mod <- glm(y~x, family = "binomial", data = d2)
ggplot(data.frame(x,y), aes(x = x ,y =y))+geom_point() +geom_smooth(method = "lm", se = F, color = "salmon")+geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+theme_bw()
log_mod
-3.99081 /(0.05459)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
library(skimr)
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(sex)
Titanic %>% count(survived)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+ geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+ geom_jitter(height = .01, alpha = .5)+theme_bw()
log_mod <- glm(survived ~ age, data = Tinanic1, family = "binomial")
log_mod <- glm(survived ~ age, data = Titanic1, family = "binomial")
coef(log_mod)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = 0.03) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = 0.03) +
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
+ geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
simple_logreg <- glm(survived ~ age, data = Titanic1, family = "binomial")
summary(simple_logreg)$coefficients
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F) +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F) +
geom_smooth(method = "lm", se = F, color  = "red", alpha = .5)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F) +
geom_smooth(method = "lm", se = F, color  = "red")
lin_mod <- lm(survived ~ age, data = Titanic1)
coef(lin_mod)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F) +
geom_smooth(method = "lm", se = F, color  = "red", alpha = .25)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F) +
geom_smooth(method = "lm", se = F, color  = "red", size = .5)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F, size = .5) +
geom_smooth(method = "lm", se = F, color  = "red", size = .5)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F) +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2) +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,dashed) +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
summary(simple_logreg)
exp(-.011)
1-exp(-0.011029)
?glm
logreg <- glm(survived ~ age + sex, data = Titanic1, family = "binomial")
summary(logreg)
t <- seq(-10, 10, length  = 100)
?logistic
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
logistic(1,1,1)
plot(logistic(t,1,1,))
plot(logistic(t,1,1,),t)
plot(t,logistic(t,1,1))
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,1,1)
B<-logistic(t,1,2)
C<-logistic(t,1,5)
d <- data.frame(t, A, B, C)
d <- data.frame(t, A, B, C) %>% pivot_longer(!t)
View(d)
ggplot(d, aes(x =t, y = value, color = names))+geom_line()
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,1,1)
B<-logistic(t,1,2)
C<-logistic(t,1,5)
d <- data.frame(t, A, B, C) %>% pivot_longer(!t)
ggplot(d, aes(x =t, y = value, color = names))+geom_line()
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,1,1)
B<-logistic(t,1,2)
C<-logistic(t,1,5)
d <- data.frame(t, A, B, C) %>% pivot_longer(!t)
ggplot(d, aes(x =t, y = value, color = name))+geom_line()
ggplot(d, aes(x =t, y = value, color = name))+geom_line()+theme_bw()
ggplot(d, aes(x =t, y = value, color = name))+geom_line()+theme_bw()+labs(title = "Effect of Slope")
d <- data.frame(t, A, B, C) %>% pivot_longer(!t, names_to = "slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,1,1)
B<-logistic(t,1,2)
C<-logistic(t,1,5)
d <- data.frame(t, A, B, C) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope")
"1"<-logistic(t,1,1)
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
"1"<-logistic(t,1,1)
"2"<-logistic(t,1,2)
"5"<-logistic(t,1,5)
d <- data.frame(t, A, B, C) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
"1"<-logistic(t,1,1)
"2"<-logistic(t,1,2)
"5"<-logistic(t,1,5)
d <- data.frame(t, "1", B, C) %>% pivot_longer(!t, names_to = "slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
"1"<-logistic(t,1,1)
"2"<-logistic(t,1,2)
"5"<-logistic(t,1,5)
d <- data.frame(t, "1", "2", 5") %>% pivot_longer(!t, names_to = "slope")
d <- data.frame(t, "1", "2", "5") %>% pivot_longer(!t, names_to = "slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
"1"<-logistic(t,1,1)
"2"<-logistic(t,1,2)
"5"<-logistic(t,1,5)
d <- data.frame(t, "1", "2", "5") %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
slope_1<-logistic(t,1,1)
slope_2<-logistic(t,1,2)
slope_5<-logistic(t,1,5)
d <- data.frame(t, slope_1, slope_2, slope_5) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
slope_1<-logistic(t,0,1)
slope_2<-logistic(t,0,2)
slope_5<-logistic(t,0,5)
d <- data.frame(t, slope_1, slope_2, slope_5) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
slope_1<-logistic(t,0,1)
slope_2<-logistic(t,0,2)
slope_5<-logistic(t,0,5)
d <- data.frame(t, slope_1, slope_2, slope_5) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
slope_neg_5<-logistic(t,0,-5)
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
slope_1<-logistic(t,0,1)
slope_2<-logistic(t,0,2)
slope_5<-logistic(t,0,5)
slope_neg_5<-logistic(t,0,-5)
d <- data.frame(t, slope_1, slope_2, slope_5) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
slope_1<-logistic(t,0,1)
slope_2<-logistic(t,0,2)
slope_5<-logistic(t,0,5)
slope_neg_5<-logistic(t,0,-5)
d <- data.frame(t, slope_1, slope_2, slope_5,slope_neg_5) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
slope_1<-logistic(t,0,1)
slope_2<-logistic(t,0,2)
slope_5<-logistic(t,0,5)
slope_neg_1<-logistic(t,0,-1)
slope_neg_5<-logistic(t,0,-5)
d <- data.frame(t, slope_1, slope_2, slope_5,slope_neg_1,slope_neg_5) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,0,1)
B<-logistic(t,0,.5)
C<-logistic(t,0,5)
D<-logistic(t,0,-1)
E<-logistic(t,0,-5)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope")
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
?case_when
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,0,1)
B<-logistic(t,0,.5)
C<-logistic(t,0,4)
D<-logistic(t,0,-1)
E<-logistic(t,0,-4)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
?fct_relevel
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(slope = case_when(
slope == "A" ~ "0",
slope == "B" ~ "1",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-1",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(slope = case_when(
slope == "A" ~ "0",
slope == "B" ~ "1",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-1"
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(slope = case_when(
slope == "A" ~ "0",
slope == "B" ~ "1",
slope == "C" ~ "4",
slope == "D" ~ "-4",
slope == "E" ~ "-1"
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,-4,-1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,-1)
B<-logistic(t,1, -1)
C<-logistic(t,4,-1)
D<-logistic(t,-4,-1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of -1")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,0,1)
B<-logistic(t,0,.5)
C<-logistic(t,0,4)
D<-logistic(t,0,-1)
E<-logistic(t,0,-4)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,-1)
B<-logistic(t,1, -1)
C<-logistic(t,4,-1)
D<-logistic(t,-4,-1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of -1")
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
library(skimr)
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(sex)
Titanic %>% count(survived)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+
geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+
geom_jitter(height = .01, alpha = .5)+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)
library(moderndive)
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age + sex")
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age*sex")
logreg2 <- glm(survived ~ age * sex, data = Titanic1, family = "binomial")
summary(logreg2)
