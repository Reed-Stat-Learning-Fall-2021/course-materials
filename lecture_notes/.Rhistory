my_preds<- predict(rfmodel, my_pdxTrees_test)
results <- data.frame(obs =  my_pdxTrees_test$Carbon_Sequestration_lb, preds = my_preds)
results %>% head()
importance(rfmodel)
importance(rfmodel)
importance(rfmodel)
varImpPlot(rfmodel)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
varImpPlot(rfmodel)
set.seed(10)
library(randomForest)
rfmodels2<-list()
tree_size <- c(10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 5, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
set.seed(10)
library(randomForest)
rfmodels2<-list()
tree_size <- c(10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 6, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
library(randomForest)
library(yardstick)
#Include graphic of random forest
library(pdxTrees)
my_pdxTrees <- get_pdxTrees_parks(park = c("Berkeley Park", "Woodstock Park", "Westmoreland Park", "Mt Scott Park", "Powell Park", "Kennilworth Park", "Sellwood Park", "Crystal Springs Rhododendron Garden", "Laurelhurst Park"))%>%  mutate_if(is.character, as.factor) %>%  dplyr::select(DBH, Condition, Tree_Height, Crown_Width_NS, Crown_Width_EW, Crown_Base_Height, Functional_Type, Mature_Size, Carbon_Sequestration_lb) %>% drop_na()
set.seed(10)
library(rsample)
my_pdxTrees_split <- initial_split(my_pdxTrees )
my_pdxTrees_train <- training(my_pdxTrees_split)
my_pdxTrees_test <- testing(my_pdxTrees_split)
library(randomForest)
rfmodel <- randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train)
rfmodel
set.seed(1)
rfmodel2 <- randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train,
ntree = 10, mtry = 5)
rfmodel2
my_preds<- predict(rfmodel, my_pdxTrees_test)
results <- data.frame(obs =  my_pdxTrees_test$Carbon_Sequestration_lb, preds = my_preds)
results %>% head()
importance(rfmodel)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
varImpPlot(rfmodel)
set.seed(1010)
library(randomForest)
rfmodels2<-list()
tree_size <- c(10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
results_rf <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels2[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results_rf <- rbind(results_rf, data.frame(n_trees = i, preds, obs))
}
results <- data.frame()
for (i in tree_size){
preds <-predict(rfmodels[[i]], newdata = my_pdxTrees_test)
obs <- my_pdxTrees_test$Carbon_Sequestration_lb
results <- rbind(results, data.frame(n_trees = i, preds, obs))
}
bagged_RMSE <- results  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds)
rf_RMSE <- results_rf  %>% group_by(n_trees) %>% rmse(truth = obs, estimate = preds) %>% mutate(model = "Random Forest")
my_RMSE <- bagged_RMSE %>% mutate(model = "Bagged") %>% rbind(rf_RMSE)
my_RMSE %>%
ggplot( aes( x = n_trees, y = .estimate, color = model))+geom_point()+theme_bw()+geom_line()+labs(x = "Number of Trees", y = "RMSE")
include_graphics("img/adaboost.png")
mu <- mean(my_trees_na$Pollution_Removal_oz)
mu <- mean(my_pdxTrees_train$Carbon_Sequestration_lb)
my_pdxTrees_train_boost <- my_pdxTrees_train %>%
mutate(residuals1 = Carbon_Sequestration_lb - mu)
boost_tree_model<- tree(residuals1 ~ Crown_Base_Height  ,
data = boost_tree)
boost_tree_model<- rpart(residuals1 ~ Crown_Base_Height  ,
data = boost_tree)
library(rpart)
rpart(residuals1 ~ Crown_Base_Height  ,
data = boost_tree)
boost_tree_model<- rpart(residuals1 ~ Crown_Base_Height  ,
data = my_pdxTrees_train_boost)
boost_tree_model<- rpart(residuals1 ~ Crown_Base_Height  ,
data = my_pdxTrees_train_boost, control = rpart.control(maxdepth = 2))
boost_tree_model<- rpart(residuals1 ~ Crown_Base_Height  ,
data = my_pdxTrees_train_boost, control = rpart.control(maxdepth = 2))
predictions2<- predict(pruned_boost_tree_model, data = my_pdxTrees_train_boost)
predictions2<- predict(boost_tree_model, data = my_pdxTrees_train_boost)
predictions + mu
predictions<- predict(boost_tree_model, data = my_pdxTrees_test)
predictions + mu
predictions<- predict(boost_tree_model, data = my_pdxTrees_test)
predictions + mu
predictions<- predict(boost_tree_model, data = my_pdxTrees_test)+mu
library(gbm)
set.seed(10101)
boosted_tree<-gbm(Carbon_Sequestration_lb ~., my_pdxTrees_train,
distribution = "gaussian",
n.trees=1000,
interaction.depth = 2,
shrinkage = 0.02)
summary(boosted_tree)
my_preds_rf<- predict(rfmodel, test_trees)
my_preds_rf<- predict(rfmodel[[500]], test_trees)
my_preds_rf<- predict(rfmodel1[[500]], test_trees)
set.seed(1010)
library(randomForest)
rfmodels2<-list()
tree_size <- c(10*1:5, 75,100, 150, 200, 300, 400, 500)
for (i in tree_size){
rfmodels2[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i, mtry = 4, na.action = na.roughfix )
}
rfmodels<-list()
for (i in tree_size){
rfmodels[[i]]<-randomForest(Carbon_Sequestration_lb ~ ., data = my_pdxTrees_train, ntree = i , mtry = 8, na.action = na.roughfix )
}
new_rf <- randomforest
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
MSE_rf <- mean( (my_preds_rf - test_trees$Pollution_Removal_oz)^2 )
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
library(gbm)
set.seed(10101)
boosted_tree<-gbm(Carbon_Sequestration_lb ~., my_pdxTrees_train,
distribution = "gaussian",
n.trees=1000,
interaction.depth = 2,
shrinkage = 0.01)
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
library(gbm)
set.seed(10101)
boosted_tree<-gbm(Carbon_Sequestration_lb ~., my_pdxTrees_train,
distribution = "gaussian",
n.trees=1000,
interaction.depth = 2,
shrinkage = 1)
summary(boosted_tree)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
library(gbm)
set.seed(10101)
boosted_tree<-gbm(Carbon_Sequestration_lb ~., my_pdxTrees_train,
distribution = "gaussian",
n.trees=1000,
interaction.depth = 3,
shrinkage = .01)
summary(boosted_tree)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
library(gbm)
set.seed(10101)
boosted_tree<-gbm(Carbon_Sequestration_lb ~., my_pdxTrees_train,
distribution = "gaussian",
n.trees=1000,
interaction.depth = 3,
shrinkage = .001)
summary(boosted_tree)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
library(gbm)
set.seed(10101)
boosted_tree<-gbm(Carbon_Sequestration_lb ~., my_pdxTrees_train,
distribution = "gaussian",
n.trees=1000,
interaction.depth = 3,
shrinkage = .02)
summary(boosted_tree)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
MSE_rf <- mean( (my_preds_rf - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
MSE_bt <-  mean( (my_preds_bt - my_pdxTrees_test$Carbon_Sequestration_lb)^2 )
data.frame( model = c("Random Forest", "Boosted Tree"), MSE = c(MSE_rf, MSE_bt))
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
results <- data.frame(obs = my_pdxTrees_test, random_forest = my_preds_rf, boosted_tree = my_preds_bt) %>% pivot_longer(!obs, names_to = "model", values_to "preds")
results <- data.frame(obs = my_pdxTrees_test, random_forest = my_preds_rf, boosted_tree = my_preds_bt) %>% pivot_longer(!obs, names_to = model, values_to preds)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
results <- data.frame(obs = my_pdxTrees_test, random_forest = my_preds_rf, boosted_tree = my_preds_bt)
results <- data.frame(obs = my_pdxTrees_test, random_forest = my_preds_rf, boosted_tree = my_preds_bt) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results <- data.frame(obs = my_pdxTrees_test$Carbon_Sequestration_lb, random_forest = my_preds_rf, boosted_tree = my_preds_bt) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
summary(boosted_tree)
?summary.gbm
plot(boosted_tree)
?plot.gbm
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
summary(boosted_tree)
summary(boosted_tree)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
summary(boosted_tree)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
summary(boosted_tree)
boosted_tree
summary(boosted_tree)
summary(boosted_tree)
tidy(boosted_tree)
?summary.gbm
summary(boosted_tree, plotit = F)
summary(boosted_tree, plotit = T)
summary(boosted_tree, plotit = T, las = 2)
par(mfcol = c(1, 1), mar = c(1, 1, 1, 1))
summary(boosted_tree, plotit = T, las = 2)
par(mfcol = c(1, 1), mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2)
summary(boosted_tree, plotit = T, las = 2, cex=.5)
par(mfcol = c(1, 1), mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex=.5)
summary(boosted_tree, plotit = T, las = 2, cex=.5)
summary(boosted_tree, plotit = T, las = 1 )
summary(boosted_tree, plotit = T, las = 5 )
summary(boosted_tree, plotit = T, las = 2 )
par(mfcol = c(1, 1), mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2 )
par(mfcol = c(1 ), mar = c(5, 5, 5, 5))
par(mfcol = c(1 ), mar = c(5, 5, 5, 5))
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2 )
summary(boosted_tree, plotit = T, las = 2, cex.axis=0.7 )
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex.axis=1 )
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex.axis=5 )
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex =5 )
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex.axis=11 )
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex.axis=1 )
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex.lab=.5)
summary(boosted_tree, plotit = T, las = 2, cex.lab=.5, cex.axis = .25)
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2, cex.lab=.5, cex.axis =1)
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.axis =1)
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.5)
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.7)
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6)
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7)
par( mar = c(5, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(8, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(1, 5, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(4, 1, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(4, 8, 5, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(4, 8, 1, 5))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(4, 8, 1, 1))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(4, 5, 1, 1))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
par( mar = c(4, 6, 1, 1))
summary(boosted_tree, plotit = T, las = 2,  cex.names=.6, cex.lab = .7, cex.axis = .7)
my_lm <- lm(Carbon_Sequestration_lb~., data = my_pdxTrees_train)
my_preds_lm <- predict(my_lm, my_pdxTrees_test)
my_tree <- rpart(Carbon_Sequestration_lb ~., data = my_pdxTrees_train)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
my_lm <- lm(Carbon_Sequestration_lb~., data = my_pdxTrees_train)
my_preds_lm <- predict(my_lm, my_pdxTrees_test)
my_tree <- rpart(Carbon_Sequestration_lb ~., data = my_pdxTrees_train)
my_preds_tr <- predict(my_tree, my_pdxTrees_test)
results <- data.frame(obs = my_pdxTrees_test$Carbon_Sequestration_lb,
random_forest = my_preds_rf,
boosted_tree = my_preds_bt,
linear_model = my_preds_lm,
pruned_tree = my_preds_tr) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds)
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
plotcp(my_tree)
?rpart
my_tree <- rpart(Carbon_Sequestration_lb ~., data = my_pdxTrees_train, control = rpart.control(cp = .001))
plotcp(my_tree)
my_tree$parms
my_tree$variable.importance
my_tree$cptable
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
my_lm <- lm(Carbon_Sequestration_lb~., data = my_pdxTrees_train)
my_preds_lm <- predict(my_lm, my_pdxTrees_test)
my_tree <- rpart(Carbon_Sequestration_lb ~., data = my_pdxTrees_train, control = rpart.control(cp = .005))
my_preds_tr <- predict(my_tree, my_pdxTrees_test)
results <- data.frame(obs = my_pdxTrees_test$Carbon_Sequestration_lb,
random_forest = my_preds_rf,
boosted_tree = my_preds_bt,
linear_model = my_preds_lm,
pruned_tree = my_preds_tr) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
plotcp(my_tree)
my_preds_rf<- predict(rfmodels2[[500]], my_pdxTrees_test)
my_preds_bt<- predict(boosted_tree, my_pdxTrees_test)
my_lm <- lm(Carbon_Sequestration_lb~., data = my_pdxTrees_train)
my_preds_lm <- predict(my_lm, my_pdxTrees_test)
my_tree <- rpart(Carbon_Sequestration_lb ~., data = my_pdxTrees_train, control = rpart.control(cp = .005))
my_preds_tr <- predict(my_tree, my_pdxTrees_test)
results <- data.frame(obs = my_pdxTrees_test$Carbon_Sequestration_lb,
random_forest = my_preds_rf,
boosted_tree = my_preds_bt,
linear_model = my_preds_lm,
pruned_tree = my_preds_tr) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
?gbm
new_boost <- gbm(Carbon_Sequestration_lb~., distribution = "gaussian", cv.folds = 5)
new_boost <- gbm(Carbon_Sequestration_lb~., distribution = "gaussian", data = my_pdxTrees_train, cv.folds = 5)
new_boost$valid.error
new_boost$interaction.depth
new_boost$cv.fitted
library(rpart)
data(mtcars)
my_tree <- rpart(mpg~., data = mtcars)
predict(my_tree, mtcars)
data("iris")
my_tree <- rpart(Species ~., data = iris)
predict(my_tree, iris)
?predict.rpart
library(kknn)
?kknn
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
warning = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggrepel)
library(tidymodels)
sea_urchins<-read_csv("https://tidymodels.org/start/models/urchins.csv") %>%
setNames(c("food_regime", "initial_volume", "width")) %>%
mutate(food_regime = factor(food_regime, levels = c("Initial", "Low", "High")))
head(sea_urchins)
ggplot(sea_urchins,
aes(x = initial_volume,
y = width,
group = food_regime,
col = food_regime)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)
library(parsnip)
linear_reg() %>%
set_engine("lm")
lm_mod<-linear_reg() %>%
set_engine("lm")
lm_fit<- lm_mod %>%
fit(width ~ initial_volume*food_regime, data = sea_urchins)
lm_fit
tidy(lm_fit) %>% kable()
new_urchins <- expand.grid(initial_volume  = c(5,30),
food_regime = c("Initial", "Low", "High"))
new_urchins %>% kable()
new_preds <- predict(lm_fit, new_data = new_urchins)
conf_int_preds<-predict(lm_fit, new_data = new_urchins, type = "conf_int")
new_preds %>% kable()
conf_int_preds %>% kable()
combined_data <- new_urchins %>% cbind(new_preds) %>% cbind(conf_int_preds)
combined_data %>% kable()
ggplot(combined_data, aes(x = food_regime)) +
geom_point(aes(y = .pred)) +
geom_errorbar(aes(ymin = .pred_lower, ymax = .pred_upper),width = .2) +
labs(y = "urchin size")+theme_bw()
glmnet_mod<- linear_reg(mixture = 1) %>% #mixture specifies alpha parameter
set_engine("glmnet")
glmnet_mod
glmnet_fit <- glmnet_mod %>% fit(width ~ initial_volume*food_regime,
data = sea_urchins)
?glmnet_tidiers
?set_engine
glmnet_mod %>% translate()
glmnet_mod<- linear_reg(mixture = 1) %>% #mixture specifies alpha parameter
set_engine("glmnet")
glmnet_mod %>% translate()
glmnet_mod<- linear_reg(penalty = 1, mixture = 1) %>% #mixture specifies alpha parameter
set_engine("glmnet")
glmnet_fit <- glmnet_mod %>% fit(width ~ initial_volume*food_regime,
data = sea_urchins)
glmnet_fit <- glmnet_mod %>% fit(width ~ initial_volume*food_regime,
data = sea_urchins)
tidy(glmnet_fit, penalty = .004) #penalty selects particular value of lambda
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggrepel)
library(tidymodels)
ggplot(sea_urchins,
aes(x = initial_volume,
y = width,
group = food_regime,
col = food_regime)) +
geom_point() +
geom_smooth(method = lm, se = FALSE)+theme_bw()
library(parsnip)
linear_reg() %>%
set_engine("lm")
names(house)
house<-read.csv("data/house.csv") %>% relocate(SalePrice, Id)
names(house)
library(skimr)
house %>% skim(RoofMatl)
library(skimr)
house %>% skim(RoofMatl)
house %>% count(RoofMatl)
house %>% count(RoofMatl)
house %>% count(RoofMatl)
