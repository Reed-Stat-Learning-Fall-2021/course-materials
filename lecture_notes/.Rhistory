B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(slope = case_when(
slope == "A" ~ "0",
slope == "B" ~ "1",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-1",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(slope = case_when(
slope == "A" ~ "0",
slope == "B" ~ "1",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-1"
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(slope = case_when(
slope == "A" ~ "0",
slope == "B" ~ "1",
slope == "C" ~ "4",
slope == "D" ~ "-4",
slope == "E" ~ "-1"
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,-4,-1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,-1)
B<-logistic(t,1, -1)
C<-logistic(t,4,-1)
D<-logistic(t,-4,-1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of -1")
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,0,1)
B<-logistic(t,0,.5)
C<-logistic(t,0,4)
D<-logistic(t,0,-1)
E<-logistic(t,0,-4)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,-1)
B<-logistic(t,1, -1)
C<-logistic(t,4,-1)
D<-logistic(t,-4,-1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of -1")
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
library(skimr)
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(sex)
Titanic %>% count(survived)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+
geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+
geom_jitter(height = .01, alpha = .5)+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)
library(moderndive)
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age + sex")
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age*sex")
logreg2 <- glm(survived ~ age * sex, data = Titanic1, family = "binomial")
summary(logreg2)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,0,1)
B<-logistic(t,0,.5)
C<-logistic(t,0,4)
D<-logistic(t,0,-1)
E<-logistic(t,0,-4)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,-1)
B<-logistic(t,1, -1)
C<-logistic(t,4,-1)
D<-logistic(t,-4,-1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of -1")
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
library(skimr)
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(sex)
Titanic %>% count(survived)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+
geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+
geom_jitter(height = .01, alpha = .5)+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age + sex")
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age*sex")
simple_logreg <- glm(survived ~ age, data = Titanic1, family = "binomial")
summary(simple_logreg)
simple_logreg <- glm(survived ~ age, data = Titanic1, family = "binomial")
summary(simple_logreg)
logreg <- glm(survived ~ age + sex, data = Titanic1, family = "binomial")
summary(logreg)
logreg2 <- glm(survived ~ age * sex, data = Titanic1, family = "binomial")
summary(logreg2)
set.seed(1)
passengers<- data.frame(age = seq(10, 46, length.out = 10), sex = sample(c("male", "female"), size = 10, replace = T))
passengers
predict(logreg, passengers)
predict(logreg, passengers, type = "response")
ifelse(predict(logreg, passengers, type = "response") >= .5, 1, 0)
probs<-predict(logreg, Titanic1, type = "response")
preds<-ifelse(probs >=.5, 1, 0)
conf_log <- table(preds, Titanic1$survived)
conf_log
n <- length(Titanic1$survived)
false_pos <- conf_log[1,2]
false_neg <- conf_log[2,1]
error <- 1/n *(false_pos + false_neg)
error
library(yardstick)
install.packages("yardstick")
library(yardstick)
knitr::opts_chunk$set(
echo = FALSE,
fig.align = "center",
message = FALSE,
cache = F,
fig.width = 6,
fig.height = 4,
warning = FALSE,
out.width = "70%"
)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ISLR)
library(ggforce)
t <- seq(-10, 10, length = 100)
logistic <- function(x,a,b){exp(a + b*x)/(1 + exp(a + b*x))}
A<-logistic(t,0,1)
B<-logistic(t,0,.5)
C<-logistic(t,0,4)
D<-logistic(t,0,-1)
E<-logistic(t,0,-4)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "slope") %>%
mutate(slope = case_when(
slope == "A" ~ "1",
slope == "B" ~ "0.5",
slope == "C" ~ "4",
slope == "D" ~ "-1",
slope == "E" ~ "-4",
)) %>%
mutate(slope = fct_relevel(slope, "-4"))
ggplot(d, aes(x =t, y = value, color = slope))+geom_line()+theme_bw()+labs(title = "Effect of Slope, with constant intercept of 0")
A<-logistic(t,0,1)
B<-logistic(t,1, 1)
C<-logistic(t,4,1)
D<-logistic(t,-4,1)
E<-logistic(t,-1,1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of 1")
A<-logistic(t,0,-1)
B<-logistic(t,1, -1)
C<-logistic(t,4,-1)
D<-logistic(t,-4,-1)
E<-logistic(t,-1,-1)
d <- data.frame(t, A, B, C,D,E) %>% pivot_longer(!t, names_to = "intercept") %>%
mutate(intercept = case_when(
intercept == "A" ~ "0",
intercept == "B" ~ "1",
intercept == "C" ~ "4",
intercept == "D" ~ "-4",
intercept == "E" ~ "-1"
)) %>%
mutate(intercept = fct_relevel(intercept, "-4"))
ggplot(d, aes(x =t, y = value, color = intercept))+geom_line()+theme_bw()+labs(title = "Effect of Intercept, with constant slope of -1")
Titanic<-read_csv("data/titanic.csv")
glimpse(Titanic)
library(skimr)
Titanic %>% select(age, sex, survived) %>% summary()
Titanic %>% count(sex)
Titanic %>% count(survived)
library(tidyr)
Titanic1<-Titanic %>% drop_na(age)
Titanic1 %>% ggplot( aes( x = age, y = survived))+
geom_jitter(height = .01, alpha = .25)+theme_bw()
Titanic1 %>%  mutate(survived = as.factor(survived)) %>%
ggplot( aes( x = sex, fill = survived))+
geom_bar(position = "fill")+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex))+
geom_jitter(height = .01, alpha = .5)+theme_bw()
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)
Titanic1 %>% ggplot( aes( x = age, y = survived ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F,size = 2,linetype = "dashed") +
geom_smooth(method = "lm", se = F, color  = "red")
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_parallel_slopes(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age + sex")
library(moderndive)
Titanic1 %>% ggplot( aes( x = age, y = survived, color = sex ))+
geom_jitter(height = .01, alpha = .5)+theme_bw()+
geom_smooth(method = "glm", method.args = list(family = "binomial"), se = F)+
labs(title = "Logistic Regression, survival ~ age*sex")
simple_logreg <- glm(survived ~ age, data = Titanic1, family = "binomial")
summary(simple_logreg)
simple_logreg <- glm(survived ~ age, data = Titanic1, family = "binomial")
summary(simple_logreg)
logreg <- glm(survived ~ age + sex, data = Titanic1, family = "binomial")
summary(logreg)
logreg2 <- glm(survived ~ age * sex, data = Titanic1, family = "binomial")
summary(logreg2)
set.seed(1)
passengers<- data.frame(age = seq(10, 46, length.out = 10), sex = sample(c("male", "female"), size = 10, replace = T))
passengers
predict(logreg, passengers)
predict(logreg, passengers, type = "response")
ifelse(predict(logreg, passengers, type = "response") >= .5, 1, 0)
probs<-predict(logreg, Titanic1, type = "response")
preds<-ifelse(probs >=.5, 1, 0)
conf_log <- table(preds, Titanic1$survived)
conf_log
?accuracy_vec
accuracy_vec(truth = Titanic1$survived, estimate = preds)
accuracy_vec(truth = as.factor(Titanic1$survived), estimate = preds)
accuracy_vec(truth = as.factor(Titanic1$survived), estimate = as.factor(preds))
conf_mat(data.frame(Titanic1$survived, preds))
conf_mat(data.frame(Titanic1$survived, preds))
conf_mat(data.frame(Titanic1$survived, preds), Titanic1$survived, preds)
conf_mat(data.frame(t = Titanic1$survived, preds), t, preds)
length(Titanic1$survived)
length(preds)
d <- data.frame(truth = Titanic1$survived, preds)
conf_mat(d)
conf_mat(d, truth, preds)
?conf_mat
d <- tibble( truth = as.factor(Titanic1$survived), preds = as.factor(preds))
d
conf_mat(d)
conf_mat(d, truth, preds)
accuracy(d, truth, preds)
?predict.glm
probs<-predict(logreg, Titanic1, type = "response")
preds<-as.factor( ifelse(probs >=.5, 1, 0))
obs <- as.factor(Titanic1$survived)
results <- data.frame(obs, preds)
conf_mat(results, truth  = obs, estimate = preds)
1 - accuracy(results, truth = obs, estimate = preds)
1 - accuracy(results, truth = obs, estimate = preds)
accuracy(results, truth = obs, estimate = preds)
accuracy(results, truth = obs, estimate = preds) %>% pull()
?pull
accuracy(results, truth = obs, estimate = preds) %>% pull(.estimate)
accuracy(results, truth = obs, estimate = preds) %>% pull(.estimate)
1 -accuracy(results, truth = obs, estimate = preds) %>% pull(.estimate)
acc <- accuracy(results, truth = obs, estimate = preds) %>% pull(.estimate)
1 -acc
odds<- predict(logreg, passengers)
odds
probs <- predict(logreg, passengers, type = "response")
probs
ifelse(probs >= .5, 1, 0)
odds<- predict(logreg2, passengers)
odds
probs <- predict(logreg2, passengers, type = "response")
probs
ifelse(probs >= .5, 1, 0)
probs<-predict(logreg2, Titanic1, type = "response")
preds<-as.factor( ifelse(probs >=.5, 1, 0))
obs <- as.factor(Titanic1$survived)
results <- data.frame(obs, preds)
library(yardstick)
conf_mat(results, truth  = obs, estimate = preds)
accuracy(results, truth = obs, estimate = preds)
acc <- accuracy(results, truth = obs, estimate = preds) %>% pull(.estimate)
1 - acc
probs<-predict(logreg2, Titanic1, type = "response")
preds<-as.factor( ifelse(probs >=.5, 1, 0))
obs <- as.factor(Titanic1$survived)
results <- data.frame(obs, preds)
(308+44)/(82+199+308+44)
