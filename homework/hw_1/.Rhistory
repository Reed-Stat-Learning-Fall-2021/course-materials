knitr::opts_chunk$set(echo = TRUE)
X <- sample(10:100, replace = T, times = 100)
X <- sample(10:100, replace = T, size = 100)
set.seed(101)
X <- sample(10:100, replace = T, size = 100)
e <- rnorm(100, 0, 5)
Y <- (1/1000)*(X - 20)^2+5
plot(X,Y)
Y <- (1/1000)*(X - 20)^2+5+e
plot(X,Y)
set.seed(101)
X <- sample(10:100, replace = T, size = 100)
e <- rnorm(100, 0, 1)
Y <- (1/1000)*(X - 20)^2+5+e
plot(X,Y)
set.seed(101)
X <- sample(10:100, replace = T, size = 100)
e <- rnorm(100, 0, 1)
Y <- (1/500)*(X - 20)^2+5+e
plot(X,Y)
train <- tibble(X,Y)
set.seed(101)
X <- sample(10:100, replace = T, size = 100)
e <- rnorm(100, 0, 1)
Y <- (1/500)*(X - 20)^2+5+e
train <- tibble(X,Y)
library(tidyverse)
set.seed(101)
X <- sample(10:100, replace = T, size = 100)
e <- rnorm(100, 0, 1)
Y <- (1/500)*(X - 20)^2+5+e
train <- tibble(X,Y)
lin_mod <- lm(Y ~ X, data = train )
lin_mod <- lm(Y ~ X, data = train )
quad_mod <- lm(Y ~ poly(X, degree = 2), data = train)
quin_mod <- lm(Y ~ poly(X, degree = 4), data = train)
train %>% ggplot(aes(x = X, y = Y))+geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = Y~poly(X, degree = 2))+
geom_smooth(method = "lm", se = F,formula = Y~poly(X, degree = 5))
?geom_smooth
train %>% ggplot(aes(x = X, y = Y))+geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = Y~poly(X, 2))+
geom_smooth(method = "lm", se = F,formula = Y~poly(X, 5))
train %>% ggplot(aes(x = X, y = Y))+geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 5))
train %>% ggplot(aes(x = X, y = Y))+geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 7))
lin_mod <- lm(Y ~ X, data = train )
quad_mod <- lm(Y ~ poly(X, degree = 2), data = train)
quin_mod <- lm(Y ~ poly(X, degree = 7), data = train)
train %>% ggplot(aes(x = X, y = Y))+geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 7))
train %>% ggplot(aes(x = X, y = Y))+geom_point()+
geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 7))
set.seed(101)
X <- sample(10:100, replace = T, size = 60)
e <- rnorm(60, 0, 1)
Y <- (1/500)*(X - 20)^2+5+e
train <- tibble(X,Y)
lin_mod <- lm(Y ~ X, data = train )
quad_mod <- lm(Y ~ poly(X, degree = 2), data = train)
quin_mod <- lm(Y ~ poly(X, degree = 7), data = train)
train %>% ggplot(aes(x = X, y = Y))+geom_point()+
geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 7))
train %>% ggplot(aes(x = X, y = Y))+geom_point()+
geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 6))
train %>% ggplot(aes(x = X, y = Y))+geom_point()+
geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 5))
train %>% ggplot(aes(x = X, y = Y))+geom_point()+
geom_smooth(method = "lm", se = F)+
geom_smooth(method = "lm", se = F, formula = y~poly(x, 2))+
geom_smooth(method = "lm", se = F,formula = y~poly(x, 7))
set.seed(1511)
X <- sample(10:100, replace = T, size = 20)
e <- rnorm(20, 0, 1)
Y <- (1/500)*(X - 20)^2+5+e
test <- tibble(X,Y)
lin_mod <- lm(Y ~ X, data = train )
quad_mod <- lm(Y ~ poly(X, degree = 2), data = train)
sept_mod <- lm(Y ~ poly(X, degree = 7), data = train)
set.seed(1511)
X <- sample(10:100, replace = T, size = 20)
e <- rnorm(20, 0, 1)
Y <- (1/500)*(X - 20)^2+5+e
test <- tibble(X,Y)
lin_pred <- predict(lin_mod, test)
quad_pred <- predict(quad_mod, test)
sept_pred <- predict(sept_mod, test)
hw1_p5 <- data.frame(test, lin_pred, quad_pred, sept_pred)
View(hw1_p5)
ggplot(hw1_p5, aes(x = X, y= Y)) + geom_point(aes(y = lin_pred), color = "blue")
ggplot(hw1_p5, aes(x = X, y= Y)) + geom_point()+geom_point(aes(y = lin_pred), color = "blue")
ggplot(hw1_p5, aes(x = X, y= Y)) + geom_point()+geom_line(aes(y = lin_pred), color = "blue")
ggplot(hw1_p5, aes(x = X, y= Y)) + geom_point()+geom_line(aes(y = lin_pred), color = "blue")+geom_line(aes(x = quad_pred), color = "red")
ggplot(hw1_p5, aes(x = X, y= Y)) + geom_point()+geom_line(aes(y = lin_pred), color = "blue")+geom_line(aes(y = quad_pred), color = "red")
ggplot(hw1_p5, aes(x = X, y= Y)) + geom_point()+geom_line(aes(y = lin_pred), color = "blue")+geom_line(aes(y = quad_pred), color = "red")+geom_line(aes(y = sept_pred), color = "green")
hw1_p5 %>% summarize(
lin_mse = mean(lin_pred - Y)^2
)
hw1_p5 %>% summarize(
lin_mse = mean(lin_pred - Y)^2,
quad_mse = mean(quad_pred - Y)^2,
sept_mse = mean(sept_pred - Y)^2
)
write_csv(hw1_p5)
write_csv(hw1_p5, "hw1_p5.csv")
