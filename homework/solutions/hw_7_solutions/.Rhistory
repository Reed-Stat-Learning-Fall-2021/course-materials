geom_abline(slope = -br/bs, intercept = -b0/bs)
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = -br/bs, intercept = ( log(1/9) - b0 )/bs, color = "red") +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black", linetype = "dashed")+
scale_colour_gradient(low = "turquoise3", high = "salmon")
ggplot(wisc_train , aes( x = symmetry,  fill = class) )+geom_density( alpha = .5 )
ggplot(wisc_train)+geom_qq(aes(sample = symmetry))+facet_wrap(~class)
wisc_train %>% group_by(class) %>%
summarize(mean = mean(symmetry), var = var(symmetry), n = n())
symmetry_stats<-wisc_train %>% group_by(class) %>%
summarize(mean = mean(symmetry), var = var(symmetry), n = n()) %>%
mutate(prior = n/sum(n), ssx = var*(n-1) )
symmetry_stats
delta_f <- function(x, mu, sigma2, pi){
x*(mu/sigma2) - (mu^2 / (2*sigma2)) + log(pi)
}
mu_b<-symmetry_stats$mean[1]
mu_m<-symmetry_stats$mean[2]
pi_b<-symmetry_stats$prior[1]
pi_m<-symmetry_stats$prior[2]
sigma2<-symmetry_stats %>% summarize(S = sum(ssx), N = sum(n)) %>%
mutate(sigma2 = S/(N-2) ) %>% pull(3)
d_b<-delta_f(wisc_train$symmetry, mu_b, sigma2, pi_b)
d_m<-delta_f(wisc_train$symmetry, mu_m, sigma2, pi_m)
d<-data.frame(X = rep(wisc_train$symmetry, 2),
discriminant = c(d_b, d_m),
type = rep(c("B", "M"), each = length(wisc_train$symmetry)))
ggplot(d) + geom_line(aes(x = X, y = discriminant,color = type )) +
labs(x = "symmetry", y = "discriminant") +
scale_x_continuous(minor_breaks = seq( from = .1, to = .3, by = .01))
c<- (2*sigma2*log(pi_b/pi_m) + mu_m^2 - mu_b^2)/(2*(mu_m - mu_b))
c
c<- (mu_b + mu_m)/2 + (sigma2*(log(pi_m) - log(pi_b)))/(mu_b - mu_m)
c
c<- (mu_b + mu_m)/2 + (sigma2*(log(pi_m) - log(pi_b)))/(mu_b - mu_m)
c
wisc_preds<-ifelse(wisc_train$symmetry > c, "1", "0")
wisc_preds<- as.factor( ifelse(wisc_train$symmetry > c, "1", "0"))
wisc_results <- data.frame(obs = as.factor(wisc_train$class01), preds = wisc_preds)
conf_mat(wisc_results, truth = obs, estimate = preds)
accuracy(wisc_results, truth = obs, estimate = preds)
err <- 1 - pull(accuracy(wisc_results, truth = obs, estimate = preds), .estimate)
err
wisc_cov<-wisc_trainn %>% group_by(class) %>% summarize(var_r = var(radius), var_s = var(symmetry), cov_rs = cov(radius, symmetry), N = n(), mean_r = mean(radius), mean_s = mean(symmetry)) %>% data.frame()
wisc_cov<-wisc_train %>% group_by(class) %>% summarize(var_r = var(radius), var_s = var(symmetry), cov_rs = cov(radius, symmetry), N = n(), mean_r = mean(radius), mean_s = mean(symmetry)) %>% data.frame()
wisc_cov
mu_b2<-c(wisc_cov[1,6], wisc_cov[1,7])
mu_m2<-c(wisc_cov[2,6], wisc_cov[2,7])
cov_b<-matrix( c(wisc_cov[1,2], wisc_cov[1,4],
wisc_cov[1,4], wisc_cov[1,3]),
nrow = 2,
byrow = T)
cov_m<-matrix( c(wisc_cov[2,2], wisc_cov[2,4],
wisc_cov[2,4], wisc_cov[2,3]),
nrow = 2,
byrow = T)
cov_pool<-(cov_b*wisc_cov[1,5] + cov_m*wisc_cov[2,5])/( sum(wisc_cov[,5]) -2 )
cov_pool
cov_pool_inv<-solve(cov_pool)
RHS<-.5*t(mu_m2)%*%cov_pool_inv%*%mu_m2
-.5*t(mu_b2)%*%cov_pool_inv%*%mu_b2
+ log(pi_b)- log(pi_m)
RHS
LHS <- cov_pool_inv%*%(mu_m2 - mu_b2)
LHS
slope<- -LHS[1,1]/LHS[2,1]
slope
intercept = RHS/LHS[2,1]
intercept
## Red = LDA
## Black = Log Reg
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
## Red = LDA
## Black = Log Reg
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
## Red = LDA
## Black = Log Reg
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
slope<- -LHS[1,1]/LHS[2,1]
slope
intercept = RHS/LHS[2,1]
intercept
## Red = LDA
## Black = Log Reg
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
## Red = LDA
## Black = Log Reg
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ISLR)
data(Auto)
M<-median(Auto$mpg)
Auto<-Auto %>% mutate(mpg01 = ifelse(mpg > M, "1", "0"))
head(Auto)
library(GGally)
g<-ggpairs(Auto %>% dplyr::select(-name),
lower = list(continuous = wrap("points", alpha = 0.3, size=0.1)),
upper = list(combo = wrap("box_no_facet", alpha=0.25, outlier.size = .25),
continuous = wrap("cor", size=2)))
g
set.seed(1010)
Auto_train<-Auto %>% sample_frac(.75)
Auto_test<-Auto %>% anti_join(Auto_train)
library(MASS)
auto_lda<-lda(mpg01 ~ cylinders + displacement + horsepower + weight, data = Auto_train)
auto_pred<-predict(auto_lda, Auto_test)
conf_lda<-table(auto_pred$class, Auto_test$mpg01)
conf_lda
error_lda<-(sum(conf_lda) - sum(diag(conf_lda)))/sum(conf_lda)
error_lda
library(pROC)
lda_curve<-roc(response = Auto_test$mpg01, predictor = auto_pred$posterior[,1])
ggroc(lda_curve, legacy.axes = T)
library(MASS)
auto_qda<-qda(mpg01 ~ cylinders + displacement + horsepower + weight, data = Auto_train)
auto_pred_qda<-predict(auto_qda, Auto_test)
conf_qda<-table(auto_pred_qda$class, Auto_test$mpg01)
conf_qda
error_qda<-(sum(conf_qda) - sum(diag(conf_qda)))/sum(conf_qda)
error_qda
library(pROC)
qda_curve<-roc(response = Auto_test$mpg01, predictor = auto_pred_qda$posterior[,1])
ggroc(qda_curve, legacy.axes = T)
Auto_train<-Auto_train %>% mutate(mpg01 = as.numeric(mpg01))
auto_log_reg<-glm(mpg01 ~ cylinders + displacement + horsepower + weight,
data = Auto_train,
family = "binomial")
summary(auto_log_reg)
probs_log<-predict(auto_log_reg, Auto_test, type = "response")
auto_pred_log<-ifelse(probs_log >= 0.5, 1, 0)
conf_log<-table(auto_pred_log, Auto_test$mpg01)
conf_log
error_log<-(sum(conf_log) - sum(diag(conf_log)))/sum(conf_log)
error_log
library(pROC)
log_curve<-roc(response = Auto_test$mpg01, predictor = probs_log)
ggroc(log_curve, legacy.axes = T)
library(class)
knn_preds1 <- knn(
Auto_train %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_test %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_train$mpg01,
1
)
conf_knn1<-table(knn_preds1, Auto_test$mpg01)
conf_knn1
error_knn1<-(sum(conf_knn1) - sum(diag(conf_knn1)))/sum(conf_knn1)
error_knn1
library(class)
knn_preds5 <- knn(
Auto_train %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_test %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_train$mpg01,
5
)
conf_knn5<-table(knn_preds5, Auto_test$mpg01)
conf_knn5
error_knn5<-(sum(conf_knn5) - sum(diag(conf_knn5)))/sum(conf_knn5)
error_knn5
library(class)
knn_preds25 <- knn(
Auto_train %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_test %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_train$mpg01,
25
)
conf_knn25<-table(knn_preds25, Auto_test$mpg01)
conf_knn25
error_knn25<-(sum(conf_knn25) - sum(diag(conf_knn25)))/sum(conf_knn25)
error_knn25
wisc_trn<-read_csv("data/wisc-trn.csv")
wisc_tst<-read_csv("data/wisc-tst.csv")
wisc_trn <- wisc_trn %>% mutate(class01 = ifelse(class == "M", 1, 0 ))
wisc_tst <- wisc_tst %>% mutate(class01 = ifelse(class == "M", 1, 0 ))
wisc_log_reg<-glm(class01 ~ radius + symmetry, data = wisc_trn, family = "binomial")
summary(wisc_log_reg)$coefficients
b0<-summary(wisc_log_reg)$coefficients[1,1]
br<-summary(wisc_log_reg)$coefficients[2,1]
bs<-summary(wisc_log_reg)$coefficients[3,1]
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+geom_point() +
geom_abline(slope = -br/bs, intercept = -b0/bs)
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = -br/bs, intercept = ( log(1/9) - b0 )/bs, color = "red") +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black", linetype = "dashed")
ggplot(wisc_trn , aes( x = symmetry,  fill = class) )+geom_density( alpha = .5 )
ggplot(wisc_trn)+geom_qq(aes(sample = symmetry))+facet_wrap(~class)
wisc_trn %>% group_by(class) %>%
summarize(mean = mean(symmetry), var = var(symmetry), n = n())
symmetry_stats<-wisc_trn %>% group_by(class) %>%
summarize(mean = mean(symmetry), var = var(symmetry), n = n()) %>%
mutate(prior = n/sum(n), ssx = var*(n-1) )
symmetry_stats
delta_f <- function(x, mu, sigma2, pi){
x*(mu/sigma2) - (mu^2 / (2*sigma2)) + log(pi)
}
mu_b<-symmetry_stats$mean[1]
mu_m<-symmetry_stats$mean[2]
pi_b<-symmetry_stats$prior[1]
pi_m<-symmetry_stats$prior[2]
sigma2<-symmetry_stats %>% summarize(S = sum(ssx), N = sum(n)) %>%
mutate(sigma2 = S/(N-2) ) %>% pull(3)
d_b<-delta_f(wisc_trn$symmetry, mu_b, sigma2, pi_b)
d_m<-delta_f(wisc_trn$symmetry, mu_m, sigma2, pi_m)
d<-data.frame(X = rep(wisc_trn$symmetry, 2),
discriminant = c(d_b, d_m),
type = rep(c("B", "M"), each = length(wisc_trn$symmetry)))
ggplot(d) + geom_line(aes(x = X, y = discriminant,color = type )) +
labs(x = "symmetry", y = "discriminant") +
scale_x_continuous(minor_breaks = seq( from = .1, to = .3, by = .01))
c<- (2*sigma2*log(pi_b/pi_m) + mu_m^2 - mu_b^2)/(2*(mu_m - mu_b))
c
predics_wisc<-ifelse(wisc_trn$symmetry > c, "M", "B")
wisc_trn_conf<-table(predics_wisc,wisc_trn$class )
wisc_trn_conf
wisc_error<-(sum(wisc_trn_conf) - sum(diag(wisc_trn_conf)))/sum(wisc_trn_conf)
wisc_error
wisc_cov<-wisc_trn %>% group_by(class) %>% summarize(var_r = var(radius), var_s = var(symmetry), cov_rs = cov(radius, symmetry), N = n(), mean_r = mean(radius), mean_s = mean(symmetry)) %>% data.frame()
wisc_cov
mu_b2<-c(wisc_cov[1,6], wisc_cov[1,7])
mu_m2<-c(wisc_cov[2,6], wisc_cov[2,7])
cov_b<-matrix( c(wisc_cov[1,2], wisc_cov[1,4],
wisc_cov[1,4], wisc_cov[1,3]),
nrow = 2,
byrow = T)
cov_m<-matrix( c(wisc_cov[2,2], wisc_cov[2,4],
wisc_cov[2,4], wisc_cov[2,3]),
nrow = 2,
byrow = T)
cov_pool<-(cov_b*wisc_cov[1,5] + cov_m*wisc_cov[2,5])/( sum(wisc_cov[,5]) -2 )
cov_pool
cov_pool_inv<-solve(cov_pool)
RHS<-.5*t(mu_m2)%*%cov_pool_inv%*%mu_m2
-.5*t(mu_b2)%*%cov_pool_inv%*%mu_b2
+ log(pi_b)- log(pi_m)
RHS
LHS <- cov_pool_inv%*%(mu_m2 - mu_b2)
LHS
slope<- -LHS[1,1]/LHS[2,1]
slope
intercept = RHS/LHS[2,1]
intercept
## Red = LDA
## Black = Log Reg
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black", size = 5  )
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" , size = 2) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black", size = 1  )
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" , size = 4) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black", size = 1  )
## Red = LDA
## Black = Log Reg
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black")
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept-1, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black")
wisc_cov<-wisc_train %>% group_by(class) %>% summarize(var_r = var(radius), var_s = var(symmetry), cov_rs = cov(radius, symmetry), N = n(), mean_r = mean(radius), mean_s = mean(symmetry)) %>% data.frame()
wisc_cov
mu_b2<-c(wisc_cov[1,6], wisc_cov[1,7])
mu_m2<-c(wisc_cov[2,6], wisc_cov[2,7])
cov_b<-matrix( c(wisc_cov[1,2], wisc_cov[1,4],
wisc_cov[1,4], wisc_cov[1,3]),
nrow = 2,
byrow = T)
cov_m<-matrix( c(wisc_cov[2,2], wisc_cov[2,4],
wisc_cov[2,4], wisc_cov[2,3]),
nrow = 2,
byrow = T)
cov_pool<-(cov_b*wisc_cov[1,5] + cov_m*wisc_cov[2,5])/( sum(wisc_cov[,5]) -2 )
cov_pool
cov_pool_inv<-solve(cov_pool)
RHS<-.5*t(mu_m2)%*%cov_pool_inv%*%mu_m2
-.5*t(mu_b2)%*%cov_pool_inv%*%mu_b2
+ log(pi_b)- log(pi_m)
RHS
LHS <- cov_pool_inv%*%(mu_m2 - mu_b2)
LHS
slope<- -LHS[1,1]/LHS[2,1]
slope
intercept = RHS/LHS[2,1]
intercept
## Red = LDA
## Black = Log Reg
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept , color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black")
wisc_cov<-wisc_train %>% group_by(class) %>% summarize(var_r = var(radius), var_s = var(symmetry), cov_rs = cov(radius, symmetry), N = n(), mean_r = mean(radius), mean_s = mean(symmetry)) %>% data.frame()
wisc_cov
mu_b2<-c(wisc_cov[1,6], wisc_cov[1,7])
mu_m2<-c(wisc_cov[2,6], wisc_cov[2,7])
cov_b<-matrix( c(wisc_cov[1,2], wisc_cov[1,4],
wisc_cov[1,4], wisc_cov[1,3]),
nrow = 2,
byrow = T)
cov_m<-matrix( c(wisc_cov[2,2], wisc_cov[2,4],
wisc_cov[2,4], wisc_cov[2,3]),
nrow = 2,
byrow = T)
cov_pool<-(cov_b*wisc_cov[1,5] + cov_m*wisc_cov[2,5])/( sum(wisc_cov[,5]) - 2 )
cov_pool
cov_pool_inv<-solve(cov_pool)
LHS <- cov_pool_inv%*%(mu_m2 - mu_b2)
LHS
slope<- -LHS[1,1]/LHS[2,1]
slope
intercept = RHS/LHS[2,1]
intercept
## Red = LDA
## Black = Log Reg
wisc_test %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept-1 , color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black")
## Red = LDA
## Black = Log Reg
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ISLR)
data(Auto)
M<-median(Auto$mpg)
Auto<-Auto %>% mutate(mpg01 = ifelse(mpg > M, "1", "0"))
head(Auto)
library(GGally)
g<-ggpairs(Auto %>% dplyr::select(-name),
lower = list(continuous = wrap("points", alpha = 0.3, size=0.1)),
upper = list(combo = wrap("box_no_facet", alpha=0.25, outlier.size = .25),
continuous = wrap("cor", size=2)))
g
set.seed(1010)
Auto_train<-Auto %>% sample_frac(.75)
Auto_test<-Auto %>% anti_join(Auto_train)
library(MASS)
auto_lda<-lda(mpg01 ~ cylinders + displacement + horsepower + weight, data = Auto_train)
auto_pred<-predict(auto_lda, Auto_test)
conf_lda<-table(auto_pred$class, Auto_test$mpg01)
conf_lda
error_lda<-(sum(conf_lda) - sum(diag(conf_lda)))/sum(conf_lda)
error_lda
library(pROC)
lda_curve<-roc(response = Auto_test$mpg01, predictor = auto_pred$posterior[,1])
ggroc(lda_curve, legacy.axes = T)
library(MASS)
auto_qda<-qda(mpg01 ~ cylinders + displacement + horsepower + weight, data = Auto_train)
auto_pred_qda<-predict(auto_qda, Auto_test)
conf_qda<-table(auto_pred_qda$class, Auto_test$mpg01)
conf_qda
error_qda<-(sum(conf_qda) - sum(diag(conf_qda)))/sum(conf_qda)
error_qda
library(pROC)
qda_curve<-roc(response = Auto_test$mpg01, predictor = auto_pred_qda$posterior[,1])
ggroc(qda_curve, legacy.axes = T)
Auto_train<-Auto_train %>% mutate(mpg01 = as.numeric(mpg01))
auto_log_reg<-glm(mpg01 ~ cylinders + displacement + horsepower + weight,
data = Auto_train,
family = "binomial")
summary(auto_log_reg)
probs_log<-predict(auto_log_reg, Auto_test, type = "response")
auto_pred_log<-ifelse(probs_log >= 0.5, 1, 0)
conf_log<-table(auto_pred_log, Auto_test$mpg01)
conf_log
error_log<-(sum(conf_log) - sum(diag(conf_log)))/sum(conf_log)
error_log
library(pROC)
log_curve<-roc(response = Auto_test$mpg01, predictor = probs_log)
ggroc(log_curve, legacy.axes = T)
library(class)
knn_preds1 <- knn(
Auto_train %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_test %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_train$mpg01,
1
)
conf_knn1<-table(knn_preds1, Auto_test$mpg01)
conf_knn1
error_knn1<-(sum(conf_knn1) - sum(diag(conf_knn1)))/sum(conf_knn1)
error_knn1
library(class)
knn_preds5 <- knn(
Auto_train %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_test %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_train$mpg01,
5
)
conf_knn5<-table(knn_preds5, Auto_test$mpg01)
conf_knn5
error_knn5<-(sum(conf_knn5) - sum(diag(conf_knn5)))/sum(conf_knn5)
error_knn5
library(class)
knn_preds25 <- knn(
Auto_train %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_test %>% dplyr::select(cylinders, displacement, horsepower, weight),
Auto_train$mpg01,
25
)
conf_knn25<-table(knn_preds25, Auto_test$mpg01)
conf_knn25
error_knn25<-(sum(conf_knn25) - sum(diag(conf_knn25)))/sum(conf_knn25)
error_knn25
wisc_trn<-read_csv("data/wisc-trn.csv")
wisc_tst<-read_csv("data/wisc-tst.csv")
wisc_trn <- wisc_trn %>% mutate(class01 = ifelse(class == "M", 1, 0 ))
wisc_tst <- wisc_tst %>% mutate(class01 = ifelse(class == "M", 1, 0 ))
wisc_log_reg<-glm(class01 ~ radius + symmetry, data = wisc_trn, family = "binomial")
summary(wisc_log_reg)$coefficients
b0<-summary(wisc_log_reg)$coefficients[1,1]
br<-summary(wisc_log_reg)$coefficients[2,1]
bs<-summary(wisc_log_reg)$coefficients[3,1]
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+geom_point() +
geom_abline(slope = -br/bs, intercept = -b0/bs)
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = -br/bs, intercept = ( log(1/9) - b0 )/bs, color = "red") +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black", linetype = "dashed")
ggplot(wisc_trn , aes( x = symmetry,  fill = class) )+geom_density( alpha = .5 )
ggplot(wisc_trn)+geom_qq(aes(sample = symmetry))+facet_wrap(~class)
wisc_trn %>% group_by(class) %>%
summarize(mean = mean(symmetry), var = var(symmetry), n = n())
symmetry_stats<-wisc_trn %>% group_by(class) %>%
summarize(mean = mean(symmetry), var = var(symmetry), n = n()) %>%
mutate(prior = n/sum(n), ssx = var*(n-1) )
symmetry_stats
delta_f <- function(x, mu, sigma2, pi){
x*(mu/sigma2) - (mu^2 / (2*sigma2)) + log(pi)
}
mu_b<-symmetry_stats$mean[1]
mu_m<-symmetry_stats$mean[2]
pi_b<-symmetry_stats$prior[1]
pi_m<-symmetry_stats$prior[2]
sigma2<-symmetry_stats %>% summarize(S = sum(ssx), N = sum(n)) %>%
mutate(sigma2 = S/(N-2) ) %>% pull(3)
d_b<-delta_f(wisc_trn$symmetry, mu_b, sigma2, pi_b)
d_m<-delta_f(wisc_trn$symmetry, mu_m, sigma2, pi_m)
d<-data.frame(X = rep(wisc_trn$symmetry, 2),
discriminant = c(d_b, d_m),
type = rep(c("B", "M"), each = length(wisc_trn$symmetry)))
ggplot(d) + geom_line(aes(x = X, y = discriminant,color = type )) +
labs(x = "symmetry", y = "discriminant") +
scale_x_continuous(minor_breaks = seq( from = .1, to = .3, by = .01))
c<- (2*sigma2*log(pi_b/pi_m) + mu_m^2 - mu_b^2)/(2*(mu_m - mu_b))
c
predics_wisc<-ifelse(wisc_trn$symmetry > c, "M", "B")
wisc_trn_conf<-table(predics_wisc,wisc_trn$class )
wisc_trn_conf
wisc_error<-(sum(wisc_trn_conf) - sum(diag(wisc_trn_conf)))/sum(wisc_trn_conf)
wisc_error
wisc_cov<-wisc_trn %>% group_by(class) %>% summarize(var_r = var(radius), var_s = var(symmetry), cov_rs = cov(radius, symmetry), N = n(), mean_r = mean(radius), mean_s = mean(symmetry)) %>% data.frame()
wisc_cov
mu_b2<-c(wisc_cov[1,6], wisc_cov[1,7])
mu_m2<-c(wisc_cov[2,6], wisc_cov[2,7])
cov_b<-matrix( c(wisc_cov[1,2], wisc_cov[1,4],
wisc_cov[1,4], wisc_cov[1,3]),
nrow = 2,
byrow = T)
cov_m<-matrix( c(wisc_cov[2,2], wisc_cov[2,4],
wisc_cov[2,4], wisc_cov[2,3]),
nrow = 2,
byrow = T)
cov_pool<-(cov_b*wisc_cov[1,5] + cov_m*wisc_cov[2,5])/( sum(wisc_cov[,5]) -2 )
cov_pool
cov_pool_inv<-solve(cov_pool)
RHS<-.5*t(mu_m2)%*%cov_pool_inv%*%mu_m2
-.5*t(mu_b2)%*%cov_pool_inv%*%mu_b2
+ log(pi_b)- log(pi_m)
RHS
LHS <- cov_pool_inv%*%(mu_m2 - mu_b2)
LHS
slope<- -LHS[1,1]/LHS[2,1]
slope
intercept = RHS/LHS[2,1]
intercept
## Red = LDA
## Black = Log Reg
wisc_tst %>% ggplot(aes( x = radius, y  = symmetry, color = class01))+
geom_point() +
geom_abline(slope = slope, intercept = intercept, color = "red" ) +
geom_abline(slope = -br/bs, intercept = -b0/bs, color = "black"  )
