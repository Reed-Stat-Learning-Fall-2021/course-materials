knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
house<-read_csv("house_train.csv")
house_split <- initial_split(house)
library(rsample)
house_split <- initial_split(house)
house_train <- training(house_split)
house_test <- testing(house_split)
house_train_mm <- model.matrix(Sale_Price ~., data = house_train)
house_test_mm <- model.matrix(Sale_Price ~., data = house_test)
?ncol
ncol(house_test_mm)
ncol(house_train_mm)
house_test_mm <- model.matrix(Sale_Price ~., data = house_test)
ncol(house_test_mm)
house_train_mm <- model.matrix(Sale_Price ~., data = house_train)
ncol(house_train_mm)
set.seed(10)
library(rsample)
house_split <- initial_split(house)
house_train <- training(house_split)
house_test <- testing(house_split)
house_train_mm <- model.matrix(Sale_Price ~., data = house_train)
ncol(house_train_mm)
house_test_mm <- model.matrix(Sale_Price ~., data = house_test)
ncol(house_test_mm)
house_full_mm <- model.matrix(~., data = house)
house_full_mm <- model.matrix(~., data = house)[,-1]
house_train_mm <- model.matrix(Sale_Price ~., data = house_train)[,-1]
ncol(house_train_mm)
house_test_mm <- model.matrix(Sale_Price ~., data = house_test)[,-1]
ncol(house_test_mm)
house_full_split <- initial_split(house_full_df)
house_full_df <- as.data.frame(house_full_mm)
house_full_split <- initial_split(house_full_df)
house_train <- training(house_full_split)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
house<-read_csv("house_train.csv")
set.seed(10)
library(rsample)
house_split <- initial_split(house)
house_train <- training(house_split)
house_test <- testing(house_split)
house_train_mm <- model.matrix(Sale_Price ~., data = house_train)[,-1]
ncol(house_train_mm)
house_test_mm <- model.matrix(Sale_Price ~., data = house_test)[,-1]
ncol(house_test_mm)
house_full_mm <- model.matrix(~., data = house)[,-1]
house_full_df <- as.data.frame(house_full_mm)
house_full_split <- initial_split(house_full_df)
house_train <- training(house_full_split)
house_test <- testing(house_full_split)
house_full_df <- as.data.frame(house_full_mm)
house_full_split <- initial_split(house_full_df)
house_train <- training(house_full_split)
house_test <- testing(house_full_split)
set.seed(10)
house_full_df <- as.data.frame(house_full_mm)
house_full_split <- initial_split(house_full_df)
house_train <- training(house_full_split)
house_test <- testing(house_full_split)
house_test_mm <-model.matrix(Sale_Price~., data = house_test)
y_train <- house_test$Sale_Price
house_train_mm <- model.matrix(Sale_Price~., data = house_train)
y_train <- house_train$Sale_Price
house_test_mm <-model.matrix(Sale_Price~., data = house_test)
y_test <- house_test$Sale_Price
ncol(house_train_mm)
ncol(house_test_mm)
house_train_mm <- model.matrix(Sale_Price~., data = house_train)[,-1]
y_train <- house_train$Sale_Price
house_test_mm <-model.matrix(Sale_Price~., data = house_test)[,-1]
y_test <- house_test$Sale_Price
ncol(house_train_mm)
ncol(house_test_mm)
library(glmnet)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0)
grid <- 10^seq(-5, 10, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
library(glmnet)
grid <- 10^seq(-5, 10, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
library(glmnet)
grid <- 10^seq(-5, 10, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_mod)
plot(lasso_mod)
library(glmnet)
grid <- 10^seq(-5, 10, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
library(broom)
tidied_ridge <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied_ridge, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
library(broom)
tidied_ridge <- tidy(ridge_mod) %>% filter(term != "(Intercept)")
ggplot(tidied_ridge, aes(lambda, estimate, group = term, color = term)) +
geom_line() + scale_x_log10()+ theme_bw()+labs(title = "Coefficent estimates")
?plot.glmnet
plot(ridge_mod, xvar = "lambda")
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
library(glmnet)
grid <- 10^seq(-5, 5, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
library(glmnet)
grid <- 10^seq(-5, 10, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
library(glmnet)
grid <- 10^seq(-5, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_cv)
plot(lasso_cv)
library(glmnet)
grid <- 10^seq(-2, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_cv)
plot(lasso_cv)
library(glmnet)
grid <- 10^seq(0, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
plot(ridge_cv)
plot(lasso_cv)
library(glmnet)
grid <- 10^seq(-5, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
library(glmnet)
grid <- 10^seq(-5, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1 )
library(glmnet)
grid <- 10^seq(-5, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0  )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1 )
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid)
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid)
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0 )
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1 )
plot(ridge_cv)
plot(lasso_cv)
library(glmnet)
grid <- 10^seq(-5, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
library(glmnet)
grid <- 10^seq(-2, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
library(glmnet)
grid <- 10^seq(-2, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
library(glmnet)
grid <- 10^seq(-2, 6, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
library(glmnet)
grid <- 10^seq(-2, 8, length = 100)
ridge_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_mod<-glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_mod, xvar = "lambda")
plot(lasso_mod, xvar = "lambda")
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0 )
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1 )
set.seed(100)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_cv)
plot(lasso_cv)
plot(ridge_cv)
plot(lasso_cv)
set.seed(1000)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_cv)
plot(lasso_cv)
set.seed(19)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_cv)
plot(lasso_cv)
set.seed(111)
ridge_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 0, lambda = grid )
lasso_cv <- cv.glmnet(x = house_train_mm, y = y_train, alpha = 1, lambda = grid  )
plot(ridge_cv)
plot(lasso_cv)
Test MSE is minimized for ridge regression at `{r} ridge_cv$lambda.min`
Test MSE is minimized for ridge regression at `{r} ridge_cv$lambda.min`
Test MSE is minimized for ridge regression at `{r} ridge_cv$lambda.min` and for lasso at `{r} lasso_cv$lambda.min`
ridge_cv$lambda.min
lasso_cv$lambda.min
s_rr <- which(lasso_mod$lambda == ridge_cv$lambda.min)
sum(coef(ridge_mod)[,s_rr]!=0)
s_rr <- which(ridge_mod$lambda == ridge_cv$lambda.min)
sum(coef(ridge_mod)[,s_rr]!=0)
s_lasso <- which(lasso_mod$lambda == lasso_cv$lambda.min)
sum(coef(lasso_mod)[,s_rr]!=0)
197 - n_nonzero_rr
s_rr <- which(ridge_mod$lambda == ridge_cv$lambda.min)
n_nonzero_rr <- sum(coef(ridge_mod)[,s_rr]!=0)
n_nonzero_rr
s_lasso <- which(lasso_mod$lambda == lasso_cv$lambda.min)
n_nonzero_lasso <- sum(coef(lasso_mod)[,s_rr]!=0)
n_nonzero_lasso
197 - n_nonzero_rr
n_nonzero_lasso
preds_rr <- predict(ridge_mod, s = s_rr)
preds_rr <- predict(ridge_mod, s = s_rr, newx = house_test_mm
?predict.glmnet
preds_rr <- predict(ridge_mod, s = ridge_cv$lambda.min, newx = house_test_mm)
preds_lasso <- predict(lasso_mod, s = lambda_cv$lambda.min, newx = house_test_mm)
preds_rr <- predict(ridge_mod, s = ridge_cv$lambda.min, newx = house_test_mm)
preds_lasso <- predict(lasso_mod, s = lasso_cv$lambda.min, newx = house_test_mm)
ridge_cv$lambda.min
library(yardstick)
?yardstick
vignette(package = "yardstick")
vignette("metric-types")
preds <- data.frame(ridge_regression = preds_rr, lasso = preds_lasso) %>% rownames_to_column()
View(preds)
preds <- data.frame(ridge_regression = preds_rr, lasso = preds_lasso) %>% rownames_to_column(var = "observation") %>% pivot_longer(!observation, names_to = "model", values_to = "prediction")
results <- data.frame(ridge_regression = preds_rr, lasso = preds_lasso, observed = y_test ) %>% rownames_to_column(var = "id") %>% pivot_longer(!observation, names_to = "model", values_to = "prediction")
results <- data.frame(ridge_regression = preds_rr, lasso = preds_lasso, observed = y_test ) %>% rownames_to_column(var = "id") %>% pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
View(results)
preds_lasso
results <- data.frame(ridge_regression = as.numeric(preds_rr), lasso = preds_lasso, observed = y_test ) %>% rownames_to_column(var = "id") %>% pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
results <- data.frame(ridge_regression = as.numeric(preds_rr), lasso = as.numeric(preds_lasso), observed = y_test ) %>% rownames_to_column(var = "id") %>% pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
View(results)
preds %>% group_by(model) %>% rmse(truth = observed, estimate = prediction)
results <- data.frame(ridge_regression = as.numeric(preds_rr), lasso = as.numeric(preds_lasso), observed = y_test ) %>% rownames_to_column(var = "id") %>% pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
library(yardstick)
preds %>% group_by(model) %>% rmse(truth = observed, estimate = prediction)
results <- data.frame(ridge_regression = as.numeric(preds_rr), lasso = as.numeric(preds_lasso), observed = y_test ) %>% rownames_to_column(var = "id") %>% pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
library(yardstick)
results %>% group_by(model) %>% rmse(truth = observed, estimate = prediction)
full_mod <- lm(Sale_Price ~., data = house_train)
full_preds <- predict(full_mod, house_test)
full_mod <- lm(Sale_Price ~., data = house_train)
full_preds <- predict(full_mod, house_test)
results <- data.frame(
ridge_regression = as.numeric(preds_rr),
lasso = as.numeric(preds_lasso),
full = as.numeric(full_preds),
observed = y_test ) %>%
rownames_to_column(var = "id") %>%
pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
library(yardstick)
results %>% group_by(model) %>% rmse(truth = observed, estimate = prediction)
best_mod <- lm(Sale_Price ~ Lot_Frontage + Lot_Area + Year_Built + Year_Remod_Add +
Mas_Vnr_Area + BsmtFin_SF_2 + Bsmt_Unf_SF + Total_Bsmt_SF +
Gr_Liv_Area + Bedroom_AbvGr + Kitchen_AbvGr + Garage_Area +
Wood_Deck_SF + Screen_Porch + Latitude, data = house_train)
best_preds <- predict(best_mod, house_test)
results <- data.frame(
ridge_regression = as.numeric(preds_rr),
lasso = as.numeric(preds_lasso),
full = as.numeric(full_preds),
best_subset = as.numeric(best_preds),
observed = y_test ) %>%
rownames_to_column(var = "id") %>%
pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
full_mod <- lm(Sale_Price ~., data = house_train)
full_preds <- predict(full_mod, house_test)
best_mod <- lm(Sale_Price ~ Lot_Frontage + Lot_Area + Year_Built + Year_Remod_Add +
Mas_Vnr_Area + BsmtFin_SF_2 + Bsmt_Unf_SF + Total_Bsmt_SF +
Gr_Liv_Area + Bedroom_AbvGr + Kitchen_AbvGr + Garage_Area +
Wood_Deck_SF + Screen_Porch + Latitude, data = house_train)
best_preds <- predict(best_mod, house_test)
results <- data.frame(
ridge_regression = as.numeric(preds_rr),
lasso = as.numeric(preds_lasso),
full = as.numeric(full_preds),
best_subset = as.numeric(best_preds),
observed = y_test ) %>%
rownames_to_column(var = "id") %>%
pivot_longer(!c("id", "observed"), names_to = "model", values_to = "prediction")
library(yardstick)
results %>% group_by(model) %>% rmse(truth = observed, estimate = prediction)
results %>% group_by(model) %>%
rmse(truth = observed, estimate = prediction) %>%
arrange(.estimate)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
-2.05-1.91*0+.02*2-.07*1+2.66*0
log_odds <- -2.05-1.91*0+.02*2-.07*1+2.66*0
log_odds
prob <- exp(log_odds)/(1 + exp(log_odds))
prob
log_odds <- -2.05-1.91*0+.02*2-.07*1+2.66*0
prob <- exp(log_odds)/(1 + exp(log_odds))
prob
log_odds <- -2.05-1.91*0+.02*2-.07*1+2.66*0
log_odds
prob <- exp(log_odds)/(1 + exp(log_odds))
prob
2.12/.02
.37/1.37
.16/.84
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
log_odds <- -2.05-1.91*0+.02*2-.07*1+2.66*0
log_odds
prob <- exp(log_odds)/(1 + exp(log_odds))
prob
war <- read.csv("http://www.stat.cmu.edu/~cshalizi/uADA/15/hw/06/ch.csv", row.names = 1)
cw_log_reg <- glm(start ~. -country -year + I(exports^2),
data = war, family = "binomial")
summary(cw_log_reg)$coefficients
India75 <- war %>% filter(country == "India", year == "1975")
predict(cw_log_reg, India75, type = "response")
India75_school <- war %>% filter(country == "India", year == "1975") %>%
mutate(schooling = schooling + 30)
predict(cw_log_reg, India75_school, type = "response")
India75_exports <- war %>% filter(country == "India", year == "1975") %>%
mutate(schooling = exports + .1)
predict(cw_log_reg, India75_exports, type = "response")
Nigeria65 <- war %>% filter(country == "Nigeria", year == "1965")
predict(cw_log_reg, Nigeria65, type = "response")
Nigeria65_school <- war %>% filter(country == "Nigeria", year == "1965") %>%
mutate(schooling = schooling + 30)
predict(cw_log_reg, Nigeria65_school, type = "response")
Nigeria65_exports <- war %>% filter(country == "Nigeria", year == "1965") %>%
mutate(schooling = exports + 0.1)
predict(cw_log_reg, Nigeria65_exports, type = "response")
war_no_na <- war %>% drop_na()
cw_probs<-predict(cw_log_reg, war_no_na, type = "response")
cw_preds<-ifelse(cw_probs >= 0.5, "Up", "Down")
cw_results <- data.frame()
cw_conf
cw_results <- data.frame(obs = war_no_na$start, preds = cw_preds, probs = cw_probs)
cw_results
war
war_no_na <- war %>% drop_na()
cw_probs<-predict(cw_log_reg, war_no_na, type = "response")
cw_preds<-ifelse(cw_probs >= 0.5, "1", "0")
cw_results <- data.frame(obs = war_no_na$start, preds = cw_preds, probs = cw_probs)
cw_results
library(yardstick)
conf_mat(cw_results, truth = obs, estimate = preds)
cw_results <- data.frame(obs = as.factor(war_no_na$start), preds = cw_preds, probs = cw_probs)
conf_mat(cw_results, truth = obs, estimate = preds)
war_no_na <- war %>% drop_na()
cw_probs<-predict(cw_log_reg, war_no_na, type = "response")
cw_preds<-ifelse(cw_probs >= 0.5, "1", "0")
library(yardstick)
cw_results <- data.frame(obs = as.factor(war_no_na$start), preds = cw_preds, probs = cw_probs)
conf_mat(cw_results, truth = obs, estimate = preds)
cw_results %>% accuracy(truth = obs, estimate = preds)
cw_results %>% accuracy(truth = obs, estimate = preds) %>% pull(.estimate)
1- acc
acc <- cw_results %>% accuracy(truth = obs, estimate = preds) %>% pull(.estimate)
1- acc
1- acc
mean(war$start == 1, na.rm = T)
mean(war_no_na$start == 1, na.rm = T)
r <- roc_curve(cw_results, truth = obs, estimate = prob, )
?roc_curve
mean(war$start == 1, na.rm = T, event_level = "second")
r <- roc_curve(cw_results, truth = obs, estimate = probs, event_level = "second" )
autoplot(r)
?auc
?auc_roc
roc_auc(r)
roc_auc(cw_results, truth = obs, estimate = probs, event_level = "second")
roc_auc()
?roc_auc
View(cw_results)
r <- roc_curve(cw_results, truth = obs, estimate = probs, event_level = "second" )
autoplot(r)
roc_auc(cw_results, truth = obs, estimate = probs, event_level = "second")
roc_auc(cw_results, truth = obs, estimate = probs)
roc_auc(cw_results, truth = obs, estimate = preds)
roc_auc(cw_results, truth = obs, estimate = preds)
roc_auc(cw_results, truth = obs, estimate = probs)
r <- roc_curve(cw_results, truth = obs, estimate = probs, event_level = "second" )
autoplot(r)
roc_auc(cw_results, truth = obs, estimate = probs)
roc_auc(cw_results, truth = obs, estimate = probs, event_level = "second")
roc_auc(data = cw_results, truth = obs, estimate = probs, event_level = "second")
war_no_na <- war %>% drop_na()
cw_probs<-predict(cw_log_reg, war_no_na, type = "response")
cw_preds<-ifelse(cw_probs >= 0.5, "1", "0")
library(yardstick)
cw_results <- data.frame(obs = as.factor(war_no_na$start), preds = cw_preds, probs = cw_probs)
conf_mat(cw_results, truth = obs, estimate = preds)
acc <- cw_results %>% accuracy(truth = obs, estimate = preds) %>% pull(.estimate)
1- acc
acc <- cw_results %>% accuracy(truth = obs, estimate = preds) %>% pull(.estimate)
1- acc
mean(war$start == 1, na.rm = T)
mean(war_no_na$start == 1, na.rm = T)
mean(war_no_na$start == 1, na.rm = T)
r <- roc_curve(cw_results, truth = obs, estimate = probs, event_level = "second" )
autoplot(r)
roc_auc(data = cw_results, truth = obs, estimate = probs, event_level = "second")
roc_auc(data = cw_results, truth = obs, probs, event_level = "second")
roc_auc(data = cw_results, truth = obs, estimate = probs, event_level = "second")
r <- roc_curve(cw_results, truth = obs, estimate = probs, event_level = "second" )
autoplot(r)
roc_auc(data = cw_results, truth = obs, probs, event_level = "second")
