results_OJ <- data.frame(obs = OJ_test$Purchase, preds = OJ_preds, probs = OJ_probs)
conf_mat(results, truth = obs, estimate = preds)
acc <- accuracy(results, truth = obs, estimate = preds) %>% pull(.estimate)
1-acc
accuracy(results, truth = obs, estimate = preds)
OJ_preds <- predict(OJ_tree, OJ_test, type = "class")
OJ_probs <- predict(OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- data.frame(obs = OJ_test$Purchase, preds = OJ_preds, probs = OJ_probs)
conf_mat(results, truth = obs, estimate = preds)
acc <- accuracy(results_OJ, truth = obs, estimate = preds) %>% pull(.estimate)
1-acc
pruned_OJ_tree <- prune(OJ_tree, cp = 0.0015)
rpart.plot(pruned_OJ_tree)
pruned_OJ_tree <- prune(OJ_tree, cp = 0.0015)
rpart.plot(pruned_OJ_tree)
pruned_OJ_tree <- prune(OJ_tree, cp = 0.015)
rpart.plot(pruned_OJ_tree)
printcp(pruned_OJ_tree)
printcp(pruned_OJ_tree)
new_OJ_preds <- predict(pruned_OJ_tree, OJ_test, type = "class")
new_OJ_probs <- predict(pruned_OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- results_OJ %>% mutate(model = "full tree") %>%
rbind(data.frame(obs = OJ_test$Purchase,
preds = new_OJ_preds,
probs = new_OJ_probs,
model = "pruned tree"))
results_OJ %>% group_by(model) %>%  accuracy(truth = obs, estimate = preds)
set.seed(10)
library(rsample)
OJ_initial <- initial_split(OJ, strata = Purchase)
OJ_train <- training(OJ_initial)
OJ_test <- testing(OJ_initial)
library(rpart)
OJ_tree <- rpart(Purchase ~., data = OJ_train, control = rpart.control(cp = 0))
library(rpart.plot)
rpart.plot(OJ_tree)
printcp(OJ_tree)
0.38979*0.32907
OJ_preds <- predict(OJ_tree, OJ_test, type = "class")
OJ_probs <- predict(OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- data.frame(obs = OJ_test$Purchase, preds = OJ_preds, probs = OJ_probs)
conf_mat(results, truth = obs, estimate = preds)
acc <- accuracy(results_OJ, truth = obs, estimate = preds) %>% pull(.estimate)
1-acc
plotcp(OJ_tree, upper = "splits")
pruned_OJ_tree <- prune(OJ_tree, cp = 0.011)
rpart.plot(pruned_OJ_tree)
printcp(pruned_OJ_tree)
new_OJ_preds <- predict(pruned_OJ_tree, OJ_test, type = "class")
new_OJ_probs <- predict(pruned_OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- results_OJ %>% mutate(model = "full tree") %>%
rbind(data.frame(obs = OJ_test$Purchase,
preds = new_OJ_preds,
probs = new_OJ_probs,
model = "pruned tree"))
results_OJ %>% group_by(model) %>%  accuracy(truth = obs, estimate = preds)
library(ISLR2)
data("College")
College_initial <- initial_split(College)
College_test <- testing(College)
College_initial <- initial_split(College)
College_train <- training(College)
College_initial <- initial_split(College)
College_train <- training(College_initial)
College_test <- testing(College_initial)
college_lm <- lm(Outstate ~ ., data = College_train)
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-2, 10, length = 100)
college_lasso <- glmnet(x_train, y_train, lambda = grid)
plot(college_lasso)
college_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
plot(college_lasso)
coef(college_lasso)
plot.glmnet(college_lasso)
library(glmnet)
plot.glmnet(college_lasso)
?plot.glmnet
plot(college_lasso, xvar = lambda)
plot(college_lasso, xvar = "lambda")
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-5, 5, length = 100)
college_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
plot(college_lasso, xbar = "lambda")
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-5, 5, length = 100)
college_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
plot(college_lasso, xbar = "lambda")
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-5, 5, length = 100)
college_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
plot(college_lasso, xvar = "lambda")
tidy_lasso <- tidy(college_lasso)
names(college_lasso)
head(tidy_lasso)
tidy_lasso <- tidy(college_lasso) %>% select(-Intercept)
tidy_lasso <- tidy(college_lasso) %>% filter(term != "Intercept")
college_lasso %>% ggplot(aes(x = lambda, y = beta))
head(tidy_lasso)
tidy_lasso <- tidy(college_lasso) %>% filter(term != "(Intercept)")
head(tidy_lasso)
college_lasso %>% ggplot(aes(x = lambda, y = beta, color = term))+geom_line()
library(broom)
tidy_lasso <- tidy(college_lasso) %>% filter(term != "(Intercept)")
tidy_lasso %>% ggplot(aes(x = lambda, y = beta, color = term))+geom_line()
head(tidy_lasso)
library(broom)
tidy_lasso <- tidy(college_lasso) %>% filter(term != "(Intercept)")
tidy_lasso %>% ggplot(aes(x = lambda, y = estimate, color = term))+geom_line()
tidy_lasso %>% ggplot(aes(x = lambda, y = estimate, color = term))+geom_line()+theme_bw()
?College
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-5, 5, length = 100)
college_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
#grid <- 10^seq(-5, 5, length = 100)
college_lasso <- glmnet(x_train, y_train,  alpha = 1)
library(broom)
tidy_lasso <- tidy(college_lasso) %>% filter(term != "(Intercept)")
tidy_lasso %>% ggplot(aes(x = lambda, y = estimate, color = term))+geom_line()+theme_bw()
tidy_lasso %>% ggplot(aes(x = lambda, y = estimate, color = term))+geom_line()+theme_bw()+scale_x_log10()
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-5, 5, length = 100)
college_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
library(broom)
tidy_lasso <- tidy(college_lasso) %>% filter(term != "(Intercept)")
tidy_lasso %>% ggplot(aes(x = lambda, y = estimate, color = term))+geom_line()+theme_bw()+scale_x_log10()
College_lasso_cv <- cv.glmnet(x_train, y_train)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.min
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.min
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
set.seed(1)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
college_preds_lm <- predict(college_lm, College_test)
y_test <- College_test$Outstate
x_test <- model.matrix(Outstate ~., data = College_test)
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
library(glmnet)
x_train <- model.matrix(Outstate ~ ., data = College_train)[,-1]
y_train <- College_train$Outstate
grid <- 10^seq(-5, 5, length = 100)
College_lasso <- glmnet(x_train, y_train, lambda = grid, alpha = 1)
library(broom)
tidy_lasso <- tidy(College_lasso) %>% filter(term != "(Intercept)")
tidy_lasso %>% ggplot(aes(x = lambda, y = estimate, color = term))+geom_line()+theme_bw()+scale_x_log10()
x_test <- model.matrix(Outstate ~., data = College_test)
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
?predict.glmnet
x_test <- model.matrix(Outstate ~., data = College_test)[,-1]
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
College_knn_tune <- train.kknn(Outstate~., data = College_train, kmax = 40, kernel = "rectangular")
library(kknn)
College_knn_tune <- train.kknn(Outstate~., data = College_train, kmax = 40, kernel = "rectangular")
as.data.frame(College_knn_tune$MISCLASS) %>%
rownames_to_column(var = "k") %>%
mutate(error = rectangular, k = as.numeric(k)) %>%
ggplot( aes(x = k, y = error))+geom_point()+geom_smooth(se = F)+theme_bw()
library(kknn)
College_knn_tune <- train.kknn(Outstate~., data = College_train, kmax = 40, kernel = "rectangular")
as.data.frame(College_knn_tune$MISCLASS) %>%
rownames_to_column(var = "k") %>%
mutate(error = rectangular, k = as.numeric(k)) %>%
ggplot( aes(x = k, y = error))+geom_point()+geom_smooth(se = F)+theme_bw()
College_knn_tune
College_knn_tune$MEAN.SQU
as.data.frame(College_knn_tune$MEAN.SQU) %>%
rownames_to_column(var = "k") %>%
mutate(error = rectangular, k = as.numeric(k)) %>%
ggplot( aes(x = k, y = error))+geom_point()+geom_smooth(se = F)+theme_bw()
ollege_knn_tune$best.parameters
best_k <- College_knn_tune$best.parameters
best_k
best_k <- College_knn_tune$best.parameters$k
best_k
college_preds_knn <- kknn(Outstate ~., train = College_train, test = College_test, k = best_k, kernel = "rectangular")
college_preds_knn
college_preds_knn$fitted.values
college_preds_knn <- kknn(Outstate ~., train = College_train, test = College_test, k = best_k, kernel = "rectangular")$fitted.values
college_preds_knn
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = 0))
plotcp(College_tree)
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .001))
plotcp(College_tree)
College_tree$cptable
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .005))
plotcp(College_tree)
best_cp <-
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .005))
plotcp(College_tree)
best_cp <- 0.013
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .002))
plotcp(College_tree)
best_cp <- 0.013
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .001))
plotcp(College_tree)
best_cp <- 0.013
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .001))
plotcp(College_tree)
best_cp <- 0.005
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .001))
plotcp(College_tree)
best_cp <- 0.0065
College_tree <- rpart(Outstate ~., data = College_train, control = rpart.control(cp = .001))
plotcp(College_tree)
best_cp <- 0.01
College_tree_pruned <- prune(College_tree, cp = 0.01)
college_preds_tree <- predict(College_tree_pruned, College_test)
college_preds_tree
college_preds_tree <- predict(College_tree_pruned, College_test)
results<-data.frame(
obs = College_test,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
)
results<-data.frame(
obs = College_test,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results<-data.frame(
obs = College_test,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
data.frame(
obs = College_test,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
)
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% rmse(truth = obs, estimate = preds)
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds)
college_preds_lasso
set.seed(1)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.min
x_test <- model.matrix(Outstate ~., data = College_test)[,-1]
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(parttree)
set.seed(1)
x1<-runif(40)
x2<-runif(40)
e<-rnorm(40,0,.25)
y<-2*x1 - 3*x2 + e
fake_data<-data.frame(x1,x2,y)
fake_tree<-rpart(y~., data = fake_data, control = rpart.control(cp = 0, minsplit = 12))
fake_data %>% ggplot(aes(x = x1, y = x2, color = y))+geom_point()+geom_parttree(data = fake_tree, aes(fill = y), alpha = .25, flipaxes = T)
rpart.plot(fake_tree)
set.seed(100)
n <- 6
circles <- data.frame(
shape = "circle",
x1 = runif(n+1, 0.05,.95),
x2 = runif(n+1, .25,.95 )
)
triangles <- data.frame(
shape = "triangle",
x1 = runif(n, 0.05,.6),
x2 = runif(n,  0.05,.6)
)
squares <- data.frame(
shape = "square",
x1 = runif(n-2, 0.0,.95),
x2 = runif(n-2, 0.1,.75)
)
shapes <- rbind(circles, triangles, squares) %>% mutate(shape = factor(shape, levels = c("circle", "triangle", "square")))
g<- ggplot(shapes, aes(x = x1, y = x2, col = shape, shape = shape)) +
geom_point(size = 4) +
scale_x_continuous(expand = c(0, 0) , limits = c(0, 1)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
theme_bw()
g
full_tree <- rpart(shape~., data = shapes, control = rpart.control(minsplit = 5))
rpart.plot(full_tree)
g +
geom_segment(x = 0, xend = 1, y = .36, yend = .36,color = "black")+
geom_segment(x = .64, xend = .64, y = .36, yend = 1,color = "black")+
annotate(geom = "text", x = .75, y = .2, label = "Triangle", color = "darkgreen", size = 5)+
annotate(geom = "text", x = .8, y = .8, label = "Square", color = "darkblue", size = 5)+
annotate(geom = "text", x = .2, y = .85, label = "Circle", color = "darkred", size = 5)
#If you haven't used ISLR2 before, you may need to first install
library(ISLR2)
data(OJ)
set.seed(10)
library(rsample)
OJ_initial <- initial_split(OJ, strata = Purchase)
OJ_train <- training(OJ_initial)
OJ_test <- testing(OJ_initial)
library(rpart)
OJ_tree <- rpart(Purchase ~., data = OJ_train, control = rpart.control(cp = 0))
library(rpart.plot)
rpart.plot(OJ_tree)
0.38979*0.32907
printcp(OJ_tree)
OJ_preds <- predict(OJ_tree, OJ_test, type = "class")
OJ_probs <- predict(OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- data.frame(obs = OJ_test$Purchase, preds = OJ_preds, probs = OJ_probs)
conf_mat(results, truth = obs, estimate = preds)
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds)
set.seed(1)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = college_preds_lasso,
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds)
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = as.numeric(college_preds_lasso),
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds)
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(rpart)
library(rpart.plot)
library(parttree)
set.seed(1)
x1<-runif(40)
x2<-runif(40)
e<-rnorm(40,0,.25)
y<-2*x1 - 3*x2 + e
fake_data<-data.frame(x1,x2,y)
fake_tree<-rpart(y~., data = fake_data, control = rpart.control(cp = 0, minsplit = 12))
fake_data %>% ggplot(aes(x = x1, y = x2, color = y))+geom_point()+geom_parttree(data = fake_tree, aes(fill = y), alpha = .25, flipaxes = T)
rpart.plot(fake_tree)
set.seed(100)
n <- 6
circles <- data.frame(
shape = "circle",
x1 = runif(n+1, 0.05,.95),
x2 = runif(n+1, .25,.95 )
)
triangles <- data.frame(
shape = "triangle",
x1 = runif(n, 0.05,.6),
x2 = runif(n,  0.05,.6)
)
squares <- data.frame(
shape = "square",
x1 = runif(n-2, 0.0,.95),
x2 = runif(n-2, 0.1,.75)
)
shapes <- rbind(circles, triangles, squares) %>% mutate(shape = factor(shape, levels = c("circle", "triangle", "square")))
g<- ggplot(shapes, aes(x = x1, y = x2, col = shape, shape = shape)) +
geom_point(size = 4) +
scale_x_continuous(expand = c(0, 0) , limits = c(0, 1)) +
scale_y_continuous(expand = c(0, 0), limits = c(0, 1)) +
theme_bw()
g
full_tree <- rpart(shape~., data = shapes, control = rpart.control(minsplit = 5))
rpart.plot(full_tree)
g +
geom_segment(x = 0, xend = 1, y = .36, yend = .36,color = "black")+
geom_segment(x = .64, xend = .64, y = .36, yend = 1,color = "black")+
annotate(geom = "text", x = .75, y = .2, label = "Triangle", color = "darkgreen", size = 5)+
annotate(geom = "text", x = .8, y = .8, label = "Square", color = "darkblue", size = 5)+
annotate(geom = "text", x = .2, y = .85, label = "Circle", color = "darkred", size = 5)
#If you haven't used ISLR2 before, you may need to first install
library(ISLR2)
data(OJ)
set.seed(10)
library(rsample)
OJ_initial <- initial_split(OJ, strata = Purchase)
OJ_train <- training(OJ_initial)
OJ_test <- testing(OJ_initial)
library(rpart)
OJ_tree <- rpart(Purchase ~., data = OJ_train, control = rpart.control(cp = 0))
library(rpart.plot)
rpart.plot(OJ_tree)
0.38979*0.32907
printcp(OJ_tree)
OJ_preds <- predict(OJ_tree, OJ_test, type = "class")
OJ_probs <- predict(OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- data.frame(obs = OJ_test$Purchase, preds = OJ_preds, probs = OJ_probs)
conf_mat(results, truth = obs, estimate = preds)
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = as.numeric(college_preds_lasso),
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
set.seed(1)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
set.seed(1)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.min
x_test <- model.matrix(Outstate ~., data = College_test)[,-1]
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = as.numeric(college_preds_lasso),
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
set.seed(1)
College_lasso_cv <- cv.glmnet(x_train, y_train, alpha = 1)
plot(College_lasso_cv)
best_l <- College_lasso_cv$lambda.1se
x_test <- model.matrix(Outstate ~., data = College_test)[,-1]
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
x_test <- model.matrix(Outstate ~., data = College_test)[,-1]
y_test <- College_test$Outstate
college_preds_lasso <- predict.glmnet(College_lasso, newx=x_test, s = best_l)
results<-data.frame(
obs = College_test$Outstate,
linear = college_preds_lm,
lasso = as.numeric(college_preds_lasso),
knn = college_preds_knn,
tree = college_preds_tree
) %>% pivot_longer(!obs, names_to = "model", values_to = "preds")
results %>% group_by(model) %>% rmse(truth = obs, estimate = preds) %>% arrange(.estimate)
importance(College_tree_pruned)
Imp(College_tree_pruned)
?rpart
College_tree_pruned$variable.importance
summary(College_tree_pruned)
summary(College_tree_pruned)$variable.importance
summary(College_tree_pruned)$variable.importance
College_tree_pruned$variable.importance
College_tree_pruned$variable.importance/sum(College_tree_pruned$variable.importance)*100
?College
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(yardstick)
OJ_preds <- predict(OJ_tree, OJ_test, type = "class")
OJ_probs <- predict(OJ_tree, OJ_test, type = "prob")[,2] #prob of MM
results_OJ <- data.frame(obs = OJ_test$Purchase, preds = OJ_preds, probs = OJ_probs)
conf_mat(results_OJ, truth = obs, estimate = preds)
acc <- accuracy(results_OJ, truth = obs, estimate = preds) %>% pull(.estimate)
1-acc
